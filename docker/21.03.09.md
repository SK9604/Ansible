# ì‹¤ìŠµ

virtual box í‚¤ê¸°

putty ì—°ê²°

![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/dd0ed10d-7bd2-4409-9348-13a604081ef2/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/dd0ed10d-7bd2-4409-9348-13a604081ef2/Untitled.png)

## MariaDB

- ìº¡ì²˜

```bash
docker run ~ = [pull] + create + start + [attach]
-d ì˜µì…˜ : ë°±ê·¸ë¼ìš´ë“œë¡œ ëŒë¦¬ê¸°
-e ì˜µì…˜ : í™˜ê²½ë³€ìˆ˜
ì ‘ê·¼ ì‹œ ì‚¬ìš©í•˜ëŠ” ëª…ë ¹ì–´ : attach, exec
-it : interactive terminal ì ‘ê·¼í•´ì„œ ëª…ë ¹ì–´ë¥¼ ì£¼ê³ ë°›ëŠ”ë‹¤
MariaDB, MySQL : DBìƒì„±ì‹œ í´ë”ê°€ ìƒê¸°ê³  

jeff@docker-host01:~$ docker run --name maria-test -e MYSQL_ROOT_PASSWORD=mjeff -d mariadb:10.2
Unable to find image 'mariadb:10.2' locally
Pulling from library/mariadb
92dc2a97ff99: Already exists
be13a9d27eb8: Already exists
c8299583700a: Already exists
cae230813b90: Pull complete
5f4f01551c9b: Pull complete
19708427784f: Pull complete
2782e8cbdb8e: Pull complete
780475c233af: Pull complete
955196b1da1a: Pull complete
f53f2d0ff8f4: Pull complete
584ca81f3f39: Pull complete
3ee9bfeecca0: Pull complete
54099fae9167: Pull complete
Digest: sha256:8a438741fde0e57870131c7641aa9fd806157bde3971768daa10779c21a9ad14
Status: Downloaded newer image for mariadb:10.2
86f3756445386081f4c13f829a5b4be43404454e9e1ef1e106c621513bb4064d
jeff@docker-host01:~$ docker ps
CONTAINER ID   IMAGE          COMMAND                  CREATED          STATUS          PORTS      NAMES
86f375644538   mariadb:10.2   "docker-entrypoint.sâ€¦"   27 seconds ago   Up 15 seconds   3306/tcp   maria-test
jeff@docker-host01:~$ docker exec -it maria-test /bin/bash

//ì´ë¯¸ mysqlì€ ì‹œì‘ë˜ì–´ìˆë‹¤. (í™˜ê²½ë³€ìˆ˜ ìœ )
root@86f375644538:/# service mysql start
 * Starting MariaDB database server mysqld                                                           [ OK ]

root@86f375644538:/# mysql -uroot -p
Enter password: (mjeff)

MariaDB [(none)]> create database item;
Query OK, 1 row affected (0.00 sec)

MariaDB [(none)]> use item;
Database changed

MariaDB [item]> CREATE TABLE Projects (id int(11) NOT NULL, name varchar(255) DEFAULT NULL, code varchar(255) DEFAULT NULL, PRIMARY KEY(id));
Query OK, 0 rows affected (0.02 sec)

MariaDB [item]> show tables;
+----------------+
| Tables_in_item |
+----------------+
| Projects       |
+----------------+
1 row in set (0.00 sec)

MariaDB [item]> insert into Projects (id, name, code) values (1, 'DevOps', 'DO180');
Query OK, 1 row affected (0.01 sec)

MariaDB [item]> select * from Projects;
+----+--------+-------+
| id | name   | code  |
+----+--------+-------+
|  1 | DevOps | DO180 |
+----+--------+-------+
1 row in set (0.00 sec)
MariaDB [(none)]> exit
Bye
root@86f375644538:/# cd /var/lib/mysql/item/
root@86f375644538:/var/lib/mysql/item# ls
Projects.frm  Projects.ibd  db.opt
```

### container mariadbì— windows client workbench connection

hostOSì˜ IPë¡œ ì ‘ê·¼ + Hostì— ì—´ë ¤ ìˆëŠ” 3306 í¬íŠ¸ ì ‘ê·¼ â‡’ ID/PASS = jeff/jeff

NAPT (NAT)

172.17.0.3:3306 ë³€í™˜ â‡’ mariaDB ID/PASS = root/mjeff

```bash
**PuTTY
=================================================================================**
~$ docker run --name maria-test -e MYSQL_ROOT_PASSWORD=mjeff -d \
> -p 3306:3306 mariadb:10.2
bb7093e390b2a13f02ffa7c2561acc050ef2c01fd5df0397e2b6412b7a8ba386

~$ sudo netstat -nlp | grep 3306
[sudo] password for jeff:
tcp        0      0 0.0.0.0:3306            0.0.0.0:*               LISTEN      9911/docker-proxy
9911 : PID
docker-proxy : ì—°ê²°ì ì„ ì¡ì•„ì¤€ë‹¤.

~$ ps -ef | grep 9911 | grep -v grep
root      9911  1398  0 10:08 ?        00:00:00 /usr/bin/docker-proxy -proto tcp -host-ip 0.0.0.0 -host-port 3306 -container-ip 172.17.0.2 -container-port 3306
ê¸€ë¡œë²Œì—ì„œ 3306ìœ¼ë¡œ ë“¤ì–´ì˜¤ë©´ ë¬´ì¡°ê±´ 172.17.0.2ë¡œ ì—°ê²°í•œë‹¤
```

Workbenchì—ì„œ ì—°ê²° ì„¤ì •

- ìº¡ì²˜

```bash
**workbench**
=================================================================================
create database item;
use item;
CREATE TABLE Projects (id int(11) NOT NULL, name varchar(255) DEFAULT NULL, code varchar(255) DEFAULT NULL, PRIMARY KEY(id));
show tables;
insert into Projects (id, name, code) values (1, 'DevOps', 'DO180');
select * from Projects;
=================================================================================
**PuTTY**
=================================================================================
~$ docker exec -it maria-test bash
root@bb7093e390b2:/# cd /var/lib/mysql/item/
root@bb7093e390b2:/var/lib/mysql/item# ls
Projects.frm  Projects.ibd  db.opt

ì—°ë™ì´ ì˜ ë˜ì–´ìˆëŠ” ê²ƒì„ í™•ì¸
```

### Container monitoring tool CAdvisor

```bash
~$ docker run \
> --volume=/:/rootfs:ro \
> --volume=/var/run:/var/run:rw \
> --volume=/sys:/sys:ro \
> --volume=/var/lib/docker:/var/lib/docker:ro \
> --publish=9559:8080 \
> --detach=true \
> --restart=always \
> --name=cadvisor \
> google/cadvisor:latest
Unable to find image 'google/cadvisor:latest' locally
latest: Pulling from google/cadvisor
ff3a5c916c92: Pull complete
44a45bb65cdf: Pull complete
0bbe1a2fe2a6: Pull complete
Digest: sha256:815386ebbe9a3490f38785ab11bda34ec8dacf4634af77b8912832d4f85dca04
Status: Downloaded newer image for google/cadvisor:latest
df0133134f055cc2a89e0f53f1fc81b9f710111a5529c34218b29a18055c1cff

~$ sudo netstat -nlp | grep 9559
[sudo] password for jeff:
tcp        0      0 0.0.0.0:9559            0.0.0.0:*               LISTEN      10690/docker-proxy
~$ docker ps
CONTAINER ID   IMAGE                    COMMAND                  CREATED              STATUS              PORTS                    NAMES
df0133134f05   google/cadvisor:latest   "/usr/bin/cadvisor -â€¦"   About a minute ago   Up About a minute   0.0.0.0:9559->8080/tcp   cadvisor
bb7093e390b2   mariadb:10.2             "docker-entrypoint.sâ€¦"   30 minutes ago       Up 30 minutes       0.0.0.0:3306->3306/tcp   maria-test
```

ì¸í„°ë„· ë¸Œë¼ìš°ì €ì—ì„œ 192.168.56.101:9559 ë¡œ ì ‘ì†

- ìº¡ì²˜

ì‹¤ì‹œê°„ ì‚¬ìš©ëŸ‰ì„ ëª¨ë‹ˆí„°ë§ í•  ìˆ˜ ìˆë‹¤!

```bash
~$ docker exec -it maria-test bash
root@bb7093e390b2:/# cat /etc/os-release
root@bb7093e390b2:/# apt update
```

- ì—…ë°ì´íŠ¸ í•˜ëŠ” ë™ì•ˆ CAdvisor í™•ì¸

ì‹¤ì‹œê°„ìœ¼ë¡œ ë°˜ì˜ë˜ì–´ ì‚¬ìš©ëŸ‰ì´ ì˜¬ë¼ê°€ëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤

### Nginx(web server : 80 port)

![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4e39be1e-b574-497a-be02-f9299ce17af1/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4e39be1e-b574-497a-be02-f9299ce17af1/Untitled.png)

```bash
~$ docker pull nginx:1.18
1.19: Pulling from library/nginx
45b42c59be33: Already exists
8acc495f1d91: Pull complete
ec3bd7de90d7: Pull complete
19e2441aeeab: Pull complete
f5a38c5f8d4e: Pull complete
83500d851118: Pull complete
Digest: sha256:f3693fe50d5b1df1ecd315d54813a77afd56b0245a404055a946574deb6b34fc
Status: Downloaded newer image for nginx:1.18
docker.io/library/nginx:1.18

~$ docker images
REPOSITORY        TAG       IMAGE ID       CREATED        SIZE
mariadb           10.2      bb8ea9f3c986   4 days ago     335MB
ubuntu            18.04     329ed837d508   4 days ago     63.3MB
redis             latest    f877e80bb9ef   6 days ago     105MB
mysql             5.7       d54bd1054823   10 days ago    449MB
nginx             1.18      35c43ace9216   2 weeks ago    133MB
centos            7         8652b9f0cb4c   3 months ago   204MB
ubuntu            14.04     df043b4f0cf1   5 months ago   197MB
google/cadvisor   latest    eb1210707573   2 years ago    69.6MB

~$ docker run --name webserver1 -d -p 8001:80 nginx:1.18
653d83e3c563c9964878084174b8a57e6e23118972c553afab45832767909271

~$ docker ps
CONTAINER ID   IMAGE                    COMMAND                  CREATED              STATUS          PORTS                    NAMES
653d83e3c563   nginx:1.18               "/docker-entrypoint.â€¦"   About a minute ago   Up 58 seconds   0.0.0.0:8001->80/tcp     webserver1
df0133134f05   google/cadvisor:latest   "/usr/bin/cadvisor -â€¦"   14 minutes ago       Up 14 minutes   0.0.0.0:9559->8080/tcp   cadvisor
bb7093e390b2   mariadb:10.2             "docker-entrypoint.sâ€¦"   44 minutes ago       Up 44 minutes   0.0.0.0:3306->3306/tcp   maria-test

~$ sudo netstat -nlp | grep 8001
tcp        0      0 0.0.0.0:8001            0.0.0.0:*               LISTEN      11662/docker-proxy

~$ ps -ef | grep 11662
root     11662  1398  0 10:51 ?        00:00:00 /usr/bin/docker-proxy -proto tcp -host-ip 0.0.0.0 -host-port 8001 -container-ip 172.17.0.4 -container-port 80
jeff     11841  7682  0 10:53 pts/1    00:00:00 grep --color=auto 11662

~$ docker stats webserver1
CONTAINER ID   NAME         CPU %     MEM USAGE / LIMIT   MEM %     NET I/O       BLOCK I/O     PIDS
653d83e3c563   webserver1   0.00%     3.25MiB / 3.85GiB   0.08%     3.27kB / 0B   0B / 8.19kB   2

```

- [http://192.168.56.101:9559/](http://192.168.56.101:9559/containers/docker/653d83e3c563c9964878084174b8a57e6e23118972c553afab45832767909271) ì ‘ì† í™•ì¸
- [http://192.168.56.101:8001/](http://192.168.56.101:8001/) ì ‘ì† í™•ì¸

```bash
~$ curl localhost:8001
<!DOCTYPE html>
<html>
<head>
<title>Welcome to nginx!</title>
<style>
    body {
        width: 35em;
        margin: 0 auto;
        font-family: Tahoma, Verdana, Arial, sans-serif;
    }
</style>
</head>
<body>
<h1>Welcome to nginx!</h1>
<p>If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.</p>

<p>For online documentation and support please refer to
<a href="http://nginx.org/">nginx.org</a>.<br/>
Commercial support is available at
<a href="http://nginx.com/">nginx.com</a>.</p>

<p><em>Thank you for using nginx.</em></p>
</body>
</html>
~$ docker stop webserver1           -> ë¸Œë¼ìš°ì € í™•ì¸ : ì•„ë¬´ê²ƒë„ ëœ¨ì§€ ì•ŠëŠ”ë‹¤.
~$ docker start webserver1          -> ë¸Œë¼ìš°ì € í™•ì¸ : ì˜ ëœ¬ë‹¤
```

index.html ìˆ˜ì •

```bash
~$ vi index.html
<!doctype html>
<html lang="ko">
  <head>
	<meta charset="utf-8">
	<title> Docker Web Source </title>
  </head>
  <body>
	<h1> ë‚˜ì˜ ì¢Œìš°ëª… </h1>
	<p> í•  ìˆ˜ ìˆë‹¤ê³  ìƒê°ì„ í•˜ë“  
	    í•  ìˆ˜ ì—†ë‹¤ê³  ìƒê°ì„ í•˜ë“  ìƒê°ëŒ€ë¡œ ëœë‹¤! </p>
	<hr>	
	<h3> ì¸ìƒ ë„ì•½ì„ ìœ„í•œ ë„ì „ "Never Stop Learning" </h3>
	<p> ì¸ìƒ ê³µì•½ </p>
	<ol>
		<li> 1ë…„ì— ìê²©ì¦ 1ê°œ ì´ìƒ ì·¨ë“í•˜ê¸° </li>
		<li> ìƒˆë¡œìš´ Trendì— ë„ì „í•˜ê¸° </li>
	</ol>	
  </body>
 </html>
~$ docker cp index.html webserver1:/usr/share/nginx/html
```

- [http://192.168.56.101:8001/](http://192.168.56.101:8001/) ì ‘ì† í™•ì¸

ë°”ë€ í˜ì´ì§€ë¥¼ ë³¼ ìˆ˜ ìˆë‹¤!

### IaC

```bash
IaC ê°œë°œ ì‹œ ë°˜ë“œì‹œ directory ë‹¨ìœ„ë¡œ ê°œë°œí•´ì•¼ í•¨!
IaC -> Dockerfile (image)
    -> docker-compose.yml (container service)
CMD -> imageìƒì„± ì‹œ ì‚¬ìš©ë˜ëŠ” ëª…ë ¹ì´ ì•„ë‹ˆë¼, ì´ë¯¸ì§€ ìƒì„± ì´í›„ ì»¨í…Œì´ë„ˆë¡œ ì‹¤í–‰ë  ê²½ìš° ì‹¤í–‰ë˜ëŠ” ëª…ë ¹ì–´
```

```bash
~$ mkdir nginx
~$ cd nginx/
~/nginx$ vi Dockerfile
FROM nginx:1.19
COPY index.html /usr/share/nginx/html/index.html
EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]

~/nginx$ ls -l
total 4
-rw-rw-r-- 1 jeff jeff 110  3ì›”  9 11:14 Dockerfile

~/nginx$ docker cp webserver1:/usr/share/nginx/html/index.html index.html
~/nginx$ ls -l
total 8
-rw-rw-r-- 1 jeff jeff 110  3ì›”  9 11:14 Dockerfile
-rw-rw-r-- 1 jeff jeff 488  3ì›”  9 11:02 index.html

~/nginx$ docker build -t my-nginx-image:1.0 .
Sending build context to Docker daemon  3.072kB
Step 1/4 : FROM nginx:1.19
 ---> 35c43ace9216
Step 2/4 : COPY index.html /usr/share/nginx/html/index.html
 ---> 4108284ecc5d
Step 3/4 : EXPOSE 80
 ---> Running in 6c5c2b8f2965
Removing intermediate container 6c5c2b8f2965
 ---> 9ab908e11c82
Step 4/4 : CMD ["nginx", "-g", "daemon off;"]
 ---> Running in 307f771e55c4
Removing intermediate container 307f771e55c4
 ---> 54c1f7f5497a
Successfully built 54c1f7f5497a
Successfully tagged my-nginx-image:1.0

~/nginx$ docker images
REPOSITORY        TAG       IMAGE ID       CREATED          SIZE
my-nginx-image    1.0       54c1f7f5497a   23 seconds ago   133MB
mariadb           10.2      bb8ea9f3c986   4 days ago       335MB
ubuntu            18.04     329ed837d508   5 days ago       63.3MB
redis             latest    f877e80bb9ef   6 days ago       105MB
mysql             5.7       d54bd1054823   10 days ago      449MB
nginx             1.19      35c43ace9216   2 weeks ago      133MB
nginx             1.18      034ffa24881a   3 weeks ago      133MB
centos            7         8652b9f0cb4c   3 months ago     204MB
ubuntu            14.04     df043b4f0cf1   5 months ago     197MB
google/cadvisor   latest    eb1210707573   2 years ago      69.6MB

~/nginx$ docker run --name webserver2 -d -p 8002:80 my-nginx-image:1.0
a8d0ea0181b020a5131b45d5f889dc1c29d27a004aedd61ff8a0c73899bf3bb0

~/nginx$ docker ps
CONTAINER ID   IMAGE                    COMMAND                  CREATED             STATUS             PORTS                    NAMES
a8d0ea0181b0   my-nginx-image:1.0       "/docker-entrypoint.â€¦"   5 seconds ago       Up 3 seconds       0.0.0.0:8002->80/tcp     webserver2
653d83e3c563   nginx:1.18               "/docker-entrypoint.â€¦"   27 minutes ago      Up 27 minutes      0.0.0.0:8001->80/tcp     webserver1
df0133134f05   google/cadvisor:latest   "/usr/bin/cadvisor -â€¦"   41 minutes ago      Up 41 minutes      0.0.0.0:9559->8080/tcp   cadvisor
bb7093e390b2   mariadb:10.2             "docker-entrypoint.sâ€¦"   About an hour ago   Up About an hour   0.0.0.0:3306->3306/tcp   maria-test

~/nginx$ curl http://localhost:8002
<!doctype html>
<html lang="ko">
  <head>
        <meta charset="utf-8">
        <title> Docker Web Source </title>
  </head>
  <body>
        <h1> ë‚˜ì˜ ì¢Œìš°ëª… </h1>
        <p> í•  ìˆ˜ ìˆë‹¤ê³  ìƒê°ì„ í•˜ë“ 
            í•  ìˆ˜ ì—†ë‹¤ê³  ìƒê°ì„ í•˜ë“  ìƒê°ëŒ€ë¡œ ëœë‹¤! </p>
        <hr>
        <h3> ì¸ìƒ ë„ì•½ì„ ìœ„í•œ ë„ì „ "Never Stop Learning" </h3>
        <p> ì¸ìƒ ê³µì•½ </p>
        <ol>
                <li> 1ë…„ì— ìê²©ì¦ 1ê°œ ì´ìƒ ì·¨ë“í•˜ê¸° </li>
                <li> ìƒˆë¡œìš´ Trendì— ë„ì „í•˜ê¸° </li>
        </ol>
  </body>
 </html>
```

- [http://192.168.56.101:8002/](http://192.168.56.101:8002/) ì ‘ì† í™•ì¸

### Dockerfile ê³µìœ ë¥¼ í™œìš©í•œ container service

```bash
~$ git clone https://github.com/brayanlee/docker-phpserver.git
Cloning into 'docker-phpserver'...
remote: Enumerating objects: 15, done.
remote: Counting objects: 100% (15/15), done.
remote: Compressing objects: 100% (14/14), done.
remote: Total 15 (delta 3), reused 0 (delta 0), pack-reused 0
Unpacking objects: 100% (15/15), done.

~$ cd docker-phpserver/
~/docker-phpserver$ ls
Dockerfile  index.php  index.php2

~/docker-phpserver$ cat Dockerfile
FROM php:7.2-apache

MAINTAINER datastory Hub <hylee@dshub.cloud>

ADD index.php /var/www/html/index.php

EXPOSE 80

CMD ["/usr/sbin/apache2ctl", "-D", "FOREGROUND"]

~/docker-phpserver$ cat index.php
<html>
<body>
<div style="font-size:25px">
<?php
$host=gethostname();
echo "Container Name : ";
echo $host;
?>
<p> Welcome to the Hell~! </p>
</div>
</body>
</html>

~/docker-phpserver$ docker build -t phpserver:1.0 .
Sending build context to Docker daemon  77.31kB
Step 1/5 : FROM php:7.2-apache
7.2-apache: Pulling from library/php
6ec7b7d162b2: Pull complete
db606474d60c: Pull complete
afb30f0cd8e0: Pull complete
3bb2e8051594: Pull complete
4c761b44e2cc: Pull complete
c2199db96575: Pull complete
1b9a9381eea8: Pull complete
fd07bbc59d34: Pull complete
72b73ab27698: Pull complete
983308f4f0d6: Pull complete
6c13f026e6da: Pull complete
e5e6cd163689: Pull complete
5c5516e56582: Pull complete
154729f6ba86: Pull complete
Digest: sha256:4dc0f0115acf8c2f0df69295ae822e49f5ad5fe849725847f15aa0e5802b55f8
Status: Downloaded newer image for php:7.2-apache
 ---> c61d277263e1
Step 2/5 : MAINTAINER datastory Hub <hylee@dshub.cloud>
 ---> Running in 77ac0f03e007
Removing intermediate container 77ac0f03e007
 ---> bfc5d7113a54
Step 3/5 : ADD index.php /var/www/html/index.php
 ---> 41fb48ddb927
Step 4/5 : EXPOSE 80
 ---> Running in 8c1b6be5b334
Removing intermediate container 8c1b6be5b334
 ---> a75b834dc2b7
Step 5/5 : CMD ["/usr/sbin/apache2ctl", "-D", "FOREGROUND"]
 ---> Running in 75c498e0f0aa
Removing intermediate container 75c498e0f0aa
 ---> 10a1aa179845
Successfully built 10a1aa179845
Successfully tagged phpserver:1.0

~/docker-phpserver$ docker images | grep php
phpserver         1.0          10a1aa179845   20 seconds ago   410MB
php               7.2-apache   c61d277263e1   2 months ago     410MB

~/docker-phpserver$ docker run -it -d -p 8004:80 \
> -h phpserver --name=phpserver phpserver:1.0
bd4784e8530bb607933fb2c121c8e1de6e26382d9843feea7cfcc86c3f2e05c9

~/docker-phpserver$ curl localhost:8004
<html>
<body>
<div style="font-size:25px">
Container Name : phpserver<p> Welcome to the Hell~! </p>
</div>
</body>
</html>

~/docker-phpserver$ docker exec -it phpserver bash
root@phpserver:/var/www/html# cat /etc/os-release
PRETTY_NAME="Debian GNU/Linux 10 (buster)"
NAME="Debian GNU/Linux"
VERSION_ID="10"
VERSION="10 (buster)"
VERSION_CODENAME=buster
ID=debian
HOME_URL="https://www.debian.org/"
SUPPORT_URL="https://www.debian.org/support"
BUG_REPORT_URL="https://bugs.debian.org/"
root@phpserver:/var/www/html# service apache2 status
[ ok ] apache2 is running.
```

- [http://192.168.56.101:8004/index.php](http://192.168.56.101:8004/index.php) ì ‘ì†

```bash
~/docker-phpserver$ docker cp index.php2 phpserver:/var/www/html/index.php
```

- [http://192.168.56.101:8004/index.php](http://192.168.56.101:8004/index.php) ì ‘ì†

### Python Web service

```bash
~$ mkdir LABs/
~$ cd LABs/
~/LABs$ vi py_http.py
from http.server import BaseHTTPRequestHandler, HTTPServer
port = 8900
class SimpleHTTPRequestHandler(BaseHTTPRequestHandler):
    def do_GET(self):
        self.send_response(200)
        self.send_header('Content-Type', 'text/html; charset=utf-8')
        self.end_headers()
        self.wfile.write('<h1>[Python Web Server running~]</h1>'.encode('utf-8'))

httpd = HTTPServer(('0.0.0.0', port), SimpleHTTPRequestHandler)
print(f'Server running on port:{port}')
httpd.serve_forever()

~/LABs$ docker run -it -d --name=python_test -p 8900:8900 python:3.7
Unable to find image 'python:3.7' locally
3.7: Pulling from library/python
0ecb575e629c: Pull complete
7467d1831b69: Pull complete
feab2c490a3c: Pull complete
f15a0f46f8c3: Pull complete
937782447ff6: Pull complete
e78b7aaaab2c: Pull complete
d6bffa7c00e3: Pull complete
20e485dc4919: Pull complete
d691069cb281: Pull complete
Digest: sha256:40b5df4a22109e11fcd2d5a36c146687072c5b18771162180146646d9e73029d
Status: Downloaded newer image for python:3.7
bb3dfb0f540771e66e05fce71758019fc1c9cd5ebc6f4d5071b1afb882347183

~/LABs$ sudo netstat -nlp | grep 8900
[sudo] password for jeff:
tcp        0      0 0.0.0.0:8900            0.0.0.0:*               LISTEN      14384/docker-proxy
~/LABs$ docker cp py_http.py python_test:/
~/LABs$ docker exec -it python_test bash
root@bb3dfb0f5407:/# python py_http.py
Server running on port:8900
192.168.56.1 - - [09/Mar/2021 02:54:38] "GET / HTTP/1.1" 200 -
192.168.56.1 - - [09/Mar/2021 02:54:38] "GET /favicon.ico HTTP/1.1" 200 -
```

- [http://192.168.56.101:8900/](http://192.168.56.101:8900/) ì ‘ì† í™•ì¸

### node.js

```bash
-p : publish
~$ vi nodejs_test.js
var http = require('http');
var content = function(req, resp) {
        resp.end("Good morning Korea~!" + "\n");
        resp.writeHead(200);
}
var w = http.createServer(content);
w.listen(8000);

~$ node nodejs_test.js

Command 'node' not found, but can be installed with:

sudo apt install nodejs

~$ docker pull node
Using default tag: latest
latest: Pulling from library/node
1e987daa2432: Pull complete
a0edb687a3da: Pull complete
6891892cc2ec: Pull complete
684eb726ddc5: Pull complete
b0af097f0da6: Pull complete
154aee36a7da: Pull complete
37e5835696f7: Pull complete
62eb6e670f1d: Pull complete
47e62615d9f9: Pull complete
Digest: sha256:6ba630d7d23c2aefcf55a961e987a3c0f1c8ba2d39ff78d54114525853c2f2a9
Status: Downloaded newer image for node:latest
docker.io/library/node:latest

~$ docker run -d -it -p 9000:8000 --name=nodejs_test node:latest
dcb72e8d8075e57b108fb9ed7c6c1ac2652ac5093d95a97003409a3ac9cf2fc9
~$ docker ps
CONTAINER ID   IMAGE                    COMMAND                  CREATED             STATUS             PORTS                    NAMES
dcb72e8d8075   node:latest              "docker-entrypoint.sâ€¦"   4 seconds ago       Up 3 seconds       0.0.0.0:9000->8000/tcp   nodejs_test
bb3dfb0f5407   python:3.7               "python3"                8 minutes ago       Up 8 minutes       0.0.0.0:8900->8900/tcp   python_test
bd4784e8530b   phpserver:1.0            "docker-php-entrypoiâ€¦"   18 minutes ago      Up 18 minutes      0.0.0.0:8004->80/tcp     phpserver
a8d0ea0181b0   my-nginx-image:1.0       "/docker-entrypoint.â€¦"   40 minutes ago      Up 40 minutes      0.0.0.0:8002->80/tcp     webserver2
653d83e3c563   nginx:1.18               "/docker-entrypoint.â€¦"   About an hour ago   Up About an hour   0.0.0.0:8001->80/tcp     webserver1
df0133134f05   google/cadvisor:latest   "/usr/bin/cadvisor -â€¦"   About an hour ago   Up About an hour   0.0.0.0:9559->8080/tcp   cadvisor
bb7093e390b2   mariadb:10.2             "docker-entrypoint.sâ€¦"   2 hours ago         Up 2 hours         0.0.0.0:3306->3306/tcp   maria-test
~$ docker cp nodejs_test.js nodejs_test:/nodejs_test.js
~$ docker exec -it nodejs_test bash
root@dcb72e8d8075:/# ls
bin  boot  dev  etc  home  lib  lib64  media  mnt  nodejs_test.js  opt  proc  root  run  sbin  srv  sys  tmp  usr  var
root@dcb72e8d8075:/# node nodejs_test.js
root@dcb72e8d8075:/# exit

~$ docker inspect nodejs_test | grep IPAddress
            "SecondaryIPAddresses": null,
            "IPAddress": "172.17.0.8",
                    "IPAddress": "172.17.0.8",
```

- [http://192.168.56.101:9000/](http://192.168.56.101:9000/) ì ‘ì† í™•ì¸
- virtual box ubuntu firefoxì—ì„œ HostOSí™•ì¸

### Oracle XE (user image)

```bash
oracle edition
	-EE
	-SE
	-SE+one
==========
	-PE(XE)

- sqldeveloper client tools ì—°ê²°
oracle listener(clientê°€ oracleì— ì ‘ì†í•˜ê¸° ìœ„í•œ ê²Œì´íŠ¸ì›¨ì´ ì—­í• )

- APEX (web ê´€ë¦¬ ë„êµ¬) -> 8000

```

```bash
~$ docker pull orangehrm/oracle-xe-11g
~$ docker images
REPOSITORY                TAG          IMAGE ID       CREATED             SIZE
phpserver                 1.0          10a1aa179845   52 minutes ago      410MB
my-nginx-image            1.0          54c1f7f5497a   About an hour ago   133MB
mariadb                   10.2         bb8ea9f3c986   4 days ago          335MB
ubuntu                    18.04        329ed837d508   5 days ago          63.3MB
node                      latest       135b0832eaab   5 days ago          937MB
redis                     latest       f877e80bb9ef   6 days ago          105MB
mysql                     5.7          d54bd1054823   10 days ago         449MB
python                    3.7          2699987679cd   2 weeks ago         877MB
nginx                     1.19         35c43ace9216   2 weeks ago         133MB
nginx                     1.18         034ffa24881a   3 weeks ago         133MB
php                       7.2-apache   c61d277263e1   2 months ago        410MB
centos                    7            8652b9f0cb4c   3 months ago        204MB
ubuntu                    14.04        df043b4f0cf1   5 months ago        197MB
google/cadvisor           latest       eb1210707573   2 years ago         69.6MB
orangehrm/oracle-xe-11g   latest       42dda6eba3ea   3 years ago         2.39GB

ì˜¤ë¼í´ ìš©ëŸ‰ì´ í¬ë‹¤

~$ docker run -it --shm-size=2g -p 1521:1521 -p 8081:8080 orangehrm/oracle-xe-11g:latest bash
root@28d5caf3aa7a:/# su - oracle
oracle@28d5caf3aa7a:~$ env | grep ORACLE
ORACLE_SID=XE
ORACLE_HOME=c
oracle@28d5caf3aa7a:~$ sqlplus sys/oracle as sysdba

SQL*Plus: Release 11.2.0.2.0 Production on Tue Mar 9 03:39:29 2021

Copyright (c) 1982, 2011, Oracle.  All rights reserved.

Connected to an idle instance.

SQL> startup
ORACLE instance started.

Total System Global Area  601272320 bytes
Fixed Size                  2228848 bytes
Variable Size             180358544 bytes
Database Buffers          415236096 bytes
Redo Buffers                3448832 bytes
Database mounted.
Database opened.
SQL> select host_name, instance_name,  status from v$instance;

HOST_NAME
----------------------------------------------------------------
INSTANCE_NAME    STATUS
---------------- ------------
28d5caf3aa7a
XE               OPEN

SQL> exit
Disconnected from Oracle Database 11g Express Edition Release 11.2.0.2.0 - 64bit Production

~$ cat /etc/os-release
NAME="Ubuntu"
VERSION="14.04.5 LTS, Trusty Tahr"

~$ cd /u01/app/oracle/product/11.2.0/xe/network/admin/
~/product/11.2.0/xe/network/admin$ ls
listener.ora  samples  tnsnames.ora
~/product/11.2.0/xe/network/admin$ exit
logout
root@28d5caf3aa7a:/# apt update
root@28d5caf3aa7a:/# apt -y install vim
root@28d5caf3aa7a:/# su - oracle
~$ cd /u01/app/oracle/product/11.2.0/xe/network/admin/
~/product/11.2.0/xe/network/admin$ ls
listener.ora  samples  tnsnames.ora

oracle@1f90b418d795 < ë³µì‚¬ í›„ listener.oraì— HOST= ë’¤ì— ë¶™ì—¬ë„£ê¸°

~/product/11.2.0/xe/network/admin$ vi listener.ora
# listener.ora Network Configuration File:

SID_LIST_LISTENER =
  (SID_LIST =
    (SID_DESC =
      (SID_NAME = PLSExtProc)
      (ORACLE_HOME = /u01/app/oracle/product/11.2.0/xe)
      (PROGRAM = extproc)
    )
  )

LISTENER =
  (DESCRIPTION_LIST =
    (DESCRIPTION =
      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC_FOR_XE))
      (ADDRESS = (PROTOCOL = TCP)(HOST = 1f90b418d795)(PORT = 1521))
    )
  )

DEFAULT_SERVICE_LISTENER = (XE)

~/product/11.2.0/xe/network/admin$ lsnrctl start

LSNRCTL for Linux: Version 11.2.0.2.0 - Production on 09-MAR-2021 04:01:15

Copyright (c) 1991, 2011, Oracle.  All rights reserved.

Starting /u01/app/oracle/product/11.2.0/xe/bin/tnslsnr: please wait...

TNSLSNR for Linux: Version 11.2.0.2.0 - Production
System parameter file is /u01/app/oracle/product/11.2.0/xe/network/admin/listener.ora
Log messages written to /u01/app/oracle/product/11.2.0/xe/log/diag/tnslsnr/1f90b418d795/listener/alert/log.xml
Listening on: (DESCRIPTION=(ADDRESS=(PROTOCOL=ipc)(KEY=EXTPROC_FOR_XE)))
Listening on: (DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=1f90b418d795)(PORT=1521)))

Connecting to (DESCRIPTION=(ADDRESS=(PROTOCOL=IPC)(KEY=EXTPROC_FOR_XE)))
STATUS of the LISTENER
------------------------
Alias                     LISTENER
Version                   TNSLSNR for Linux: Version 11.2.0.2.0 - Production
Start Date                09-MAR-2021 04:01:17
Uptime                    0 days 0 hr. 0 min. 0 sec
Trace Level               off
Security                  ON: Local OS Authentication
SNMP                      OFF
Default Service           XE
Listener Parameter File   /u01/app/oracle/product/11.2.0/xe/network/admin/listener.ora
Listener Log File         /u01/app/oracle/product/11.2.0/xe/log/diag/tnslsnr/1f90b418d795/listener/alert/log.xml
Listening Endpoints Summary...
  (DESCRIPTION=(ADDRESS=(PROTOCOL=ipc)(KEY=EXTPROC_FOR_XE)))
  (DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=1f90b418d795)(PORT=1521)))
Services Summary...
Service "PLSExtProc" has 1 instance(s).
  Instance "PLSExtProc", status UNKNOWN, has 1 handler(s) for this service...
The command completed successfully

~/product/11.2.0/xe/network/admin$ lsnrctl services

LSNRCTL for Linux: Version 11.2.0.2.0 - Production on 09-MAR-2021 04:04:34

Copyright (c) 1991, 2011, Oracle.  All rights reserved.

Connecting to (DESCRIPTION=(ADDRESS=(PROTOCOL=IPC)(KEY=EXTPROC_FOR_XE)))
Services Summary...
.........
Service "XE" has 1 instance(s).
  Instance "XE", status READY, has 1 handler(s) for this service...
    Handler(s):
      "DEDICATED" established:0 refused:0 state:ready
         LOCAL SERVER
......
The command completed successfully
```

- [http://192.168.56.101:8081/apex](http://192.168.56.101:8081/apex) ì ‘ì†

sql developer ì‹¤í–‰

- ì—°ê²° ìº¡ì²˜

### docker ps, image í•œë²ˆì— ì§€ìš°ê¸°

```bash
~$ docker ps
CONTAINER ID   IMAGE                    COMMAND                  CREATED       STATUS       PORTS                    NAMES
dcb72e8d8075   node:latest              "docker-entrypoint.sâ€¦"   3 hours ago   Up 3 hours   0.0.0.0:9000->8000/tcp   nodejs_test
bb3dfb0f5407   python:3.7               "python3"                3 hours ago   Up 3 hours   0.0.0.0:8900->8900/tcp   python_test
bd4784e8530b   phpserver:1.0            "docker-php-entrypoiâ€¦"   3 hours ago   Up 3 hours   0.0.0.0:8004->80/tcp     phpserver
a8d0ea0181b0   my-nginx-image:1.0       "/docker-entrypoint.â€¦"   3 hours ago   Up 3 hours   0.0.0.0:8002->80/tcp     webserver2
653d83e3c563   nginx:1.18               "/docker-entrypoint.â€¦"   4 hours ago   Up 4 hours   0.0.0.0:8001->80/tcp     webserver1
df0133134f05   google/cadvisor:latest   "/usr/bin/cadvisor -â€¦"   4 hours ago   Up 4 hours   0.0.0.0:9559->8080/tcp   cadvisor
bb7093e390b2   mariadb:10.2             "docker-entrypoint.sâ€¦"   4 hours ago   Up 4 hours   0.0.0.0:3306->3306/tcp   maria-test

~$ docker stop nodejs_test python_test phpserver webserver2 webserver1 cadvisor maria-test
nodejs_test
python_test
phpserver
webserver2
webserver1
cadvisor
maria-test

~$ docker rm $(docker ps -aq)
1f90b418d795
dcb72e8d8075
bb3dfb0f5407
bd4784e8530b
a8d0ea0181b0
653d83e3c563
df0133134f05
bb7093e390b2

~$ docker images
REPOSITORY                TAG          IMAGE ID       CREATED        SIZE
phpserver                 1.0          10a1aa179845   3 hours ago    410MB
my-nginx-image            1.0          54c1f7f5497a   3 hours ago    133MB
mariadb                   10.2         bb8ea9f3c986   5 days ago     335MB
ubuntu                    18.04        329ed837d508   5 days ago     63.3MB
node                      latest       135b0832eaab   5 days ago     937MB
redis                     latest       f877e80bb9ef   6 days ago     105MB
mysql                     5.7          d54bd1054823   10 days ago    449MB
python                    3.7          2699987679cd   2 weeks ago    877MB
nginx                     1.19         35c43ace9216   2 weeks ago    133MB
nginx                     1.18         034ffa24881a   3 weeks ago    133MB
php                       7.2-apache   c61d277263e1   2 months ago   410MB
centos                    7            8652b9f0cb4c   3 months ago   204MB
ubuntu                    14.04        df043b4f0cf1   5 months ago   197MB
google/cadvisor           latest       eb1210707573   2 years ago    69.6MB
orangehrm/oracle-xe-11g   latest       42dda6eba3ea   3 years ago    2.39GB

~$ docker image rm orangehrm/oracle-xe-11g:latest
```

## Docker command

ì´ë¯¸ì§€ë¥¼ ë§Œë“¤ ë•Œ ì“°ëŠ” íŒŒì¼ : Dockerfile

Dockerfile ê´€ë ¨ ëª…ë ¹ì–´ 17ê°œ

ë„ì»¤ íŒŒì¼ì„ buildí•˜ë©´ ì´ë¯¸ì§€ê°€ ëœë‹¤.

ì´ë¯¸ì§€ inspect vs ì»¨í…Œì´ë„ˆ inspect : ì´ë¯¸ì§€ì—ëŠ” IP, MACì£¼ì†Œê°€ ì—†ë‹¤. ì»¨í…Œì´ë„ˆì—ëŠ” ìˆë‹¤.

`docker image rm ì´ë¯¸ì§€ëª… == docker rmi ì´ë¯¸ì§€ëª…`

push: docker hubì— ì˜¬ë¦¬ëŠ” ê²ƒ

```bash
~$ docker login
Login with your Docker ID to push and pull images from Docker Hub. If you don't have a Docker ID, head over to https://hub.docker.com to create one.
Username: tjsrud428
Password:
WARNING! Your password will be stored unencrypted in /home/jeff/.docker/config.json.
Configure a credential helper to remove this warning. See
https://docs.docker.com/engine/reference/commandline/login/#credentials-store

Login Succeeded
jeff@docker-host01:~$ docker run -it ubuntu:14.04 bash
root@a54cf030d5ab:/# ps -ef
UID        PID  PPID  C STIME TTY          TIME CMD
root         1     0  0 05:48 pts/0    00:00:00 bash
root        18     1  0 05:48 pts/0    00:00:00 ps -ef

Username, Password : hub.docker.comì˜ ê°œì¸ ì•„ì´ë””/ë¹„ë°€ë²ˆí˜¸ ì…ë ¥
```

tar íŒŒì¼ì€ ê¸°ë³¸ì ìœ¼ë¡œ ì••ì¶•ì´ ì•„ë‹ˆë¼ ë¬¶ìŒì´ë‹¤.

imageëŠ” ê¸°ë³¸ì ìœ¼ë¡œ layerë¡œ ë˜ì–´ìˆì–´ì„œ tar íŒŒì¼ë¡œ ë¬¶ì–´ì„œ ê³µìœ í•œë‹¤.

```bash
ì»¨í…Œì´ë„ˆì˜ ì‹¤ì²´
============================================================
Container -> ë…ë¦½ëœ, ê²©ë¦¬ëœ í•˜ë‚˜ì˜ í˜¸ìŠ¤íŠ¸ ì—­í• 
	ã„´ process
	ã„´ fileì´ ì¡´ì¬ (imageì˜ snapshot -> /var/lib/dockerì— ì €ì¥)

	backup.tar ì´ê´€ save(backup) -> load(restore)
```

### Docker Hub (public registry)

image ë‹¤ìš´ ì „ì— ì¡°íšŒí•˜ëŠ” ìš©ë„ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

Githubê³¼ ê°™ì€ ì†ŒìŠ¤ ê´€ë¦¬ íˆ´

[hub.docker.com](http://hub.docker.com) â†â€”â€”â†’ [github.com](http://github.com)  connectionì´ ê°€ëŠ¥í•˜ë‹¤

```bash
hub.docker.com  -------  github.com
automated build <<<<<<<   IaC
 -> image -> docker pull image_name
```

### Docker image download

```bash
docekr pull [option] image_name:tag
ex) docker pull centos:7

docker pull gcr.io/google-samples/hello-app:1.0
docekr pull gcr.io/cloudrun/hello

tag ë¯¸ ì§€ì •íˆ latestë¡œ ìë™ìœ¼ë¡œ ë°›ì•„ì˜¨ë‹¤
ë¦´ë¦¬ì¦ˆë§ˆë‹¤ ë‹¬ë¼ì§€ë¯€ë¡œ ì´ìš© ì‹œ ëª…ì‹œì  ë²„ì „ ì§€ì • ê¶Œê³ 

~$ docker pull gcr.io/google-samples/hello-app:1.0
1.0: Pulling from google-samples/hello-app
b56ae66c2937: Pull complete
68cbeea01567: Pull complete
Digest: sha256:c62ead5b8c15c231f9e786250b07909daf6c266d0fcddd93fea882eb722c3be4
Status: Downloaded newer image for gcr.io/google-samples/hello-app:1.0
gcr.io/google-samples/hello-app:1.0

~$ docker images
REPOSITORY                        TAG          IMAGE ID       CREATED        SIZE
......
gcr.io/google-samples/hello-app   1.0          bc5c421ecd6c   3 years ago    9.86MB

~$ docker info | grep Registry
WARNING: No swap limit support
 Registry: https://index.docker.io/v1/

~$ docker pull httpd:2.4
2.4: Pulling from library/httpd
45b42c59be33: Already exists
83ac8490fcc3: Pull complete
bdb2d204d86d: Pull complete
243acf75a504: Pull complete
8fc1ad93a9b1: Pull complete
Digest: sha256:3c252c919ef2445a6a41dde913a56202754821af87c049c4312bf81bdbc6df4b
Status: Downloaded newer image for httpd:2.4
docker.io/library/httpd:2.4

--UFSì˜ ì¥ì 
ê°™ì€ ê³„ì¸µì€ ì„œë¡œ ê³µìœ í•œë‹¤!
	45b42c59be33: Already exists

~$ docker image history httpd:2.4
IMAGE          CREATED       CREATED BY                                      SIZE      COMMENT
464fdc577ef4   4 weeks ago   /bin/sh -c #(nop)  CMD ["httpd-foreground"]     0B
<missing>      4 weeks ago   /bin/sh -c #(nop)  EXPOSE 80                    0B
<missing>      4 weeks ago   /bin/sh -c #(nop) COPY file:c432ff61c4993ecdâ€¦   138B
<missing>      4 weeks ago   /bin/sh -c #(nop)  STOPSIGNAL SIGWINCH          0B
<missing>      4 weeks ago   /bin/sh -c set -eux;   savedAptMark="$(apt-mâ€¦   60.9MB
<missing>      4 weeks ago   /bin/sh -c #(nop)  ENV HTTPD_PATCHES=           0B
<missing>      4 weeks ago   /bin/sh -c #(nop)  ENV HTTPD_SHA256=740eddf6â€¦   0B
<missing>      4 weeks ago   /bin/sh -c #(nop)  ENV HTTPD_VERSION=2.4.46     0B
<missing>      4 weeks ago   /bin/sh -c set -eux;  apt-get update;  apt-gâ€¦   7.38MB
<missing>      4 weeks ago   /bin/sh -c #(nop) WORKDIR /usr/local/apache2    0B
<missing>      4 weeks ago   /bin/sh -c mkdir -p "$HTTPD_PREFIX"  && chowâ€¦   0B
<missing>      4 weeks ago   /bin/sh -c #(nop)  ENV PATH=/usr/local/apachâ€¦   0B
<missing>      4 weeks ago   /bin/sh -c #(nop)  ENV HTTPD_PREFIX=/usr/locâ€¦   0B
<missing>      4 weeks ago   /bin/sh -c #(nop)  CMD ["bash"]                 0B
<missing>      4 weeks ago   /bin/sh -c #(nop) ADD file:d5c41bfaf15180481â€¦   69.2MB
```

layerë“¤ì„ í•©ì³ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒ â†’ image 
imageë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒ â†’ container

### Docker image ìƒì„¸ ì •ë³´ í™•ì¸

inspect : ì„¸ë¶€ ì•„í‚¤í…ì²˜ì— ëŒ€í•œ ê°’. 

JSON(Java Script Object Notation) í˜•íƒœë¡œ ë‚˜ì˜¨ë‹¤. í…ìŠ¤íŠ¸ ê¸°ë°˜ ë°ì´í„° í¬ë§·

```bash
~$ docker image inspect httpd:2.4
[
    {
        "Id": "sha256:464fdc577ef4d4ba06050b76a95ffee72d280f7aaa4291f7f4827fca7a00ed0f",
        "RepoTags": [
            "httpd:2.4"
        ],
        "RepoDigests": [
            "httpd@sha256:3c252c919ef2445a6a41dde913a56202754821af87c049c4312bf81bdbc6df4b"
        ],
        "Parent": "",
        "Comment": "",
        "Created": "2021-02-09T05:31:09.496980273Z",
        "Container": "7d5c80f5c24d2b9772658049c98c118f9e3127e7fce239e8f98f15e0c201c340",
        "ContainerConfig": {
            "Hostname": "7d5c80f5c24d",
            "Domainname": "",
            "User": "",
            "AttachStdin": false,
            "AttachStdout": false,
            "AttachStderr": false,
            "ExposedPorts": {
                "80/tcp": {}
            },
            "Tty": false,
            "OpenStdin": false,
            "StdinOnce": false,
            "Env": [
                "PATH=/usr/local/apache2/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",
                "HTTPD_PREFIX=/usr/local/apache2",
                "HTTPD_VERSION=2.4.46",
                "HTTPD_SHA256=740eddf6e1c641992b22359cabc66e6325868c3c5e2e3f98faf349b61ecf41ea",
                "HTTPD_PATCHES="
            ],
            "Cmd": [
                "/bin/sh",
                "-c",
                "#(nop) ",
                "CMD [\"httpd-foreground\"]"
            ],
            "Image": "sha256:d5a1f046532aaebd29deb2f78a7af888d3ab403827f72772f022280677a9a792",
            "Volumes": null,
            "WorkingDir": "/usr/local/apache2",
            "Entrypoint": null,
            "OnBuild": null,
            "Labels": {},
            "StopSignal": "SIGWINCH"
        },
        "DockerVersion": "19.03.12",
        "Author": "",
        "Config": {
            "Hostname": "",
            "Domainname": "",
            "User": "",
            "AttachStdin": false,
            "AttachStdout": false,
            "AttachStderr": false,
            "ExposedPorts": {
                "80/tcp": {}
            },
            "Tty": false,
            "OpenStdin": false,
            "StdinOnce": false,
            "Env": [
                "PATH=/usr/local/apache2/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",
                "HTTPD_PREFIX=/usr/local/apache2",
                "HTTPD_VERSION=2.4.46",
                "HTTPD_SHA256=740eddf6e1c641992b22359cabc66e6325868c3c5e2e3f98faf349b61ecf41ea",
                "HTTPD_PATCHES="
            ],
            "Cmd": [
                "httpd-foreground"
            ],
            "Image": "sha256:d5a1f046532aaebd29deb2f78a7af888d3ab403827f72772f022280677a9a792",
            "Volumes": null,
            "WorkingDir": "/usr/local/apache2",
            "Entrypoint": null,
            "OnBuild": null,
            "Labels": null,
            "StopSignal": "SIGWINCH"
        },
        "Architecture": "amd64",
        "Os": "linux",
        "Size": 137543280,
        "VirtualSize": 137543280,
        "GraphDriver": {
            "Data": {
                "LowerDir": "/var/lib/docker/overlay2/c697f7d22203714da3d7e57eb3b71a1b46c0eb976c90cf840b292b14a3080c0a/diff:/var/lib/docker/overlay2/ddd847f9e9d9818e0d3dcdb5d65d144371b1a0ffb0904047d2b9a0976a468964/diff:/var/lib/docker/overlay2/5d6dc0d5a81a5a9ff4eced2e46357fbc0bd6f5bd6f4a6f3dc331b692949ec2aa/diff:/var/lib/docker/overlay2/857952d6a9d8d179fdd146963cc0b212cd06191dc9e45366dfa8b2f422ed5292/diff",
                "MergedDir": "/var/lib/docker/overlay2/be9c75f4249d949d0ced0b93dc073e791eba9b6984e707c512dae082ffea1938/merged",
                "UpperDir": "/var/lib/docker/overlay2/be9c75f4249d949d0ced0b93dc073e791eba9b6984e707c512dae082ffea1938/diff",
                "WorkDir": "/var/lib/docker/overlay2/be9c75f4249d949d0ced0b93dc073e791eba9b6984e707c512dae082ffea1938/work"
            },
            "Name": "overlay2"
        },
        "RootFS": {
            "Type": "layers",
            "Layers": [
                "sha256:9eb82f04c782ef3f5ca25911e60d75e441ce0fe82e49f0dbf02c81a3161d1300",
                "sha256:36264e957c7349a8b6a059082d1dd3000e95b01ccd4d7980a956a474f28e299b",
                "sha256:2c2a768be396f686a0727930fb1510fc674a8cb55912da8505969955d906bcfa",
                "sha256:2c5c38a813385e87a4deeb4b1af5e1f571696e6509ed69eab703f2a14da64133",
                "sha256:d236824706d45d6833516432d22b4b89cf9fddc6469fb853be98539ce6f84384"
            ]
        },
        "Metadata": {
            "LastTagTime": "0001-01-01T00:00:00Z"
        }
    }
]

sha(secure hash algorithm)
 /var/lib/docker/overlay2ì—ì„œ í™•ì¸ ê°€ëŠ¥

~$ docker image inspect --format="{{ .RootFS.Layers }}" httpd:2.4
[sha256:9eb82f04c782ef3f5ca25911e60d75e441ce0fe82e49f0dbf02c81a3161d1300 sha256:36264e957c7349a8b6a059082d1dd3000e95b01ccd4d7980a956a474f28e299b sha256:2c2a768be396f686a0727930fb1510fc674a8cb55912da8505969955d906bcfa sha256:2c5c38a813385e87a4deeb4b1af5e1f571696e6509ed69eab703f2a14da64133 sha256:d236824706d45d6833516432d22b4b89cf9fddc6469fb853be98539ce6f84384]

~$ docker image inspect --format="{{ .ContainerConfig.Env }}" httpd:2.4
[PATH=/usr/local/apache2/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin HTTPD_PREFIX=/usr/local/apache2 HTTPD_VERSION=2.4.46 HTTPD_SHA256=740eddf6e1c641992b22359cabc66e6325868c3c5e2e3f98faf349b61ecf41ea HTTPD_PATCHES=]

~$ docker run --name maria-test -e MYSQL_ROOT_PASSWORD=mjeff -d mariadb:10.2
cf47825a1524d28b65f19e26b01121a99f2181f0636e1b6bc0ee379183dc1647
jeff@docker-host01:~$ docker ps
CONTAINER ID   IMAGE          COMMAND                  CREATED         STATUS         PORTS      NAMES
cf47825a1524   mariadb:10.2   "docker-entrypoint.sâ€¦"   4 seconds ago   Up 3 seconds   3306/tcp   maria-test
~$ docker inspect cf47825a1524 | grep IPAddress
            "SecondaryIPAddresses": null,
            "IPAddress": "172.17.0.2",
                    "IPAddress": "172.17.0.2",
```

### docker image ì‚­ì œ

ì—¬ëŸ¬ ê°œì˜ imageë¥¼ ì‚­ì œí•˜ê³ ì í•  ë•Œì—ëŠ” ì—¬ëŸ¬ imageëª…ì„ ê³µë°±ìœ¼ë¡œ êµ¬ë¶„í•˜ì—¬ ì…ë ¥

ì •ì‹ ëª…ë ¹ì€ `docker image rm` ì´ê³ , ë‹¨ì¶• ëª…ë ¹ìœ¼ë¡œ `docker rmi` ì œê³µ

```bash
~$ docker images
REPOSITORY                        TAG          IMAGE ID       CREATED        SIZE
phpserver                         1.0          10a1aa179845   4 hours ago    410MB
my-nginx-image                    1.0          54c1f7f5497a   4 hours ago    133MB
mariadb                           10.2         bb8ea9f3c986   5 days ago     335MB
ubuntu                            18.04        329ed837d508   5 days ago     63.3MB
node                              latest       135b0832eaab   5 days ago     937MB
redis                             latest       f877e80bb9ef   6 days ago     105MB
mysql                             5.7          d54bd1054823   10 days ago    449MB
python                            3.7          2699987679cd   2 weeks ago    877MB
nginx                             1.19         35c43ace9216   2 weeks ago    133MB
nginx                             1.18         034ffa24881a   4 weeks ago    133MB
httpd                             2.4          464fdc577ef4   4 weeks ago    138MB
php                               7.2-apache   c61d277263e1   2 months ago   410MB
centos                            7            8652b9f0cb4c   3 months ago   204MB
ubuntu                            14.04        df043b4f0cf1   5 months ago   197MB
google/cadvisor                   latest       eb1210707573   2 years ago    69.6MB
gcr.io/google-samples/hello-app   1.0          bc5c421ecd6c   3 years ago    9.86MB

image idì˜ 3ê¸€ì ì •ë„ë§Œ ì ì–´ë„ ì•Œì•„ì„œ ì‚­ì œëœë‹¤
~$ docker image rm 865
Untagged: centos:7
Untagged: centos@sha256:0f4ec88e21daf75124b8a9e5ca03c37a5e937e0e108a255d890492430789b60e
Deleted: sha256:8652b9f0cb4c0599575e5a003f5906876e10c1ceb2ab9fe1786712dac14a50cf
Deleted: sha256:174f5685490326fc0a1c0f5570b8663732189b327007e47ff13d2ca59673db02
```

ğŸ’¡íƒœê·¸ê°€ ì¡´ì¬í•˜ëŠ” ê²½ìš° íƒœê·¸ë¥¼ í‘œê¸°í•˜ì§€ ì•Šìœ¼ë©´ ì˜¤ë¥˜ê°€ ë‚œë‹¤

```bash
~$ docker image rm gcr.io/google-samples/hello-app
Error: No such image: gcr.io/google-samples/hello-app

!! íƒœê·¸ê°€ ì¡´ì¬í•˜ëŠ” ê²½ìš° íƒœê·¸ë¥¼ í‘œê¸°í•˜ì§€ ì•Šìœ¼ë©´ ì˜¤ë¥˜ê°€ ë‚œë‹¤ !!

~$ docker image rm gcr.io/google-samples/hello-app:1.0
Untagged: gcr.io/google-samples/hello-app:1.0
Untagged: gcr.io/google-samples/hello-app@sha256:c62ead5b8c15c231f9e786250b07909daf6c266d0fcddd93fea882eb722c3be4
Deleted: sha256:bc5c421ecd6c789a90e47c880ec5052ab0824e846fe6c9c293318dcf3f92143b
Deleted: sha256:614252f3eb589b08aa785222307bf4545009519d68d5fbe6ee774c8e6e09e15f
Deleted: sha256:2aebd096e0e237b447781353379722157e6c2d434b9ec5a0d63f2a6f07cf90c2
```

ğŸ’¡ì»¨í…Œì´ë„ˆì—ì„œ ì‚¬ìš©ì¤‘ì¸ ì´ë¯¸ì§€ëŠ” ì‚­ì œí•  ìˆ˜ ì—†ë‹¤!
í•´ë‹¹ ì»¨í…Œì´ë„ˆë¥¼ ë¨¼ì € ì‚­ì œ í•œ ë’¤ ì´ë¯¸ì§€ ì‚­ì œ ê°€ëŠ¥

```bash
~$ docker run -itd --name=ubuntu14 ubuntu:14.04
1bf881a2116ac7d25f84207a05ce628b55bbe675d8bc353c532d86f195ea27b3
~$ docker image rm ubuntu:14.04
Error response from daemon: conflict: unable to remove repository reference "ubuntu:14.04" (must force) - container a54cf030d5ab is using its referenced image df043b4f0cf1
~$ docker stop a54cf030d5ab
a54cf030d5ab
~$ docker rm a54cf030d5ab
a54cf030d5ab
~$ docker image rm ubuntu:14.04
```

### Docker container ëª¨ë‘ ì‚­ì œ

shell script ê¸°ë²•ì„ ì‚¬ìš©í•œë‹¤

```bash
~$ docker stop $(docker ps -q)
~$ docker rm $(docker ps -a -q)

~$ docker rmi $(docker images -q)
~$ docker rm $(docker ps --filter 'status=exited' -a -q)
~$ alias cexrm='docker rm $(docker ps --filter 'status=exited' -a -q)'

~$ vi .bashrc
...
# for examples
alias cexrm='docker rm $(docker ps --filter 'status=exited' -a -q)'
~$ source .bashrc
~$ alias
alias alert='notify-send --urgency=low -i "$([ $? = 0 ] && echo terminal || echo error)" "$(history|tail -n1|sed -e '\''s/^\s*[0-9]\+\s*//;s/[;&|]\s*alert$//'\'')"'
alias cexrm='docker rm $(docker ps --filter status=exited -a -q)'
alias egrep='egrep --color=auto'
alias fgrep='fgrep --color=auto'
alias grep='grep --color=auto'
alias l='ls -CF'
alias la='ls -A'
alias ll='ls -alF'
alias ls='ls --color=auto'
```

# Docker Hubì— Pushí•˜ê¸°

docker push â†’ ë‚´ê°€ ë§Œë“  ì´ë¯¸ì§€ë¥¼ hub.docker.comì— upload!

ì‘ì—… ìˆœì„œ

0. ë‚´ê°€ ìƒì„±í•œ ì´ë¯¸ì§€

1. tag : ë‚´ê°€ ë§Œë“  ì´ë¯¸ì§€ëª…ìœ¼ë¡œëŠ” ì—…ë¡œë“œ ë¶ˆê°€! â†’ ë°˜ë“œì‹œ ID/ì €ì¥ì†Œëª…:íƒœê·¸ ê·œì¹™ì„ ë”°ë¼ì•¼ í•¨
2. docker login
3. docker push

### Docker image Tag ì„¤ì •

imgae íƒœê·¸ì—ëŠ” ì¼ë°˜ì ìœ¼ë¡œ ë²„ì „ëª…ì„ ì‘ì„±

`<Docker Hub ì‚¬ìš©ìëª…>/imageëª…:[íƒœê·¸ëª…]`

```bash
~$ docker image tag phpserver:1.0 tjsrud428/dev-phpserver:1.0
~$ docker images
REPOSITORY                TAG          IMAGE ID       CREATED        SIZE
phpserver                 1.0          10a1aa179845   4 hours ago    410MB
tjsrud428/dev-phpserver   1.0          10a1aa179845   4 hours ago    410MB
....
```

### Docker login

```bash
~$ docker login
Login with your Docker ID to push and pull images from Docker Hub. If you don't have a Docker ID, head over to https://hub.docker.com to create one.
Username: tjsrud428
Password:
WARNING! Your password will be stored unencrypted in /home/jeff/.docker/config.json.
Configure a credential helper to remove this warning. See
https://docs.docker.com/engine/reference/commandline/login/#credentials-store

Login Succeeded
jeff@docker-host01:~$ docker info | grep Username
WARNING: No swap limit support
 Username: tjsrud428

/home/jeff/.docker/config.json íŒŒì¼ì„ ì—´ì–´ë³´ë©´ ì•”í˜¸í™”ë˜ì§€ ì•Šì€ passwordê°€ ë³´ì¸ë‹¤
ë•Œë¬¸ì— ë°˜ë“œì‹œ docker logoutí•´ì•¼ í•œë‹¤.
```

Tokenì— ëŒ€í•œ ì–˜ê¸°

- ìº¡ì²˜

```bash
ë°›ì€ tokenê°’
11762d52-de4b-426b-ac44-c20fb9f9d7e6

~$ vi .access_token
11762d52-de4b-426b-ac44-c20fb9f9d7e6
~$ cat .access_token | docker login --username="tjsrud428" --password-stdin
WARNING! Your password will be stored unencrypted in /home/jeff/.docker/config.json.
Configure a credential helper to remove this warning. See
https://docs.docker.com/engine/reference/commandline/login/#credentials-store

Login Succeeded
~$ docker info | grep Username
WARNING: No swap limit support
 Username: tjsrud428
~$ cat /home/jeff/.docker/config.json
{
        "auths": {
                "https://index.docker.io/v1/": {
                        "auth": "dGpzcnVkNDI4OjExNzYyZDUyLWRlNGItNDI2Yi1hYzQ0LWMyMGZiOWY5ZDdlNg=="
                }
        }
~$ docker logout
Removing login credentials for https://index.docker.io/v1/
~$ ls .acc*
.access_token
~$ rm .access_token
```

### docker hubì— push

`docker push dockerhubID/image_name:tag`

```bash
~$ docker push tjsrud428/dev-phpserver:1.0
```

![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e4085026-3c7a-4c73-afec-62adbd7e7608/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e4085026-3c7a-4c73-afec-62adbd7e7608/Untitled.png)

hub.docker.comì˜ ì €ì¥ì†ŒëŠ” ë²„ì „ê´€ë¦¬ ì°¨ì›ì—ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê¶Œì¥

í•œë²ˆì— ëª¨ë“  ê³¼ì • ì—°ê²°

mysql 5.7ì„ mysql_repo:my5.7-1.0ìœ¼ë¡œ dock hubì— ì—…ë¡œë“œ!

```bash
~$ docker tag mysql:5.7 tjsrud428/mysql_repo:my5.7-1.0
~$ docker images
REPOSITORY                TAG          IMAGE ID       CREATED        SIZE
phpserver                 1.0          10a1aa179845   5 hours ago    410MB
tjsrud428/dev-phpserver   1.0          10a1aa179845   5 hours ago    410MB
my-nginx-image            1.0          54c1f7f5497a   5 hours ago    133MB
mariadb                   10.2         bb8ea9f3c986   5 days ago     335MB
ubuntu                    18.04        329ed837d508   5 days ago     63.3MB
node                      latest       135b0832eaab   5 days ago     937MB
redis                     latest       f877e80bb9ef   6 days ago     105MB
mysql                     5.7          d54bd1054823   10 days ago    449MB
tjsrud428/mysql_repo      my5.7-1.0    d54bd1054823   10 days ago    449MB
python                    3.7          2699987679cd   2 weeks ago    877MB
nginx                     1.19         35c43ace9216   2 weeks ago    133MB
nginx                     1.18         034ffa24881a   4 weeks ago    133MB
httpd                     2.4          464fdc577ef4   4 weeks ago    138MB
php                       7.2-apache   c61d277263e1   2 months ago   410MB
ubuntu                    14.04        df043b4f0cf1   5 months ago   197MB
google/cadvisor           latest       eb1210707573   2 years ago    69.6MB
~$ docker login
Login Succeeded
~$ docker push tjsrud428/mysql_repo:my5.7-1.0
The push refers to repository [docker.io/tjsrud428/mysql_repo]
035020a3d656: Mounted from library/mysql
8298d576424b: Mounted from library/mysql
26a12a601a86: Mounted from library/mysql
84a16649fa75: Mounted from library/mysql
52d9c23a9a20: Mounted from library/mysql
902a5f810181: Mounted from library/mysql
411bb8845b78: Mounted from library/mysql
7c06655789f2: Mounted from library/mysql
1a4bac3ca47c: Mounted from library/mysql
6427e36e3873: Mounted from library/mysql
9eb82f04c782: Mounted from library/httpd
my5.7-1.0: digest: sha256:c64d80f84bea7c8812e20b688a1ed127108cd4a871d48f81d55d3db37596e596 size: 2621
~$ docker pull tjsrud428/mysql_repo:my5.7-1.0
```

### Dockerì˜ ì‹¤ì²´!

```bash
ì›ë˜ í„°ë¯¸ë„ (Terminal 1)
==================================================================
~$ sudo su -
[sudo] password for jeff:
root@docker-host01:~# find / -name py_http.py
/var/lib/docker/overlay2/2c42cc48792bf2a2bf89a19eb157ee78e62a78d5339553d55870f130af0ef7ac/merged/py_http.py
/var/lib/docker/overlay2/2c42cc48792bf2a2bf89a19eb157ee78e62a78d5339553d55870f130af0ef7ac/diff/py_http.py
/home/jeff/LABs/py_http.py
find: â€˜/run/user/1000/gvfsâ€™: Permission denied

root@docker-host01:~# cd /var/lib/docker/overlay2/2c42cc48792bf2a2bf89a19eb157ee78e62a78d5339553d55870f130af0ef7ac/merged/
root@docker-host01:/var/lib/docker/overlay2/2c42cc48792bf2a2bf89a19eb157ee78e62a78d5339553d55870f130af0ef7ac/merged# ls
bin  boot  dev  etc  home  lib  lib64  media  mnt  opt  proc  py_http.py  root  run  sbin  srv  sys  tmp  usr  var
==================================================================
ë‹¤ë¥¸ í„°ë¯¸ë„ (Terminal 2)
==================================================================
~$ docker ps
CONTAINER ID   IMAGE          COMMAND                  CREATED             STATUS             PORTS                    NAMES
fd343f1379ad   python:3.7     "python3"                4 minutes ago       Up 4 minutes       0.0.0.0:8900->8900/tcp   python_test
1bf881a2116a   ubuntu:14.04   "/bin/bash"              About an hour ago   Up About an hour                            ubuntu14
cf47825a1524   mariadb:10.2   "docker-entrypoint.sâ€¦"   About an hour ago   Up About an hour   3306/tcp                 maria-test
~$ docker exec -it python_test bash
root@fd343f1379ad:/# ls
bin  boot  dev  etc  home  lib  lib64  media  mnt  opt  proc  py_http.py  root  run  sbin  srv  sys  tmp  usr  var
root@fd343f1379ad:/# echo 'hi docker1' > docker1.txt
==================================================================
ì›ë˜ í„°ë¯¸ë„ (Terminal 1)
==================================================================
root@docker-host01:/var/lib/docker/overlay2/2c42cc48792bf2a2bf89a19eb157ee78e62a78d5339553d55870f130af0ef7ac/merged# ls
bin  boot  dev  docker1.txt  etc  home  lib  lib64  media  mnt  opt  proc  py_http.py  root  run  sbin  srv  sys  tmp  usr  var
```

## Docker Container Lifecycle

![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ade5fdf4-dee3-4719-99dd-3158b8c7412e/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ade5fdf4-dee3-4719-99dd-3158b8c7412e/Untitled.png)

namespace : ip ì£¼ì†Œë¥¼ í• ë‹¹í•´ì¤€ë‹¤

### Run

run : [pull] + create + start + [attach]

```bash
~$ docker images
REPOSITORY                TAG          IMAGE ID       CREATED        SIZE
...
ubuntu                    14.04        df043b4f0cf1   5 months ago   197MB
google/cadvisor           latest       eb1210707573   2 years ago    69.6MB

~$ docker create -it --name myubuntu16 ubuntu:16.04
Unable to find image 'ubuntu:16.04' locally
16.04: Pulling from library/ubuntu
4007a89234b4: Pull complete
5dfa26c6b9c9: Pull complete
0ba7bf18aa40: Pull complete
4c6ec688ebe3: Pull complete
Digest: sha256:e74994b7a9ec8e2129cfc6a871f3236940006ed31091de355578492ed140a39c
Status: Downloaded newer image for ubuntu:16.04
cd6f90ac52ec290ab313ac3e9c37770c3f8999d1e8a75a354df048491274293c

~$ docker ps -a
CONTAINER ID   IMAGE          COMMAND                  CREATED             STATUS             PORTS                    NAMES
cd6f90ac52ec   ubuntu:16.04   "/bin/bash"              6 seconds ago       Created                                     myubuntu16

~$ docker start myubuntu16
myubuntu16

~$ docker ps -a
CONTAINER ID   IMAGE          COMMAND                  CREATED             STATUS             PORTS                    NAMES
cd6f90ac52ec   ubuntu:16.04   "/bin/bash"              30 seconds ago      Up 5 seconds                                myubuntu16

~$ docker attach myubuntu16
root@cd6f90ac52ec:/#
```

- ì˜µì…˜

    ```bash
    -a, --attach : í‘œì¤€ ì…ë ¥, í‘œì¤€ ì¶œë ¥, í‘œì¤€ ì—ëŸ¬ ì¶œë ¥ì„ ì—°ê²°
    --cidfile="íŒŒì¼ëª…" : container idë¥¼ íŒŒì¼ë¡œ ì¶œë ¥
    -d, --detach=false : containerë¥¼ ìƒì„±í•˜ì—¬ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰ exitë¡œ ë‚˜ì™€ë„ stop ì•ˆë¨
    -i, --interactive=false : container í‘œì¤€ ì…ë ¥ ì—´ê¸°
    -t, --tty=false : ttyë¥¼ ì‚¬ìš©
    --name : Container ëª…
    -u, --user="ì‚¬ìš©ìëª…" : ì‚¬ìš©ìëª…ì„ ì…ë ¥
    --restart=[no | on-failuer | on-failure:íšŸìˆ˜n | always] : ì»¤ë§¨ë“œ ì‹¤í–‰ ê²°ê³¼ì— ë”°ë¼ ì¬ê¸°ë™
    --rm : ì»¤ë§¨ë“œ ì‹¤í–‰ ì™„ë£Œ í›„ Container ìë™ ì‚­ì œ (stopê³¼ ë™ì‹œì— rmë¨)
    ```

    ```bash
    ~$ docker run -d --rm centos /bin/ping localhost
    Unable to find image 'centos:latest' locally
    latest: Pulling from library/centos
    7a0437f04f83: Pull complete
    Digest: sha256:5528e8b1b1719d34604c87e11dcd1c0a20bedf46e83b5632cdeac91b8c04efc1
    Status: Downloaded newer image for centos:latest
    380add79823dad3f4c93f7113da05733c8ac2364dc71f6f53311204dc5b2021e

    ~$ docker logs -t 380add7
    2021-03-09T08:16:26.983027511Z PING localhost (127.0.0.1) 56(84) bytes of data.
    2021-03-09T08:16:26.983047569Z 64 bytes from localhost (127.0.0.1): icmp_seq=1 ttl=64 time=0.013 ms
    2021-03-09T08:16:28.001168661Z 64 bytes from localhost (127.0.0.1): icmp_seq=2 ttl=64 time=0.038 ms
    2021-03-09T08:16:29.022342745Z 64 bytes from localhost (127.0.0.1): icmp_seq=3 ttl=64 time=0.022 ms
    2021-03-09T08:16:30.039924881Z 64 bytes from localhost (127.0.0.1): icmp_seq=4 ttl=64 time=0.025 ms
    2021-03-09T08:16:31.071054991Z 64 bytes from localhost (127.0.0.1): icmp_seq=5 ttl=64 time=0.032 ms
    2021-03-09T08:16:32.102708470Z 64 bytes from localhost (127.0.0.1): icmp_seq=6 ttl=64 time=0.036 ms
    2021-03-09T08:16:33.129998654Z 64 bytes from localhost (127.0.0.1): icmp_seq=7 ttl=64 time=0.021 ms
    2021-03-09T08:16:34.156256975Z 64 bytes from localhost (127.0.0.1): icmp_seq=8 ttl=64 time=0.031 ms
    2021-03-09T08:16:35.160676606Z 64 bytes from localhost (127.0.0.1): icmp_seq=9 ttl=64 time=0.019 ms
    2021-03-09T08:16:36.184426544Z 64 bytes from localhost (127.0.0.1): icmp_seq=10 ttl=64 time=0.023 ms
    2021-03-09T08:16:37.278258157Z 64 bytes from localhost (127.0.0.1): icmp_seq=11 ttl=64 time=0.022 ms
    2021-03-09T08:16:38.311231210Z 64 bytes from localhost (127.0.0.1): icmp_seq=12 ttl=64 time=0.019 ms
    2021-03-09T08:16:39.320600250Z 64 bytes from localhost (127.0.0.1): icmp_seq=13 ttl=64 time=0.022 ms
    ~$ docker stop 380add7
    ~$ docker ps -a
    CONTAINER ID   IMAGE          COMMAND                  CREATED          STATUS                       PORTS                    NAMES
    cd6f90ac52ec   ubuntu:16.04   "/bin/bash"              9 minutes ago    Exited (127) 2 minutes ago                            myubuntu16
    fd343f1379ad   python:3.7     "python3"                26 minutes ago   Up 26 minutes                0.0.0.0:8900->8900/tcp   python_test
    1bf881a2116a   ubuntu:14.04   "/bin/bash"              2 hours ago      Up 2 hours                                            ubuntu14
    cf47825a1524   mariadb:10.2   "docker-entrypoint.sâ€¦"   2 hours ago      Up 2 hours                   3306/tcp                 maria-test
    ~$ docker logs -t 380add7
    Error: No such container: 380add7
    ```

### Dockerì˜ Network

![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f8bdbb0d-7ea4-4c75-a3f6-239f4b8913dd/IMG_3404.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f8bdbb0d-7ea4-4c75-a3f6-239f4b8913dd/IMG_3404.png)

![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/59107371-877d-47f6-9182-159daab8bad9/IMG_3405.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/59107371-877d-47f6-9182-159daab8bad9/IMG_3405.png)

```bash
~$ docker network ls
NETWORK ID     NAME      DRIVER    SCOPE
fde6a7eac710   bridge    bridge    local
5e8807630a5e   host      host      local
1ab5288c31f8   none      null      local

~$ brctl

Command 'brctl' not found, but can be installed with:

sudo apt install bridge-utils

~$ sudo apt install bridge-utils

~$ brctl show
bridge name     bridge id               STP enabled     interfaces
docker0         8000.0242c3afe321       no              veth081692d
                                                        veth2ac280d
                                                        vethea21a1d
~$ docker run -itd ubuntu:14.04
9480625b7778336794a39d56ce9d13861e18800004e2210f28b43246863c2525

~$ brctl show
bridge name     bridge id               STP enabled     interfaces
docker0         8000.0242c3afe321       no              veth081692d
                                                        veth2ac280d
                                                        veth95d9d03
                                                        vethea21a1d
~$ docker run -itd ubuntu:14.04
7e8a252a131c97456110b48e9c6ac503f84dbc6e641d52d681b22423f1a77034

~$ brctl show
bridge name     bridge id               STP enabled     interfaces
docker0         8000.0242c3afe321       no              veth081692d
                                                        veth2ac280d
                                                        veth95d9d03
                                                        vethb2b2b55
                                                        vethea21a1d

~$ docker run -it --name=ubuntu_test ubuntu:14.04 ip addr
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
65: eth0@if66: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default
    link/ether 02:42:ac:11:00:07 brd ff:ff:ff:ff:ff:ff
    inet 172.17.0.7/16 brd 172.17.255.255 scope global eth0
       valid_lft forever preferred_lft forever

~$ docker info | grep Network
  Network: bridge host ipvlan macvlan null(none) overlay

bridge vs host
bridge 192.168.56.101:33.06 -> 172.17.0.3:3306 : í¬íŠ¸ í¬ì›Œë”©(port forwarding)
host   192.168.56.101:33.06 : ìì²´ê°€ ì»¨í…Œì´ë„ˆ
```

### ë³µì œ

```bash
sudo poweroff
```

Virtual Box ê°€ìƒ ë¨¸ì‹  ë³µì œí•˜ê¸°

- ìº¡ì²˜

ë³µì œ í›„ 2,3ë²ˆ ì„œë²„ì— ì ‘ì†

```bash
--2
~$ sudo hostnamectl set-hostname docker-host02
~$ config

--3
~$ sudo hostnamectl set-hostname docker-host03
~$ config

--1,2,3
~$ sudo vi /etc/hosts
127.0.0.1 ~~
::1
192.168.56.101 docker-host01
192.168.56.102 docker-host02  //2ë²ˆ ì„œë²„
192.168.56.103 docker-host03  //3ë²ˆ ì„œë²„
~$ sudo shutdown -r now

~$ ssh jeff@docker-host02
```
