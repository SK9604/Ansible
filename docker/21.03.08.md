- 자료

# Docker

docker → container service → orchestration tool → docker swarm(cluter) = kubernetes

## Docker Command

![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5fa578e5-01b8-4693-bc29-bc7333e3be2b/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5fa578e5-01b8-4693-bc29-bc7333e3be2b/Untitled.png)

사용방법: 명령어

☝docker managed 핵심: image(dockerfile), container(compose), network, volume

IaC → Dockerfile, docker-compose.yml

이미지 관리(저장, 배포)

[hub.docker.com](http://hub.docker.com) : public registry(공개 등록소)

Dockerfile을 이용한 프로젝트 이미지 개발 → Private registry 구축

Local → Registry container, Nexus

Global → Cloud (Google/AWS/Azure)

docker host cluster → swarm (3대)

### 솔로몬 하익스

리눅스 엔지니어

```bash
Unix -> minix -> Linux(1990) -> Linux 탄생과 같이 컨테이널(lxc) 기술은 존재
ㄴIBM(AIX)/Oracle(Solaris)/HP(hp-ux)
```

컨테이너 기술은 이미 예전부터 존재했으나 사용되지 않고 효율도 안좋고 다루기 쉽지 않았다.

이를  docker 명령어를 이용하여 lxc를 다룰 수 있도록 하였다.

Google → Kubernetes 개발 (Docker 보조)

### why docker?

image(&Container) : infrastructure → immutable(불변)

container : 

[hub.docker.com](http://hub.docker.com) (이미지 공유)/ [github.com](http://github.com) (코드 공유)

도커의 철학? one proccess,  one container

Linux Kernel에서 제공하는 고유의 LinuX Container 기술 (LXC)을 이용

바로 Linux Container는 커널의 namespaces, cgroups, chroot역할을 통해 동작!

Linux booting → PID = 1 → init (systemd)

container run → proccess start(pid=14133) → 접속 → pid=14133 & pid=1 존재 (독립된 운영체제의 의미) → chroot → container 동작? 호스트 OS자원(cpu, memory, disik, network) 사용 → cgroups(control group)

docker engine → daemon(user → dockerd → containerd 통신 → runC(lib) → kernel에 요청 → user) / lib

Docker의 핵심 기술!

하드웨어 가상화가 없이 격리된 환경에서 실행되는 프로세스 즉 "프로세스의 격리"

![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/96e57e28-bfbc-4f28-9b98-cae454c2fd37/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/96e57e28-bfbc-4f28-9b98-cae454c2fd37/Untitled.png)

- docker

### dockerd

- CLI API : 명령어
- SwarmKit : multi-server docker cluster - network
- Logs Managemt : event log, syslog(OS), aws, google
- Storage Mgmt : UFS(Union FileSystem) (image는 layer(계층)들의 집합(merge)), var/lib/docker, volume 관리 : OS vs Application 분리, 보전, 지속성
- Libnetwork : bridge network(local container 간의 network), host to host → overlay network, OSI 7, container는 격리되어 있다! (network 포함) → ubuntu(enp0s8)—docker0—vethxxxxxxx—eth0
- BuildKit : image from Dockerfile → 인프라 개발
- DCT : image 보안 (Docker Contents Trust) → image 무결성 보장
- Image Mgmt : 생성, 삭제, 재구성, upload, download

bridge network : 네트워크 세그먼트 간의 트래픽을 전달하는 링크 계층(L2) 장치

세그먼트 (논리적 단위, 연속된 주소공간)

UFS(Union FileSystem)

image는 layer(계층)들의 집합(merge)(RO) → run → container + container layer(RW)

![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4909507c-20d9-48be-9324-767665b4f85d/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4909507c-20d9-48be-9324-767665b4f85d/Untitled.png)

### Cloud server를 구축하려면

이러한 docker를 구축하기 위해 알아야 되는 기본 지식은 무엇이 있을까?

Infrastructure 구축을 위한 System에 대한 지식

### System & Infrastructure

**인프라의 기본 구성 요소**

- 하드웨어 : 인프라를 구성하는 물리적 요소, 서버 본체와 데이터를 저장하기 위한 Storage 및 전원 장치 등
- 네트워크 : 시스템 사용자가 원격지에서 서버로 액세스 할 수 있도록 연결하는 요소.

    ex) 라우터, 스위치, 방화벽, VPN, 스팸 필터, 침입 탐지 시스템(IDS) 등

- OS(Operating System) : 하드웨어와 네트워크 기기를 제어하기 위한 기본 소프트웨어. 하드 웨어 리소스와 프로세스를 관리
- 클라이언트 OS : 사용자가 쉽게 사용할 수 있도록 GUI 기능과 멀티미디어 기능 탑재

    ex) Windows, Android, Mac OS 등

- 서버 OS : 장시간 구동에도 문제가 없도록 만들어져 있으므로 시스템을 빠르고 안정적으로 운용하는 데 도움. 대량 처리를 효율적으로 수행할 수 있도록 도움.

    ex) Windows Server, Unix 서버, Linux 서버 등

- 미들웨어 : 서버 OS에서 서버가 특정 역할을 수행할 수 있도록 동작하는 소프트웨어. 상용 소프트웨어와 오픈소스로 나뉨. 인프라를 설계할 때 어떤 미들웨어를 어떻게 사용할지 선택하는 것이 중요

**서버 하드웨어에 대한 이해**

- CPU
    - 프로그램 연산과 처리 등을 수행하는 전자 회로 부품
    - Core 수가 크면 클수록 동시에 처리할 수 있는 연산 처리 수가 증가
    - 메모리와의 처리 속도 차를 줄이기 위한 동적 캐시 사용
- Memory
    - CPU가 직접 액세스 할 수 있는 기억장치
    - 서버용으로는 저전력에 에러 처리 기능을 가진 모델이 선택
- Storage
    - 데이터베이스의 데이터를 저장하는 디바이스로 보조기억장치라고 불림

        ex) 하드디스크, SSD, FC(Fiber Channel) HDD

    - 하드디스크에 장애가 발생한 경우 업무 시스템에서 다루는 중요한 데이터가 분실될 수 있으므로 대부분 RAID 구성을 해야 함
    - 서버 장비를 설치하는 데 사용하는 랙 장비는 유지 보수가 용이한 것으로 선택

```bash
커널 -> 자원동작 제어 -> cgroup -> 사용자가 제어할 수 있다!
                         ㄴ CPU 동작 : cpu 스케줄링(시간 분배)
                                 ㄴ 프로세스의 작업 연산
                                 ㄴ 동시에 수백개의 프로세스가 요청을 하면? cpu register
                                 ㄴ 순서대로 작업량 대비 시간을 할당
     ㄴ memory = physical + swap(가상메모리, disk, file)
          ㄴ 만약 새로운 프로세스 요청이 들어왔는데 물리 메모리가 가득 찬 경우에
          ㄴ 물리메모리의 놀고 있는 프로세스(idle)이 swap 영역으로 이동한다 (swqp in)
          ㄴ 새로운 프로세스가 물리 메모리로 들어온다
          ㄴ 만약 swap으로 이동한 프로세스가 갑자기 일을 시작한다면?
          ㄴ 또 물리 메모리의 idle을 찾아 swap으로 보내고 (swap in) 
          ㄴ swap에 있던 프로세스를 다시 물리 메모리르 가져온다 (swap out)
     ㄴ disk -> IOPS, MBPS
```

**네트워크에 대한 이해**

- 네트워크 Address
    - 네트워크에서는 서버와 클라이언트, 각종 네트워크 장비 등을 식별하기 위해 네트워크 Address를 사용
- MAC(Media Access Control) Address(물리 Address, 이더넷 Addresss)
    - MAC Address는 네트워크 인터페이스 카드와 무선 LAN 및 등 네트워크 부품에 물리적으로 할당되어 있는 48비트 주소.
    - Layer2의 Data Link Layer에서 사용
- IP Address
    - 네트워크에 접속하는 컴퓨터와 네트워크 장비를 구분하는 식별 번호
    - 현재 가장 보편적으로 사용되고 있는 것은 'IPv4'

![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5f95955f-20c4-432e-8650-dcd171acb740/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5f95955f-20c4-432e-8650-dcd171acb740/Untitled.png)

**OS에 대한 이해**

- 하드웨어와 네트워크를 제어하는 것이 OS의 역할
- Docker는 Linux의 기능()Linux Container:LXC)을 사용한 기술이므로 더욱 중요

**Linux 커널**

- OS가 하드웨어와 애플리케이션 소프트웨어를 제어하기 위한 기본적인 기능을 가진 소프트웨어
- Android도 Linux 커널로 만들어짐

**Linux 커널의 주요 기능**

- 디바이스 관리 : 하드웨어 (CPU, 메모리, 디스크, 입출력 디바이스 등)를 디바이스 드라이버 소프트웨어로 제어
- 프로세스 관리 : 프로세스에 PID(프로세스ID)라는 식별자를 붙여 관리. 프로세스 실행에 필요한 CPU를 적절하게 할당
- 메모리 관리 : 메모리의 물리적인 용량을 넘어선 프로그램이나 데이터가 진행되면 하드디스크와 같은 보조기억장치의 가상 메모리 영역(swap)이 사용됨

**셸(shell)**

- 이러한 Linux 커널을 조작하기 위하여 쉘(Shell)을 사용. 쉘은 사용자 명령을 커맨드에 입력하고 이를 Linux 커널에 전ㄴ달. 쉘이 실행 가능한 범위는 다음과 같다.
    - 애플리케이션 실행, 정지, 재실행
    - 환경변수 관리
    - 커맨드 이력 관리(커맨드 히스토리)
    - 커맨드 실행 결과 표시 및 파일 출력
- 쉘에서 실행하고자 하는 명령을 텍스트 파일로 저장한 것을 'Shell script'라고 함.

**Linux 파일 시스템**

- 파일 시스템은 Linux에서 하드디스크와 USB 메모리, CD, DVD 등 데이터에 액세스 하기 위한 시스템
- Linux 커널은 VFS(Virtual File System:가상 파일 시스템)이라는 시스템을 사용하여 데이터에 편리하게 액세스 할 수 있다. 각 디바이스를 '파일'로 취급하는 것이 특징.

```bash
filesystem : ext4(TB) vs xfs(쓰기속도↑)
```

**Linux 보안 기능**

- 계정을 이용한 권한 설정: root는 시스템 셧다운과 파일 시스템 마운트 및 언마운트, 애플리케이션 인스톨 등과 관련된 실행 권한을 가지며 서버 전체를 관리. 시스템 계정은 특정 프로세스 동작을 위해 존재하는 계정.
- 네트워크 필터링: 다양한 네트워크 관련 기능을 탑재 ex)iptables
- SELinux(Security-Enhanced Linux): 미국국가안전보장국이 제공하는 Linux 커널에 강제 액세스 제어(ACL) 기능을 추가한 것

**미들웨어에 대한 기초 지식**

- 미들웨어는 OS와 업무 처리를 수행하는 애플리케이션의 사이에 잇는 소프트웨어

**웹 서버 및 웹 애플리케이션 서버**

- 웹 서버는 클라이언트 브라우저에서 HTTP request를 받아 웹 콘텐츠(HTML, CSS 등)을 response하거나 다른 서버 프로그램을 호출하는 등의 기능을 가진 서버
- 대표적인 웹 서버 : Apache HTTP server, internet information service(IIS), nginx
- 대표적인 웹 애플리케이션 서버 : GlassFish, Apache Tomcat, IBM WebSphere Application Server

**데이터베이스 서버**

- 데이터베이스는 시스템이 생성하는 여러 가지 데이터를 관리하기 위한 미들웨어
- 대포적인 데이터베이스 서버 : MySQL, PostgreSQL, Oracle, DB2, MongoDB

**시스템 통합 운영 모니터링 툴**

- 시스템 모니터링 대상인 서버와 장비 상태를 모니터링 하고 미리 설정한 임계치를 넘었을 때 정해진 액션을 수행하는 툴
    - 대표적인 통합 운영 모니터링 툴 : Zabbix, Hinemos, JP1, Senju, Mackerel, Datadog
    - 최근 대표되는 모니터링 대시보드 : ELK, Prometheus 등

**인프라 구성관리에 대한 이해**

- 인프라 구성 관리
    - 인프라 구성관리란 인프라를 구성하는 하드웨어, 네트워크, OS, 미들웨어, 애플리케이션 구성 정보를 관리하고 최적의 상태를 유지하는 것을 의미
    - 인프라 구축 규모가 크면 클수록 인프라 구성관리에 대한 부담도 늘어남
    - 클라우드 시스템과 여러 가지 가상화 기술의 등장으로 인프라 구축 방법이 크게 변경됨.
    - 구축된 인프라를 변경하지 않고 파기한 뒤 새로 구축하는 것이 가능하므로 지금까지 큰 부담으로 느껴졌던 인프라 변경 이력 관리도 필요 없어졌으며 현재 가동중인 인프라 상태만 관리하면 되는 환경으로 변하고 있다.
    - 이러한 인프라를 'immutable Infrastructure(불변 인프라)'라고 부른다.
- Infrastructure as Code
    - 일반적인 인프라 구축에서는 인프라 방식 설계서를 토대로 서버와 네트워크 장비의 매개 변수 시트를 만들고 이를 기반으로 인프라 장비를 셋업한다.
    - 기존의 온프레미스 환경처럼 절차서에 따라 삶이 수작업으로 구축하는 대신 프로그램 코드에 인력된 내용을 자동으로 설정하는 방법을 이용하는 편이 실행자와 상관없이 같은 상태의 인프라 환경을 구축해내는 것에 유리하다.
    - 인프라 구성 정보를 코드로 관리해두면 애플리케이션 개발 시 Git 등 버전 관리 SW로 소스 코드를 관리하는 것처럼 변경 이력을 일원화하여 관리할 수 있다.
    - 소스코드를 통해 구성을 시각화할 수 있으므로 사람에 따른 의존성을 배제할 수 있다.
    - 이처럼 인프라 구성을 코드로 관리하는 것을 Infrastructure as Code라고 부른다.
    - Docker에서는 Dockerfile이라는 소스 코드로 인프라 구성 정보를 기록할 수 있다.

**Infrastructure as Code(IaC) & Mechanical Sympathy and the Cloud**

- 하드웨어에 대한 이해 즉, 기계적 동정은 하드웨어 장애를 정상적으로 처리하고, 숨겨진 성능 병목현상을 피하고, 잠재적인 동정을 이용하는 시스템을 구축하는 데 도움이 될 수 있다.
- 즉, 소프트웨어가 기본 시스템에 맞게 구현된 상태에서 이것은 더 안정적이고 효과적으로 작동하도록 하는 튜닝 할 수 있도록 도와준다.

![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e9da53cc-5f50-4456-9d82-00ea4414acf3/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e9da53cc-5f50-4456-9d82-00ea4414acf3/Untitled.png)

## Docker apps 동작 과정

![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2964a10c-56b6-4eec-9b4d-997ad64659bd/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2964a10c-56b6-4eec-9b4d-997ad64659bd/Untitled.png)

```bash
0. Docker Command(CLI)에 대한 이해
1. 개발팀에서 web소스를 github에 업로드 하였다. (code 공유)
2. 이 web 소스의 어떤 환경에 대한 요구사항을 그대로 반영하여 Dockerfile로 작성
3. 이 Dockerfile build를 하면 image로 만들어진다. 이를 docker hub에 공유 (image 공유)
4. 만들어진 이미지를 코드를 이용하여 컨테이너를 빌드한다. (여러 개의 컨테이너(multi container service))
2~4 : IaC
5. 컨테이너 런
6. 테스트
7. 완성된 것을 다시 공유/배포
```

![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ec0f7499-d020-49ee-ab4f-0b58956c6976/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ec0f7499-d020-49ee-ab4f-0b58956c6976/Untitled.png)

Hyper-V

## Docker란?

Container를 싣고 다니는 고래에 비유

Docker는 항만(부두) 노동자를 뜻하고, 이는 Container를 다루는 docker의 기능과 유사함을 의미

→ 왜 고래일까?

고래는 서버에서 여러 개의 Container(image)를 실행하고 image 저장과 배포(운반)을 의미

![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/24d32168-a597-4393-8ed7-7e1e5a34831a/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/24d32168-a597-4393-8ed7-7e1e5a34831a/Untitled.png)

![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4ffcd691-b532-40b4-b88b-8a035842f7c3/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4ffcd691-b532-40b4-b88b-8a035842f7c3/Untitled.png)

Layer 저장 방식 사용(UFS, union filesystem)

- 여러 개의 Layer를 하나의 파일시스템으로 사용할 수 있게 해줌.

# Docker 실습

Oracle virtualbox —→ ubuntu 18.04 —→ docker-ce installation(20.10.5)

설치 이후 reboot → docker host 1,2,3 → docker 설치 기본 요구사항 → 64bit, kernel(uname -a) 3.1 ~ 이상

```bash
[참고] 자원 배분 -> cgroup driver --> docker + kubernetes(systemd)
	kubernetes 설치 시 cgroup driver는 사용 불가 -> systemd 대체

docker0 -> 172.17.0.0/16 (65536) -> 연결가능한 container 수와 유사
application(MSA) 단위로 독립 네트워크를 생성해서 연결
bridge network 생성 -> "wepadd-net": 172.18.0.0/16

container는 격리
 ㄴ 네트워크 연결 시 어떤 형태로 외부 연결이 가능할까?

크롬에서 nginx web service 접금
	ㄴ 192.168.56.101:8001 - container:80 연결

192.168.56.101:8001 (linux)
	ㄴ 172.17.0.0/16: docker0 (172.17.0.1)
		ㄴ container = 172.17.0.2:80
-> container IP로는 외부 접근 불가!
	ㄴ NAPT(Network Address Port Translation) -> docker에 내장된 서비스
		ㄴ publicIP:port -> privateIP:port 변화

sar (system activity report)
```

- Virtual Box 다운 (Ubuntu)
    - 캡처

    [virtualbox](https://www.virtualbox.org/wiki/Downloads) 다운
    설치 후 재부팅
    가상 머신 만들기 - 이름: docker_host01
    메모리 : 4096MB
    하드디스크: 지금 새 가상 하드디스크 만들기 (기존에 있으면 밑에꺼 선택)
    하드디스크 파일 종류 : VDI
    물리적 하드 드라이브에 저장 : 동적할당
    파일 위치 및 크기 : 이 때 파일 위치는 반드시 C, 이동식 디스크에 넣지 말고 별도의 파티션(E,D)에 넣는다. 100GB
    vmbox 환경 설정
    입력 - 가상머신 - 호스트 키 조합: Ctrl+Alt
    VM 설정
    시스템 - 프로세서 : 4개
    저장소 - 광학 디스크 선택 : ubuntu ISO파일 선택
    오디오 - 선택 해제
    네트워크 - 어댑터2 사용 : 호스트 전용 어댑터
    USB - 선택 해제
    가상 머신 시작
    기본설정으로 계속 진행
    이름: jeff, computer이름: docker-host01, username:jeff, password: jeff 설정
    설치 후 리부트
    jeff로 접속

- Ubuntu terminal

    ```bash
    jeff@docker-host01:~$ ifconfig

    Command 'ifconfig' not found, but can be installed with:

    sudo apt install net-tools

    jeff@docker-host01:~$ sudo apt install net-tools
    jeff@docker-host01:~$ sudo su -
    root@docker-host01:~# apt-get -y install openssh-server
    root@docker-host01:~# /etc/init.d/ssh start
    root@docker-host01:~# apt-get install vim
    root@docker-host01:~# ping 192.168.56.1
    root@docker-host01:~# exit
    jeff@docker-host01:~$ sudo apt-get install vim
    ```

- PuTTY 연결
    - 캡처

    Hostname: 192.168.56.101, Port 22
    Session name : docker-host01
    login: jeff
    password : jeff

- Ubuntu Docker installation

    ```bash
    // 설치 고려사항 리눅스 커널 정보와 64비트 확인
    jeff@docker-host01:~$ uname -a
    Linux docker-host01 5.0.0-23-generic #24~18.04.1-Ubuntu SMP Mon Jul 29 16:12:28 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux

    //apt(advanced packaging tool)은 ubuntu를 비롯한 debian 계열에서 작동하는 패키지 관리 시스템
    jeff@docker-host01:~$ sudo apt-get update
    [sudo] password for jeff:

    //https를 경유하여 repository를 사용할 수 있도록 패키지 설치
    jeff@docker-host01:~$ sudo apt-get install -y \
    > apt-transport-https \
    > ca-certificates \
    > curl \
    > software-properties-common

    //Docker의 공식 GPG(GNU Privacy Guard) key를 추가
    jeff@docker-host01:~$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
    OK

    jeff@docker-host01:~$ sudo apt-key fingerprint
    /etc/apt/trusted.gpg
    --------------------
    pub   rsa4096 2017-02-22 [SCEA]
          9DC8 5822 9FC7 DD38 854A  E2D8 8D81 803C 0EBF CD88
    uid           [ unknown] Docker Release (CE deb) <docker@docker.com>
    sub   rsa4096 2017-02-22 [S]

    /etc/apt/trusted.gpg.d/ubuntu-keyring-2012-archive.gpg
    ------------------------------------------------------
    pub   rsa4096 2012-05-11 [SC]
          790B C727 7767 219C 42C8  6F93 3B4F E6AC C0B2 1F32
    uid           [ unknown] Ubuntu Archive Automatic Signing Key (2012) <ftpmaster@ubuntu.com>

    /etc/apt/trusted.gpg.d/ubuntu-keyring-2012-cdimage.gpg
    ------------------------------------------------------
    pub   rsa4096 2012-05-11 [SC]
          8439 38DF 228D 22F7 B374  2BC0 D94A A3F0 EFE2 1092
    uid           [ unknown] Ubuntu CD Image Automatic Signing Key (2012) <cdimage@ubuntu.com>

    /etc/apt/trusted.gpg.d/ubuntu-keyring-2018-archive.gpg
    ------------------------------------------------------
    pub   rsa4096 2018-09-17 [SC]
          F6EC B376 2474 EDA9 D21B  7022 8719 20D1 991B C93C
    uid           [ unknown] Ubuntu Archive Automatic Signing Key (2018) <ftpmaster@ubuntu.com>

    jeff@docker-host01:~$ sudo apt-key fingerprint 0EBFCD88
    pub   rsa4096 2017-02-22 [SCEA]
          9DC8 5822 9FC7 DD38 854A  E2D8 8D81 803C 0EBF CD88
    uid           [ unknown] Docker Release (CE deb) <docker@docker.com>
    sub   rsa4096 2017-02-22 [S]

    //debian 계열의 docker repository 추가 후 apt update 수행(/etc/apt/sources.list에 기록)
    jeff@docker-host01:~$ sudo add-apt-repository \
    > "deb [arch=amd64] https://download.docker.com/linux/ubuntu \
    > $(lsb_release -cs) \
    > stable"

    //repository 정보 추가 확인
    jeff@docker-host01:~$ cat /etc/apt/sources.list
    .......
    deb [arch=amd64] https://download.docker.com/linux/ubuntu bionic stable
    ..

    jeff@docker-host01:~$ sudo apt-get update

    //docker CE 버전 설치
    jeff@docker-host01:~$ sudo apt-get -y install docker-ce

    //sudo 없이 docker 사용하기
    jeff@docker-host01:~$ sudo usermod -aG docker jeff
    jeff@docker-host01:~$ sudo systemctl enable docker
    Synchronizing state of docker.service with SysV service script with /lib/systemd/systemd-sysv-install.
    Executing: /lib/systemd/systemd-sysv-install enable docker
    jeff@docker-host01:~$ sudo systemctl restart docker
    jeff@docker-host01:~$ sudo reboot
    jeff@docker-host01:~$ docker version
    Client: Docker Engine - Community
     Version:           20.10.5
     API version:       1.41
     Go version:        go1.13.15
     Git commit:        55c4c88
     Built:             Tue Mar  2 20:18:05 2021
     OS/Arch:           linux/amd64
     Context:           default
     Experimental:      true

    Server: Docker Engine - Community
     Engine:
      Version:          20.10.5
      API version:      1.41 (minimum version 1.12)
    ...

    jeff@docker-host01:~$ docker info
    Client:
     Context:    default
     Debug Mode: false
     Plugins:
      app: Docker App (Docker Inc., v0.9.1-beta3)
      buildx: Build with BuildKit (Docker Inc., v0.5.1-docker)

    Server:
     Containers: 0
      Running: 0
      Paused: 0
      Stopped: 0
     Images: 0
     Server Version: 20.10.5
     Storage Driver: overlay2
      Backing Filesystem: extfs
      Supports d_type: true
      Native Overlay Diff: true
     Logging Driver: json-file
     Cgroup Driver: cgroupfs
     Cgroup Version: 1
     Plugins:
      Volume: local
      Network: bridge host ipvlan macvlan null overlay
      Log: awslogs fluentd gcplogs gelf journald json-file local logentries splunk syslog
     Swarm: inactive
     Runtimes: io.containerd.runc.v2 io.containerd.runtime.v1.linux runc
     Default Runtime: runc
     Init Binary: docker-init
     containerd version: 269548fa27e0089a8b8278fc4fc781d7f65a939b
     runc version: ff819c7e9184c13b7c2607fe6c30ae19403a7aff
     init version: de40ad0
     Security Options:
      apparmor
      seccomp
       Profile: default
     Kernel Version: 5.0.0-23-generic
     Operating System: Ubuntu 18.04.3 LTS
     OSType: linux
     Architecture: x86_64
     CPUs: 4
     Total Memory: 3.85GiB
     Name: docker-host01
     ID: YQC3:ZUEM:HKP6:XCCR:HBUL:CAOC:CWHD:MPLR:667L:P54P:K7HS:TKXF
     Docker Root Dir: /var/lib/docker
     Debug Mode: false
     Registry: https://index.docker.io/v1/
     Labels:
     Experimental: false
     Insecure Registries:
      127.0.0.0/8
     Live Restore Enabled: false

    WARNING: No swap limit support

    jeff@docker-host01:~$ docker pull centos:7
    jeff@docker-host01:~$ docker pull redis
    Using default tag: latest
    latest: Pulling from library/redis
    45b42c59be33: Pull complete      //LFS
    5ce2e937bf62: Pull complete      //LFS
    2a031498ff58: Pull complete      //LFS
    2f3d47096658: Pull complete      //LFS
    04f5cb8ac4c0: Pull complete      //LFS
    9ed141398658: Pull complete      //LFS
    Digest: sha256:9a1a2bb9fd2bd8b2c15aaca44d8e6ba8bc448df9b7b8d7d24ba4b472e0da1b8a
    Status: Downloaded newer image for redis:latest
    docker.io/library/redis:latest       //docker.io도 다운용 사이트

    jeff@docker-host01:~$ docker images
    REPOSITORY   TAG       IMAGE ID       CREATED        SIZE
    redis        latest    f877e80bb9ef   5 days ago     105MB
    centos       7         8652b9f0cb4c   3 months ago   204MB

    jeff@docker-host01:~$ docker info
    ....
    Containers: 0
      Running: 0
      Paused: 0
      Stopped: 0
     Images: 2           //centos, redis 두 개
     Server Version: 20.10.5
     Storage Driver: overlay2
      Backing Filesystem: extfs
      Supports d_type: true
      Native Overlay Diff: true
     Logging Driver: json-file
     Cgroup Driver: cgroupfs      //kernel 기능
     Cgroup Version: 1
     Plugins:
      Volume: local
      Network: bridge host ipvlan macvlan null overlay     //docker network plugin
      Log: awslogs fluentd gcplogs gelf journald json-file local logentries splunk syslog
     Swarm: inactive
     Runtimes: io.containerd.runtime.v1.linux runc io.containerd.runc.v2
     Default Runtime: runc
     Init Binary: docker-init
     containerd version: 269548fa27e0089a8b8278fc4fc781d7f65a939b
     runc version: ff819c7e9184c13b7c2607fe6c30ae19403a7aff
     init version: de40ad0
     Security Options:
      apparmor
      seccomp
       Profile: default
     Kernel Version: 5.0.0-23-generic
     Operating System: Ubuntu 18.04.3 LTS
     OSType: linux
     Architecture: x86_64
     CPUs: 4
     Total Memory: 3.85GiB
     Name: docker-host01
     ID: YQC3:ZUEM:HKP6:XCCR:HBUL:CAOC:CWHD:MPLR:667L:P54P:K7HS:TKXF
     Docker Root Dir: /var/lib/docker             //docker의 설치 경로
     Debug Mode: false
     Registry: https://index.docker.io/v1/        //image 내려받는 주소
     Labels:
     Experimental: false
     Insecure Registries:
      127.0.0.0/8
     Live Restore Enabled: false

    WARNING: No swap limit support

    jeff@docker-host01:~$ ifconfig       //docker0 = bridge
    docker0: flags=4099<UP,BROADCAST,MULTICAST>  mtu 1500
            inet 172.17.0.1  netmask 255.255.0.0  broadcast 172.17.255.255
            ether 02:42:c3:af:e3:21  txqueuelen 0  (Ethernet)
            RX packets 0  bytes 0 (0.0 B)
            RX errors 0  dropped 0  overruns 0  frame 0
            TX packets 0  bytes 0 (0.0 B)
            TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

    jeff@docker-host01:~$ vmstat 2 5          //swap si, so > 항상 0을 유지하는게 정상
    procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----
     r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st
     0  0      0 2486520  43184 996440    0    0    61    39   49   77  0  0 99  1  0
     0  0      0 2486520  43184 996440    0    0     0     0  102  146  0  0 100  0  0
     0  0      0 2486520  43184 996440    0    0     0     0  119  152  0  0 100  0  0
     0  0      0 2486520  43184 996440    0    0     0     0  104  139  0  0 100  0  0
     0  0      0 2486520  43184 996440    0    0     0     0   98  126  0  0 100  0  0

    jeff@docker-host01:~$ docker system df
    TYPE            TOTAL     ACTIVE    SIZE      RECLAIMABLE   //Reclaimable: 회수 가능 공간
    Images          2         0         309.2MB   309.2MB (100%)
    Containers      0         0         0B        0B
    Local Volumes   0         0         0B        0B
    Build Cache     0         0         0B        0B
    ```

    ```bash
    sar(system a r)
    ```

[winscp](https://winscp.net/download/WinSCP-5.17.10-Setup.exe) 설치

### Taxonomy in Docker

![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/47c06df0-3167-4af5-a103-c75ab5ba400f/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/47c06df0-3167-4af5-a103-c75ab5ba400f/Untitled.png)

```bash
$ docker pull ubuntu:latest
	//:latest = 버전 -> hub.docker.com 에 접속하여 해당 이미지의 버전을 확인하여 정확히 버전을 기재하는 습관을 갖자
```

- 캡처

### Ubuntu & CentOS

```bash
터미널(Terminal 1)
====================================================================================
jeff@docker-host01:~$ docker images
REPOSITORY   TAG       IMAGE ID       CREATED        SIZE
redis        latest    f877e80bb9ef   5 days ago     105MB
centos       7         8652b9f0cb4c   3 months ago   204MB
jeff@docker-host01:~$ cat /etc/lsb-release
DISTRIB_ID=Ubuntu
DISTRIB_RELEASE=18.04
DISTRIB_CODENAME=bionic
DISTRIB_DESCRIPTION="Ubuntu 18.04.3 LTS"
jeff@docker-host01:~$ docker run -it ubuntu:18.04 echo "Hello world~"
Unable to find image 'ubuntu:18.04' locally
18.04: Pulling from library/ubuntu
92dc2a97ff99: Pull complete
be13a9d27eb8: Pull complete
c8299583700a: Pull complete
Digest: sha256:4bc3ae6596938cb0d9e5ac51a1152ec9dcac2a1c50829c74abd9c4361e321b26
Status: Downloaded newer image for ubuntu:18.04
Hello world~
jeff@docker-host01:~$ docker run -it ubuntu:18.04 bash
root@357659eb28e8:/# ifconfig
bash: ifconfig: command not found
root@357659eb28e8:/# apt-get update
root@357659eb28e8:/# apt-get install net-tools
root@357659eb28e8:/# apt-get -y install iputils-ping
root@357659eb28e8:/# ifconfig
eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 172.17.0.3  netmask 255.255.0.0  broadcast 172.17.255.255
        ether 02:42:ac:11:00:03  txqueuelen 0  (Ethernet)
        RX packets 8865  bytes 22872159 (22.8 MB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 7462  bytes 408446 (408.4 KB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 0  bytes 0 (0.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

root@357659eb28e8:/# ping 192.168.56.1
PING 192.168.56.1 (192.168.56.1) 56(84) bytes of data.
64 bytes from 192.168.56.1: icmp_seq=1 ttl=127 time=0.537 ms
64 bytes from 192.168.56.1: icmp_seq=2 ttl=127 time=0.237 ms
64 bytes from 192.168.56.1: icmp_seq=3 ttl=127 time=0.353 ms
root@357659eb28e8:/# ping 172.17.0.2
PING 172.17.0.2 (172.17.0.2) 56(84) bytes of data.
64 bytes from 172.17.0.2: icmp_seq=1 ttl=64 time=0.039 ms
64 bytes from 172.17.0.2: icmp_seq=2 ttl=64 time=0.042 ms
64 bytes from 172.17.0.2: icmp_seq=3 ttl=64 time=0.051 ms
====================================================================================
다른 터미널(Terminal 2)
====================================================================================
jeff@docker-host01:~$ docker ps
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES
jeff@docker-host01:~$ docker run -it centos:7
[root@5be18d5bf684 /]# cat /etc/os-release
NAME="CentOS Linux"
VERSION="7 (Core)"
ID="centos"
ID_LIKE="rhel fedora"
VERSION_ID="7"
PRETTY_NAME="CentOS Linux 7 (Core)"
ANSI_COLOR="0;31"
CPE_NAME="cpe:/o:centos:centos:7"
HOME_URL="https://www.centos.org/"
BUG_REPORT_URL="https://bugs.centos.org/"

CENTOS_MANTISBT_PROJECT="CentOS-7"
CENTOS_MANTISBT_PROJECT_VERSION="7"
REDHAT_SUPPORT_PRODUCT="centos"
REDHAT_SUPPORT_PRODUCT_VERSION="7"

[root@5be18d5bf684 /]# yum -y install net-tools
[root@5be18d5bf684 /]# ifconfig
eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 172.17.0.2  netmask 255.255.0.0  broadcast 172.17.255.255
        ether 02:42:ac:11:00:02  txqueuelen 0  (Ethernet)
        RX packets 1634  bytes 13093309 (12.4 MiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 1333  bytes 75254 (73.4 KiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 0  bytes 0 (0.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

[root@5be18d5bf684 /]# ping 192.168.56.1
PING 192.168.56.1 (192.168.56.1) 56(84) bytes of data.
64 bytes from 192.168.56.1: icmp_seq=1 ttl=127 time=0.635 ms
64 bytes from 192.168.56.1: icmp_seq=2 ttl=127 time=0.250 ms
64 bytes from 192.168.56.1: icmp_seq=3 ttl=127 time=0.254 ms
[root@5be18d5bf684 /]# ping 172.17.0.3
PING 172.17.0.3 (172.17.0.3) 56(84) bytes of data.
64 bytes from 172.17.0.3: icmp_seq=1 ttl=64 time=0.048 ms
64 bytes from 172.17.0.3: icmp_seq=2 ttl=64 time=0.035 ms
64 bytes from 172.17.0.3: icmp_seq=3 ttl=64 time=0.038 ms
====================================================================================
또 다른 터미널(Terminal 3)
====================================================================================
jeff@docker-host01:~$ ifconfig
docker0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 172.17.0.1  netmask 255.255.0.0  broadcast 172.17.255.255
        inet6 fe80::42:c3ff:feaf:e321  prefixlen 64  scopeid 0x20<link>
        ether 02:42:c3:af:e3:21  txqueuelen 0  (Ethernet)
        RX packets 8811  bytes 361746 (361.7 KB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 10461  bytes 35960502 (35.9 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

enp0s3: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 10.0.2.15  netmask 255.255.255.0  broadcast 10.0.2.255
        inet6 fe80::cc15:dbda:96f4:42a5  prefixlen 64  scopeid 0x20<link>
        ether 08:00:27:c8:2e:ff  txqueuelen 1000  (Ethernet)
        RX packets 139364  bytes 209084493 (209.0 MB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 14512  bytes 1000846 (1.0 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

enp0s8: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 192.168.56.101  netmask 255.255.255.0  broadcast 192.168.56.255
        inet6 fe80::de41:1d8a:d836:8cb  prefixlen 64  scopeid 0x20<link>
        ether 08:00:27:95:51:c1  txqueuelen 1000  (Ethernet)
        RX packets 9717  bytes 800770 (800.7 KB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 2045  bytes 322611 (322.6 KB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10<host>
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 445  bytes 41604 (41.6 KB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 445  bytes 41604 (41.6 KB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

veth7ff4c6f: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet6 fe80::e4d9:a4ff:fea6:b644  prefixlen 64  scopeid 0x20<link>
        ether e6:d9:a4:a6:b6:44  txqueuelen 0  (Ethernet)
        RX packets 1344  bytes 76220 (76.2 KB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 1660  bytes 13095610 (13.0 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

vethc077deb: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet6 fe80::e016:ddff:fead:f803  prefixlen 64  scopeid 0x20<link>
        ether e2:16:dd:ad:f8:03  txqueuelen 0  (Ethernet)
        RX packets 7482  bytes 410182 (410.1 KB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 8884  bytes 22873757 (22.8 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

// veth : 현재 열려있는 다른 터미널들. 2계층 터널링 서비스

jeff@docker-host01:~$ docker ps
CONTAINER ID   IMAGE          COMMAND       CREATED          STATUS          PORTS     NAMES
357659eb28e8   ubuntu:18.04   "bash"        15 minutes ago   Up 15 minutes             exciting_haibt
5be18d5bf684   centos:7       "/bin/bash"   19 minutes ago   Up 19 minutes             tender_sutherland
jeff@docker-host01:~$ docker inspect exciting_haibt | grep IPAddress
            "SecondaryIPAddresses": null,
            "IPAddress": "172.17.0.3",
                    "IPAddress": "172.17.0.3",
jeff@docker-host01:~$ docker inspect tender_sutherland | grep IPAddress
            "SecondaryIPAddresses": null,
            "IPAddress": "172.17.0.2",
                    "IPAddress": "172.17.0.2",
```

```bash
jeff@docker-host01:~$ docker pull ubuntu:14.04
jeff@docker-host01:~$ docker run -it --name=ubuntu14-test ubuntu:14.04
root@b1431586d477:/# exit
exit
jeff@docker-host01:~$ docker ps
CONTAINER ID   IMAGE      COMMAND       CREATED          STATUS          PORTS                    NAMES
jeff@docker-host01:~$ docker ps -a
CONTAINER ID   IMAGE          COMMAND                 CREATED          STATUS                      PORTS     NAMES
b1431586d477   ubuntu:14.04   "/bin/bash"             48 seconds ago   Exited (0) 35 seconds ago             ubuntu14-test
357659eb28e8   ubuntu:18.04   "bash"                  25 minutes ago   Exited (0) 7 minutes ago              exciting_haibt
73c7a2bb7da9   ubuntu:18.04   "echo 'Hello world~'"   26 minutes ago   Exited (0) 26 minutes ago             naughty_thompson
5be18d5bf684   centos:7       "/bin/bash"             29 minutes ago   Up 29 minutes                         tender_sutherland
jeff@docker-host01:~$ docker start ubuntu14-test
ubuntu14-test
jeff@docker-host01:~$ docker ps
CONTAINER ID   IMAGE          COMMAND       CREATED              STATUS          PORTS     NAMES
b1431586d477   ubuntu:14.04   "/bin/bash"   About a minute ago   Up 3 seconds              ubuntu14-test
jeff@docker-host01:~$ docker exec ubuntu14-test ifconfig
eth0      Link encap:Ethernet  HWaddr 02:42:ac:11:00:03
          inet addr:172.17.0.3  Bcast:172.17.255.255  Mask:255.255.0.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:25 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:3023 (3.0 KB)  TX bytes:0 (0.0 B)

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
// docker0의 대역을 따라간다
jeff@docker-host01:~$ docker exec ubuntu14-test route
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
default         172.17.0.1      0.0.0.0         UG    0      0        0 eth0
172.17.0.0      *               255.255.0.0     U     0      0        0 eth0
jeff@docker-host01:~$ docker exec ubuntu14-test ip addr
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
13: eth0@if14: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default
    link/ether 02:42:ac:11:00:03 brd ff:ff:ff:ff:ff:ff
    inet 172.17.0.3/16 brd 172.17.255.255 scope global eth0
       valid_lft forever preferred_lft forever

jeff@docker-host01:~$ docker ps
CONTAINER ID   IMAGE          COMMAND       CREATED          STATUS          PORTS     NAMES
b1431586d477   ubuntu:14.04   "/bin/bash"   5 minutes ago    Up 3 minutes              ubuntu14-test
5be18d5bf684   centos:7       "/bin/bash"   34 minutes ago   Up 34 minutes             tender_sutherland
jeff@docker-host01:~$ docker stop tender_sutherland ubuntu14-test
tender_sutherland
ubuntu14-test
jeff@docker-host01:~$ docker rm tender_sutherland ubuntu14-test
tender_sutherland
ubuntu14-test
jeff@docker-host01:~$ docker ps -a
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES
```

### MySQL

![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/bf2762af-3fe7-424e-81a9-f139b55162f9/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/bf2762af-3fe7-424e-81a9-f139b55162f9/Untitled.png)

```bash
jeff@docker-host01:~$ docker pull mysql:5.7
5.7: Pulling from library/mysql
45b42c59be33: Already exists
b4f790bd91da: Pull complete
325ae51788e9: Pull complete
adcb9439d751: Pull complete
174c7fe16c78: Pull complete
698058ef136c: Pull complete
4690143a669e: Pull complete
66676c1ab9b3: Pull complete
25ebf78a38b6: Pull complete
a6510e5d6228: Pull complete
90ca045d52c5: Pull complete
Digest: sha256:9fc60b229633ce1d1f2ee306705152d4b001056fb27c1b5debe23a732df72b70
Status: Downloaded newer image for mysql:5.7
docker.io/library/mysql:5.7
jeff@docker-host01:~$ docker images
REPOSITORY   TAG       IMAGE ID       CREATED        SIZE
ubuntu       18.04     329ed837d508   4 days ago     63.3MB
redis        latest    f877e80bb9ef   5 days ago     105MB
mysql        5.7       d54bd1054823   9 days ago     449MB
centos       7         8652b9f0cb4c   3 months ago   204MB
ubuntu       14.04     df043b4f0cf1   5 months ago   197MB
jeff@docker-host01:~$ docker run -it mysql:5.7 /bin/bash
root@5d3209108c0d:/# cat /etc/os-release
PRETTY_NAME="Debian GNU/Linux 10 (buster)"
NAME="Debian GNU/Linux"
VERSION_ID="10"
VERSION="10 (buster)"
VERSION_CODENAME=buster
ID=debian
HOME_URL="https://www.debian.org/"
SUPPORT_URL="https://www.debian.org/support"
BUG_REPORT_URL="https://bugs.debian.org/"
root@5d3209108c0d:/# /etc/init.d/mysql start
su: warning: cannot change directory to /home/mysql: No such file or directory
...
su: warning: cannot change directory to /home/mysql: No such file or directory
..
[info] MySQL Community Server 5.7.33 is started.
root@5d3209108c0d:/# mysql -uroot
Welcome to the MySQL monitor.  Commands end with ; or \g.
...
mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
| sys                |
+--------------------+
4 rows in set (0.00 sec)

mysql> create database dockerdb;
Query OK, 1 row affected (0.00 sec)

mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| dockerdb           |
| mysql              |
| performance_schema |
| sys                |
+--------------------+
5 rows in set (0.00 sec)
mysql> exit
Bye
root@5d3209108c0d:/# cd /var/lib/mysql
root@5d3209108c0d:/var/lib/mysql# ls
...dockerdb...
root@5d3209108c0d:/var/lib/mysql# exit
exit
jeff@docker-host01:~$ docker ps
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES
jeff@docker-host01:~$ docker ps -a
CONTAINER ID   IMAGE       COMMAND                  CREATED         STATUS                      PORTS     NAMES
5d3209108c0d   mysql:5.7   "docker-entrypoint.s…"   3 minutes ago   Exited (0) 16 seconds ago             sleepy_colden
jeff@docker-host01:~$ docker run -it mysql:5.7 /bin/bash
root@d49e0f3b88ea:/# jeff@docker-host01:~$      // Ctrl + p + q : exit와 달리 컨테이너를 stop하지 않고 빠져나온다
jeff@docker-host01:~$ docker ps
CONTAINER ID   IMAGE       COMMAND                  CREATED          STATUS          PORTS                 NAMES
d49e0f3b88ea   mysql:5.7   "docker-entrypoint.s…"   15 seconds ago   Up 14 seconds   3306/tcp, 33060/tcp   festive_joliot
```

```bash
컨테이너는 외부 접근이 절대 안된다
외부 접근 하려면 192. 주소로 들어온다
NAPT ip port
~$ docker run -it -p 3306:3306 mysql:5.7 /bin/bash
	3306:3306(host port:container port)

192.168.56.101:3306 -> 172.17.0.2:3306 -> packet -> 연결 -> NAPT
```
