[서브네팅 연습](http://subnettingquestions.com/)

[시스코 패킷트레이서 6.2 다운로드](https://1drv.ms/u/s!AokEUKoMce1Ngo1whzNhtZUomXTi-A?e=Fb8Rof)

- 시나리오

회사는 위의 설계도와 같이 총 3개의 네트워크(A, B, C)로 구성되어 있다. 관리자는 IP Address의 낭비 없이 가장 적절히 모든 네트워크의 호스트 수를 만족하도록 IP Address 정책을 구상 중이다. Class C 192.168.0.0/24 하나를 서브넷팅하여 모든 네트워크에 설정해 보자.

각 네트워크의 호스트(PC)의 IP Address는 해당 Subnet의 사용 가능한 첫 번째, 두번째 IP Address를 사용하며 마지막 IP Address는 Gateway Address로 사용하도록 한다.

- IP Address 설계

모두 초록불이 들어와 구성이 완료되었음을 알 수 있다.


연결이 잘 되어있음

### 라우팅(Routing) 정의

라우터(Router)는 특정 인터페이스를 통하여 수신한 패킷(Packet)의 목적지 IP 주소를 읽고, 이 패킷(Packet)을 목적지와 연결되는 인터페이스를 통하여 전송 시켜주는 역할을 하며, 이 기능을 라우팅(Routing)이라고 한다. 

### 라우터의 기본 기능

1. 경로 결정 (이정표=Routing Table: 목적지 네트워크와 연결되는 인터페이스 기록한 DB)
2. 패킷 전송 (스위칭)
3. 네트워크 보안 (ACL, Authentication 등)
4. QoS (Quality of Service) 

### 라우팅 경로 결정

1. 정적 경로 (Static Route)

    네트워크 관리자가 특정 목적지에 대해서 직접 지정한 경로

2. 동적 경로 (Dynamic Route)
    1. 라우팅 프로토콜 (Routing Protocol)을 사용
    2. RIP, IGRP, OSPF, EIGRP, BGP, IS-IS, ODR 등이 있다.
3. 라우팅 프로토콜에 따라 한 번 결정된 경로를 계속 사용하는 경우도 있지만, 대부분은 경로가 유효한 지 주기적으로 확인한다.
4. 특정 경로가 다운되면 다른 경로를 찾아 대체한다. 

### 라우팅 프로토콜(Routing Protocol) 종류

1. 라우팅 프로토콜을 분류하는 기준에 따라 여러 가지로 분류된다.
2. 라우팅 정보(Routing Update)의 내용에 따라 Distance Vector, Link State로 분류
3. Subnet Mask 포함 여부에 따라 Classful Routing, Classless Routing으로 분류
4. AS(Autonomous System) 내부용 또는 외부용 여부에 따라 IGP(Interior Gateway Protocol), EGP(Exterior Gateway Protocol)로 분류 

### 라우터의 명령어 모드

1. 셋업모드(Setup Mode): 초기화된 라우터에 처음 접속하게 되면 대화식으로 라우터 설정할 것인지에 대해 묻는데 이를 셋업모드라고 한다.

    ```bash
    Would you like to enter the initial configuration dialog? [yes/no]:
    ```

    셋업모드는 불필요한 질문이 많고, 상세설정이 힘들어 거의 사용하지 않는다.

    셋업모드로 들어가는 경우는 라우터 최초 설정 시, 관리자모드에서 ‘setup’ 명령어 사용 시, 라우터 초기화 후 재부팅 할 시에 들어 갈 수 있다.

2. 사용자모드(User Mode): 사용자모드에서는 라우터 관리를 위한 제한된 기본적인 명령어만 사용할 수 있으며 프롬프트가 ‘>’로 끝난다.

    ```bash
    Router>
    ```

3. 관리자모드(Privilege Mode): 이용자모드에서 ‘enable’ 명령어를 사용하여 들어갈 수 있으며 라우터 관리(ping, debug, show 등)와 관련한 모든 것을 할 수 있다. 기본 프롬프트는 ‘#’로 끝난다.

    ```bash
    Router#
    ```

4. 설정모드(Configuration Mode): 관리자모드에서 ‘configure terminal’ 명령어를 사용하여 들어갈 수 있으며 패스워드 설정, 장치이름 부여 등 전체 설정 관련한 작업을 하며 전체 설정모드(Global Configuration Mode)라고도 한다. 기본 프롬프트는 ‘(config)#’로 끝난다.

    ```bash
    Router(config)#
    ```

5. 인터페이스 설정모드(Interface Configuration Mode): 설정모드에서 ‘interface [인터페이스명]’ 명령어를 사용하여 들어 갈 수 있으며 인터페이스 설정을 할 수 있다. 기본 프롬프트는 ‘(config-if)#’로 끝난다.

    ```bash
    Router(config-if)#
    ```

6. 라인 설정모드(Line Configuration Mode): 설정모드에서 ‘line [라인명] [라인번호]’ 명령어를 사용하여 들어 갈 수 있으며 라인 설정을 할 수 있다. 기본 프롬프트는 ‘(config-line)#’로 끝난다.

    ```bash
    Router(config-line)#
    ```

7. 라우터 설정모드(Router Configuration Mode): 설정모드에서 ‘router [Protocol] [Option]’ 명령어를 사용하여 들어갈 수 있으며 라우팅 프로토콜 설정을 할 수 있다. 기본 프롬프트는 ‘(config-router)#’로 끝난다.

    ```bash
    Router(config-router)#
    ```

8. 롬몬모드(ROM Monitor Mode): RXBOOT 모드라고도 하며 패스워드 및 IOS 복구를 위한 모드이며 부팅 시 단축키 Ctrl+Break 로 들어갈 수 있다.

    ```bash
    Rommon 1>
    ```

9. 각 모드에서 ‘exit’ 명령어를 사용하면 상위 모드로 빠져 나온다.
10. ‘end’ 명령어 또는 단축키 Ctrl+Z을 누루면 관리자 모드로 빠져 나온다.
11. 관리자모드에서 ‘disable’ 명령어를 사용하면 사용자모드로 빠져 나온다. 

### IOS 명령어 기능

1. 명령어 입력 중 띄워 쓰지 않고 물음표(?)를 입력하면 해당 글자로 시작하는 명령어들을 확인할 수 있다. 이 때 표시되는 명령어는 IOS의 버전 및 기능에 따라 다르다.

    ```bash
    Router# e?
    enable  erase  exit
    ```

2. 명령어 입력 후 한 칸 띄워 쓰고 물음표(?)를 입력하면 서브 명령어 및 옵션을 확인할 수 있다.

    ```bash
    Router# erase ?
    startup-config  Erase contents of configuration memory
    ```

3. 명령어 입력 중 Tab 키를 누르면 해당 명령어를 완성해 준다.

    ```bash
    Router# conf [TAB]
    Router# configure
    ```

### 명령어 오류 메시지

```bash
에러 메시지                                    설명
% Ambiguous command:  “e”                    모호한 명령어 입력
% Incomplete command.                        미완성된 명령어 입력
% Invalid input detected at ‘^’ marker.      ‘^’ 표시된 명령이 잘 못 입력
```

### 설정모드(Configuration Mode)에서 기본 설정사항

```bash
1. Router(config)# hostname R1 
2. R1(config)# no ip domain-lookup 
3. R1(config)# enable password cisco 
4. R1(config)# enable secret cisco
```

1. 라우터의 이름을 R1으로 지정. 호스트이름이 인증용 ID로 사용되기도 한다.
2. 사용자모드 또는 관리자모드에서 명령어가 아닌 문자열을 입력하는 경우 해당 문자열에 대한 IP주소를 검색하기 위해 DNS 서버를 찾게 되는데 이 기능을 비활성화 시키는 명령
3. 사용자모드에서 관리자모드로 진입 시 암호를 ‘cisco’로 한다.
4. 사용자모드에서 관리자모드로 진입 시 암호를 ‘cisco’로 하고 해당 암호를 MD5로 암호화 한다. 

### 라인모드(Line Mode)에서 기본 설정사항

```bash
1. R1(config)# line console 0 
2. R1(config-line)# logging synchronous 
3. R1(config-line)# exec-timeout 0 
4. R1(config-line)# exit 
5. R1(config)# line vty 0 15 
6. R1(config-line)# password cisco
```

1. 콘솔 라인 설정모드로 진입. ‘line 0’라고 해도 된다.
2. 입력 중인 명령어와 시스템 메시지 표시가 뒤섞이지 않게 한다.
3. 콘솔로 접속된 후 10분 동안 아무런 입력이 없으면 자동으로 사용자모드로 빠져 나오게 되는데 해당 모드를 유지시킨다. ‘exec-timeout 20 10’와 같이 20분10초로 타이머 설정가능
4. 설정모드로 빠져 나온다.
5. 텔넷 라인 설정모드로 진입. 동시 텔넷 접속 가능한 수는 IOS 및 장비 기능에 따라 다르다
6. 텔넷 암호를 ‘cisco’로 지정. ‘login’명령은 기본값으로 적용되어 있다. 

### 라우터 설정 확인 및 저장

1. 현재 라우터의 설정을 저장하지 않고 전원을 끄면 모든 설정은 사라진다.
2. 현재 적용되고 있는 설정 확인

    ```bash
    R1# show running-config
    R1# write terminal
    ```

3. 설정 내용 중 기본값으로 동작하는 명령이 있고 기본값이 아닌 명령도 있다.
4. 명령을 저장하면 NVRAM에 기록된다.
5. 저장된 설정 확인

    ```bash
    R1# show startup-config
    ```

6. 설정 저장

    ```bash
    R1# write memory
    R1# copy running-config startup-config
    ```
