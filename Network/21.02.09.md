### OSPF의 특징

1. 현재 사용하고 있는 OSPF는 ver2이며 RFC 2328에 규정되어 있는 표준 프로토콜이다.
2. OSPF는 IP Packet에서 Protocol Number 89를 사용하여 라우팅 정보를 전송한다.
3. 대규모 네트워크에서도 안정된 네트워크를 운영할 수 있다.
4. 설정이 비교적 까다롭다. (토폴로지에 따라 다른 설계가 필요하다.)
5. CPU, DRAM 등과 같은 자원을 비교적 많이 사용한다.
6. Link State이며 Classless Routing Protocol 이다.

### OSPF의 Routing Table 생성과정

1. OSPF Router 간에 Hello 패킷을 주고 받아 네이버(Neighbor) 관계를 구성한다.
2. 라우팅 정보를 교환하는 네이버(Adjacent Neighbor) 관계를 구성한다. 

    (Adjacent Neighbor : 절친 < Neighbor : 친구)

    ```
    OSPF에서 라우팅 정보를 LSA(Link State Advertisement)라고 하고, OSPF에서는 LSA를 모든 네이버(Neighbor) 간에 교환하지는 않는다. 
    LSA를 교환하는 네이버 관계를 Adjacent Neighbor라고 하고 Adjacent Neighbor 간에 LSA를 송수신한다.
    ```

3. LSA를 Link State Database에 저장한다.
4. LSA를 SPF 및 Dijkstra 알고리즘에 기반하여 목적지까지의 최적 경로를 산출한다.
5. Routing Table에 업데이트한다.
6. 주기적으로 Hello 패킷을 전송하여 각 라우터가 정상적으로 동작하고 있음을 확인하고 인접 라우터에게 알린다.
7. 만약 네트워크 상태에 변화가 있으면 과정을 반복하여 다시 Routing Table을 만든다.

![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e760d529-9e8a-4d65-8192-da930b0cd2e9/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e760d529-9e8a-4d65-8192-da930b0cd2e9/Untitled.png)

- 실습

    ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5071dbc5-9590-4447-865e-803d2042f6a7/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5071dbc5-9590-4447-865e-803d2042f6a7/Untitled.png)

    ### 네트워크 구성도

    ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c1e3909e-58c1-45f8-bf01-ed8e1125a609/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c1e3909e-58c1-45f8-bf01-ed8e1125a609/Untitled.png)

    Router: C3660, R2~R5 : slot 1 NM-4T

    ### 기본 설정

    ```
    enable 
    configure terminal 
    line console 0 
    logging synchronous 
    exec-timeout 0 
    password admin
    login 
    exit 
    line vty 0 4 
    password telnet 
    login 
    exit 
    no ip domain-lookup 
    enable secret cisco 
    hostname
    ```

    ### IP설정

    ```
    R1(config)#int f0/0
    R1(config-if)#ip add 172.16.1.254 255.255.255.0
    R1(config-if)#no sh
    R1(config-if)#int f0/1
    R1(config-if)#ip add 172.16.12.1 255.255.255.0
    R1(config-if)#no sh
    =============================================================
    R2(config)#int f0/0
    R2(config-if)#ip add 172.16.2.254 255.255.255.0 
    R2(config-if)#no sh
    R2(config-if)#int f0/1
    R2(config-if)#ip add 172.16.12.2 255.255.255.0
    R2(config-if)#no sh
    R2(config-if)#int s1/0
    R2(config-if)#en f
    R2(config-if)#no sh
    R2(config-if)#int s1/0.23 multipoint
    R2(config-subif)#ip add 172.16.23.2 255.255.255.0
    R2(config-subif)#frame-relay map ip 172.16.23.3 203 broadcast
    =============================================================
    R3(config)#int f0/0
    R3(config-if)#ip add 172.16.3.254 255.255.255.0
    R3(config-if)#no sh
    R3(config-if)#int s1/0
    R3(config-if)#en f
    R3(config-if)#no sh
    R3(config-if)#int s1/0.23 multipoint
    R3(config-subif)#ip add 172.16.23.3 255.255.255.0
    R3(config-subif)#frame-relay map ip 172.16.23.2 302 broadcast
    R3(config-subif)#int s1/0.34 point-to-point
    R3(config-subif)#ip add 172.16.34.3 255.255.255.0
    R3(config-subif)#frame-relay interface-dlci 304
    =============================================================
    R4(config)#int f0/0
    R4(config-if)#ip add 172.16.4.254 255.255.255.0
    R4(config-if)#no sh
    R4(config-if)#int s1/0 
    R4(config-if)#en f
    R4(config-if)#no sh
    R4(config-if)#int s1/0.34 point-to-point
    R4(config-subif)#ip add 172.16.34.4 255.255.255.0
    R4(config-subif)#frame-relay interface-dlci 403
    R4(config-fr-dlci)#int s1/1
    R4(config-if)#ip add 10.0.45.4 255.255.255.0
    R4(config-if)#no sh
    =============================================================
    R5(config)#int f0/0
    R5(config-if)#ip add 10.0.5.254 255.255.255.0
    R5(config-if)#no sh
    R5(config-if)#int s1/1
    R5(config-if)#ip add 10.0.45.5 255.255.255.0
    R5(config-if)#no sh
    =============================================================
    A> ip 172.16.1.1 24 172.16.1.254
    B> ip 172.16.2.1 24 172.16.2.254
    C> ip 172.16.3.1 24 172.16.3.254
    D> ip 172.16.4.1 24 172.16.4.254
    E> ip 10.0.5.1 24 10.0.5.254
    ```

    만약 인접장치간 ping이 안될시 sh run int s1/0.23로 확인

    ### OSPF 설정

    ```
    인터페이스 광고 방식
    R1(config)#router ospf 1
    R1(config-router)#router-id 1.1.1.1
    R1(config-router)#network 172.16.1.254 0.0.0.0 area 1
    R1(config-router)#network 172.16.12.1 0.0.0.0 area 1
    =============================================================
    서브넷 광고 방식
    R2(config)#router ospf 2
    R2(config-router)#router-id 2.2.2.2
    R2(config-router)#network 172.16.2.0 0.0.0.255 area 0
    R2(config-router)#network 172.16.12.0 0.0.0.255 area 1
    R2(config-router)#network 172.16.23.0 0.0.0.255 area 0
    =============================================================
    R3(config)#router ospf 3
    R3(config-router)#router-id 3.3.3.3
    R3(config-router)#network 172.16.3.0 0.0.0.255 area 0
    R3(config-router)#network 172.16.23.0 0.0.0.255 area 0
    R3(config-router)#network 172.16.34.0 0.0.0.255 area 2
    R3(config-router)#neighbor 172.16.23.2
    * non-Broadcast 네트워크 타입에서는 네이버를 수동으로 맺어 줘야 한다.
    =============================================================
    주 네트워크 광고 방식
    R4(config)#router ospf 4
    R4(config-router)#router-id 4.4.4.4
    R4(config-router)#network 172.16.0.0 0.0.255.255 area 2
    R4(config)#router rip
    R4(config-router)#ver 2
    R4(config-router)#network 10.0.0.0
    =============================================================
    R5(config)#router rip
    R5(config-router)#ver 2
    R5(config-router)#network 10.0.0.0
    ```

    network area 설정 확인 : sh run | begin area

    R1~R4끼리 모두 통신이 가능하지만 R5는 R4와만 통신이 가능하다.

    R4에서 재분배 설정이 필요하다.

    ### 재분배 설정

    ```
    *RIP 네트워크 내용을 OSPF에 재분배*
    R4(config)#router ospf 4
    R4(config-router)#redistribute rip subnets  
    		//subnet옵션: rip쪽 네트워크가 서브넷팅된 네트워크이기 때문

    *OSPF 네트워크 내용을 RIP에 재분배*
    R4(config)#router rip
    R4(config-router)#redistribute ospf 4 metric 15
    		//metric 값: 보안을 위해 ospf 네트워크 영역의 정보를 
    		  R5가 다른 라우터에 또 전달하지 못하도록 15를 준다.
    R4(config-router)#no auto-summary
    ```

    각 원격지에서 서로 ping 테스트 확인!

### 기본적인 OSPF 설정

```
R1(config)#router ospf [Process ID] 
R1(config-router)#router-id [Router ID] 
R1(config-router)#network [네트워크] [Wildcard Mask] area [Area Number] 
R1(config-router)#neighbor [Next Hop IP]
```

1. Process ID: 1~65535 사이의 적당한 값을 사용하며 동일 라우터에서 복수개의 OSPF 프로세스를 동작시키고자 할 때 상호 구분을 위한 목적으로 사용된다. 일반적으로 하나만 사용한다.
2. Router ID: Distance Vector는 라우팅 정보 전송 시 목적지 네트워크 및 메트릭 값만 알려주지만 Link State는 라우팅 정보를 만든 라우터와 해당 라우팅 정보를 전송하는 라우터가 누구인지도 알려준다. 이때 사용하는 것이 Router ID이다.

    ```
    Router ID는 변동되지 않는 IP주소를 사용해야 하며 Router ID 선출 우선순위는 
    1. Router-id 명령    2. 가장 높은 루프백 IP    3. 가장 높은 물리인터페이스 IP 
    재설정 Router ID를 적용하려면 재부팅(reload) 및 ‘clear ip ospf process’명령 사용한다.
    ```

3. Network 명령 : OSPF에 포함시킬 네트워크를 지정하는 방법은 다양하다.
4. Neighbor 지정 : Non-Broadcast 네트워크를 통하여 연결되는 라우터에서 OSPF 네이버를 지정해 주어야 한다. Router-ID가 높은 쪽에서만 지정해 준다.

### OSPF 패킷

1. OSPF는 네이버를 구성 및 유지, LSA를 교환하기 위해 여러가지 패킷을 사용한다.

    ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c58ee9a4-517d-434d-89c4-299a7879f236/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c58ee9a4-517d-434d-89c4-299a7879f236/Untitled.png)

2. Hello 패킷

    네이버 형성 및 유지에 사용되는 패킷이다. Hello 패킷을 수신하지 못하면 해당 네이버가 다운된 것으로 간주하여 네이버 관계를 해제한다.

    1. Router ID : OSPF 라우터 구분. OSPF 내에서 유일한 값
    2. Hello Interval : Hello 패킷 송신 주기. Point-to-Point는 10초, NBMA는 30초. 

        Dead Interval : Hello Interval의 4배

    3. Neighbors : 네이버(Hello 패킷교환가능) 라우터 ID
    4. Area-ID : OSPF가 설정된 Interface가 소속된 OSPF Area-ID 표시
    5. Router priority : 멀티엑세스 네트워크에서 DR, BDR 선출 시 사용되는 Priority
    6. DR IP address : Designated Router ID. 라우팅 정보 송수신의 중심 라우터
    7. BDR IP address : DR 다운 시 역할 승계되는 Backup DR의 Router-ID
    8. Authentication password : 인증 암호
    9. Stub area flag : Stub Area 임을 표시하는 필드

    밑줄 표시된 항목은 반드시 네이버 간에 일치해야 한다.

3. DDP (Database Description Packet)
    1. OSPF 라우터는 자신이 생성하거나 네이버에게 수신한 OSPF의 네트워크 정보(LSA)를 Link State Database에 저장한다.
    2. DDP는 OSPF 라우터의 Link State Database에 있는 LSA를 요약하여 알려주는 패킷이다.
    3. DBD 패킷이라고도 한다.
4. LSR (Link State Request)

    상대 라우터가 보낸 DDP를 보고 자신의 네트워크 정보(LSA)와 비교하여 자신이 가지고 있지 않은 정보에 대한 상세정보를 요청할 때 사용하는 패킷이다.

5. LSU (Link State Update)
    1. 상대 라우터에게서 LSR을 받거나 네트워크 상태가 변한 경우 라우팅 정보를 전송할 때 사용하는 패킷이다.
    2. LSU는 LSA를 실어 나른다.
6. LSAck (Link State Acknowledgment)
    1. OSPF 패킷을 정상적으로 수신했음을 알릴 때 사용하는 패킷이다.
    2. DDP, LSR, LSU 패킷을 수신하면 반드시 LSAck 패킷을 상대에게 보내어 정상적으로 수신했음을 알린다.

### OSPF 네이버

1. Hello 패킷을 이용하여 인접한 라우터 간에 네이버를 구성한다.
2. 수신한 Hello 패킷에 포함된 Neighbors List에 자신의 라우터 ID가 포함되어 있으면 그 라우터를 네이버로 간주한다. (동일항목은 반드시 같아야 한다.)
3. Ethernet 과 Point-to-Point 으로 전송되는 Hello 패킷의 목적지 주소는 224.0.0.5(멀티캐스트) 이고, Non-Broadcast 로 전송되는 Hello 패킷의 목적지 주소는 상대방 IP주소(유니캐스트)이다.

    ```
    R1#show ip ospf neighbor 
    R1#debug ip ospf hello
    ```

### DR과 BDR

1. Ethernet, NBMA 등의 멀티액세스 네트워크에 접속된 모든 OSPF 라우터 간에 LSA를 교환하면 중복된 LSA 및 LSAck가 많이 발생하게 되며 이런 현상을 방지하기 위하여 LSA를 하나의 대표 라우터(DR)에게만 보내고 이 라우터가 나머지 라우터(DRother)에게 중계하도록 한다.
2. BDR은 DR에 장애 발생시 대신 DR의 역할을 수행한다.
3. DR, BDR 선출 기준
    1. Interface의 OSPF Priority가 가장 높은 라우터가 DR, 다음이 BDR R1(config-if)#ip ospf priority [0~255]
    2. 라우터 ID가 가장 높은 라우터가 DR, 다음이 BDR
4. DR, BDR 선출 후에는 재부팅 및 ‘clear ip ospf process’ 명령을 사용하기 전까지는 재선출하지 않는다.
5. DR이 다운되면 BDR이 DR이 되고, BDR을 새로 선출한다.
6. Wait Timer(40초) 이 후 OSPF를 설정하면 이미 DR, BDR 선출한 후가 되므로 경우에 따라 process를 다시 동작 시켜줄 필요가 있다.
7. Point-to-Point 에서는 DR/BDR을 선출하지 않는다.
8. DRother 라우터끼리는 라우팅 정보를 교환하지 않는다.
- 실습2

    ### 네트워크 구성도

    ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5aedfcca-65fc-4aec-8081-f53689a5cf19/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5aedfcca-65fc-4aec-8081-f53689a5cf19/Untitled.png)

    router: 2621xm

    ### IP 설정

    ```
    R1(config)#int f0/0
    R1(config-if)#ip add 1.1.123.1 255.255.255.0
    R1(config-if)#no sh
    R1(config-if)#int lo0
    R1(config-if)#ip add 1.1.1.1 255.255.255.0
    R1(config-if)#router ospf 1
    R1(config-router)#network 1.0.0.0 0.255.255.255 area 0
    =======================================================
    R2(config)#int f0/0
    R2(config-if)#ip add 1.1.123.2 255.255.255.0
    R2(config-if)#no sh
    R2(config-if)#int lo 0
    R2(config-if)#ip add 2.2.2.2 255.255.255.0
    R2(config-if)#router ospf 2
    R2(config-router)#network 0.0.0.0 255.255.255.255 a 0
    =======================================================
    R3(config)#int f0/0
    R3(config-if)#ip add 1.1.123.3 255.255.255.0
    R3(config-if)#no sh
    R3(config-if)#int lo0
    R3(config-if)#ip add 3.3.3.3 255.255.255.0
    R3(config-if)#router ospf 3
    R3(config-router)#network 0.0.0.0 255.255.255.255 a 0
    =======================================================
    R4(config)#int f0/0
    R4(config-if)#ip add 1.1.123.4 255.255.255.0
    R4(config-if)#no sh
    R4(config-if)#int lo0
    R4(config-if)#ip add 4.4.4.4 255.255.255.0
    R4(config-if)#router ospf 4
    R4(config-router)#network 0.0.0.0 255.255.255.255 a 0
    ```

    ### 확인

    ```
    R4#show ip ospf interface f0/0
    FastEthernet0/0 is up, line protocol is up
      Internet address is 1.1.123.4/24, Area 0
      Process ID 4, Router ID 4.4.4.4, Network Type BROADCAST, Cost: 1
      Transmit Delay is 1 sec, State DROTHER, Priority 1
      Designated Router (ID) 1.1.1.1, Interface address 1.1.123.1
      Backup Designated Router (ID) 2.2.2.2, Interface address 1.1.123.2
      Timer intervals configured, Hello 10, Dead 40, Wait 40, Retransmit 5
        Hello due in 00:00:07
      Index 1/1, flood queue length 0
      Next 0x0(0)/0x0(0)
      Last flood scan length is 1, maximum is 1
      Last flood scan time is 0 msec, maximum is 0 msec
      Neighbor Count is 3, Adjacent neighbor count is 2
        Adjacent with neighbor 1.1.1.1  (Designated Router)
        Adjacent with neighbor 2.2.2.2  (Backup Designated Router)
      Suppress hello for 0 neighbor(s)
    ```

    ### Priority 값

    ```
    R4(config)#int f0/0
    R4(config-if)#ip ospf priority 255
    ===================================
    R3(config)#int f0/0
    R3(config-if)#ip ospf priority 200
    ===================================
    R2(config)#int f0/0
    R2(config-if)#ip ospf priority 0
    ===================================
    R1(config)#int f0/0
    R1(config-if)#ip ospf priority 0
    ```

    ### 라우터 재부팅

    ```
    R1~4#clear ip ospf process
    Reset ALL OSPF processes? [no]: yes
    ```

### OSPF 업데이트 패킷 전송 목적지 IP

![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/71e90815-e4d2-4716-b480-b515565144e9/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/71e90815-e4d2-4716-b480-b515565144e9/Untitled.png)

### Adjacency Neighbor

1. DR과 다른 라우터
2. BDR과 다른 라우터
3. Point-to-Point 네트워크로 연결된 라우터
4. Point-to-Multipoint 네트워크로 연결된 라우터
5. Virtual Link로 연결된 라우터
6. DRother 라우터 간에는 Adjacent Neighbor 관계를 구성하지 못한다. (2-Way 상태)

    ```
    R1#show ip ospf interface [인터페이스]
    ```

### 네이버 상태의 변화

1. Down: OSPF가 설정되고, Hello 패킷을 전송하지만 아직 다른 라우터로부터 Hello 패킷을 받지 못한 상태이다. 또, Dead interval 동안 OSPF 패킷을 받지 못한 상태에도 Down 표시.
2. Attempt: NBMA 모드에서만 적용되는 상태로 OSPF 설정모드에서 neighbor 명령어를 사용하여 지정한 네이버에게서 Hello 패킷을 수신하지 못한 상태이다.
3. Init: 네이버로부터 Hello 패킷을 받았으나 상대 라우터는 아직 나의 Hello 패킷을 수신하지 않은 상태이다. (네이버가 보내준 Hello 패킷의 네이버 리스트에 나의 라우터 ID가 없음)
4. Two-Way: 네이버와 쌍방향 통신이 이루어진 상태이다. DR/BDR 선출 준비 완료. DRother 간에는 라우팅 정보 교환하지 않으므로 Adjacency를 맺지 않는다.
5. Exstart: Adjacent Neighbor가 되는 첫 단계이다. Master/Slave 라우터 선출한다. DDP 패킷 교환 시 사용하는 Sequence Number를 결정한다.
6. Exchange: 각 라우터 자신의 Link State Database에 저장된 LSA의 Header만을 DDP에 담아 상대방에게 전송한다.
7. Loading: 상대로부터 DDP 수신이 끝난 후 LSR List에 기록해 둔 것이 있으면 LSR을 보내어 특정 LSA의 상세 정보를 보내줄 것을 요청한다. 요청 받은 라우터는 특정 LSA의 전체 정보를 LSU에 담아 전송한다.
8. Full: Adjacent Neighbor 라우터들 간에 라우팅 정보 교환이 끝난 상태이다.

    ```
    R1#debug ip ospf adj
    ```

### OSPF Metric

1. OSPF의 Metric은 Cost라고 한다. (출발지부터 목적지까지의 Cost 합계가 Metric이다.)
2. Cost = 기준 대역폭(Reference Bandwidth) / 실제 대역폭 이며 내림정수로 표시한다.
3. 기본 기준 대역폭은 10^8이다.

    ```
    결과적으로 기본 Cost는 Ethernet = 10, FastEthernet = 1, GigaEthernet= 1, Serial = 64
    ```

4. 기준 대역폭(Reference Bandwidth)을 변경하여 정확한 부하분산을 설계할 수 있다.

    ```
    R1(config-router)#auto-cost reference-bandwidth [Mbps단위]
    ```

5. 인터페이스에 ip ospf cost 명령으로 직접 OSPF cost를 변경할 수 있다.

    ```
    R1(config-if)#ip ospf cost [1~65535]
    ```

### OSPF Area

1. OSPF는 네트워크 규모에 따라 복수개의 Area로 나누어 설계한다.
2. Area는 0~약 42억 또는 0.0.0.0~255.255.255.255로 설정한다.
3. Area가 한 개일 경우에는 Area 번호를 아무거나 사용해도 되지만 복수 개일 경우 한 개는 Area 0로 설정하고 다른 Area가 물리적으로 연결되어 있어야 한다.
4. LSA 타입에 따라 내부로 전달되는 광고와 외부로 전달되는 광고로 나눈다.
5. OSPF는 Area 별로 축약을 설정하여 네트워크 정보를 전송한다.

### OSPF 라우터 종류

1. Backbone Router: Interface 중 한 개 이상이 Area 0에 소속된 라우터
2. Internal Router: 모든 Interface가 하나의 Area에 소속된 라우터
3. ABR(Area Border Router): Interface가 두 개 이상의 Area에 소속된 라우터
4. ASBR(AS Boundary Router): OSPF 와 다른 Routing Protocol로 연결되는 AS 경계 라우터 (재분배 실행하는 라우터)

### 네트워크 타입에 따른 OSPF 설정

1. OSPF는 네트워크 타입에 따라 설정 및 동작 방식이 다르다.
2. 네트워크 타입별 OSPF 동작

    ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d0b44ec9-00a7-488e-857a-9dca82010530/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d0b44ec9-00a7-488e-857a-9dca82010530/Untitled.png)

3. 네트워크 타입은 각 인터페이스 모드에서 변경 가능하다.

    ```
    R1(config-if)#ip ospf network [네트워크 타입]
    ```

4. 네트워크 타입이 달라도 Hello/Dead 주기는 반드시 같아야 한다.
5. 네이버 간의 네트워크 타입이 모두 DR/BDR 선출을 하거나 선출하지 않아야 한다.

### OSPF Default Route

```

R1(config-router)# default-information originate [always]
```

1. OSPF 프로세서 내에서 다른 네이버에게 Default Rotue 광고
2. 정적 경로로 설정된 Default Route가 다운되면 광고되지 않는다.
3. 정적 경로가 다운되더라도 항상 Default Route 를 광고하려면 always 옵션을 사용한다.

### OSPF Loopback Interface

1. OSPF에서 Loopback Interface에 설정된 IP 주소는 실제 네트워크 길이와 상관없이 단일 호스트(/32)로 광고된다.
2. Loopback 네트워크가 호스트로 광고되어도 OSPF의 동작에는 전혀 문제되지 않지만 아래의 3가지 방법으로 실제 서브네트워크의 길이로 광고할 수 있다.
    1. Network Type을 Point-to-Point로 변경 R1(config-if)# ip ospf network point-to-point
    2. Summary R1(config-router)# net [루프백 네트워크] [W/M] area [Area ID] R1(config-router)# area [Area ID] range [루프백 네트워크] [S/M]
    3. Redistribute R1(config-router)# redistribute connected subnets

### OSPF Area 경로

1. Intra area route: 동일한 Area에 소속된 네트워크로 가는 경로를 의미하며 ‘O’ 코드
2. Inter area route: 다른 Area에 소속된 네트워크로 가는 경로를 의미하며 ‘O IA’ 코드
3. External area route: 다른 라우팅 프로토콜에서 OSPF로 재분배된 네트워크이며 4가지 타입이 있다. (E1, E2, N1, N2)
    1. E1: OSPF Metric 누적
    2. E2: OSPF Metric 고정
    3. N1, N2: NSSA를 통해 광고 된 네트워크

### OSPF Stub Area

1. ABR이 내부 라우터에게 외부 경로에 대한 LSA를 차단하고 Default Route를 전달함으로 라우팅 테이블을 감소시키고 네트워크의 안정성을 높인다.
2. 장애처리가 쉬워지며 라우터의 자원도 적게 소모된다.

    ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e9c48fd8-6c84-4392-b293-a1a0dc22597e/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e9c48fd8-6c84-4392-b293-a1a0dc22597e/Untitled.png)

3. Stub Area 설정은 백본(Area 0)에서는 설정하지 않는다.
4. 가상 링크 설정 시 Transit Area가 될 수 없다.
5. Area 내부에 ASBR을 둘 수 없다.

### OSPF Summary

1. Stub Area는 특정 Area 내부 라우터들의 라우팅 테이블의 크기를 감소시키지만 Backbone Area에 소속된 라우터의 라우팅 테이블의 크기는 감소시키지 않는다.
2. OSPF Summary는 Backbone Area의 라우팅 테이블을 감소시킬 수 있다.
3. OSPF Summary는 ABR, ASBR에서 실시한다
4. OSPF Summary-ABR

    ```
    R1(config)# router ospf [Process ID]
    R1(config-router)# area [Area ID] range [Summary Network] [S/M]
    ```

    설정 후 라우팅 테이블 확인해 보면 축약된 네트워크의 Null 0 인터페이스가 생성되며 이는 라우팅 루프를 방지하기 위함이다.

5. OSPF Summary-ASBR

    ```
    R1(config)# router ospf [Process ID]
    R1(config-router)# summary-address [Summary Network] [S/M]
    ```

    설정 후 라우팅 테이블 확인해 보면 축약된 네트워크의 Null 0 인터페이스가 생성되며 이는 라우팅 루프를 방지하기 위함이다.

### OSPF Authentication

1. 네이버 인증

    ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ccb3fd32-beb7-4bc5-b72e-4850a8158434/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ccb3fd32-beb7-4bc5-b72e-4850a8158434/Untitled.png)

2. 에어리어 인증

    ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c0fbc515-e974-4a9a-8bb2-719a026e91bf/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c0fbc515-e974-4a9a-8bb2-719a026e91bf/Untitled.png)

### OSPF Virtual Link

1. OSPF의 모든 Area는 반드시 Backbone Area (Area 0)에 직접 연결되어 있어야 한다.
2. 특수한 경우 Backbone Area에 직접 연결될 수 없을 때 Virtual Link를 사용한다.
3. Virtual Link를 통해 생략되는 Area를 Transit Area라고 한다.
4. Virtual Link는 ABR 간에 양쪽 모두에 설정한다.

    ```
    R1(config)# router ospf [Process ID] 
    R1(config-router)# area [Area ID] virtual-link [Next Router ID] 
    R1#show ip ospf virtual-link
    ```
