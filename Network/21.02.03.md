# Static Route

### 정적 경로(Static Route) 특징

1. 라우팅으로 인한 부하가 거의 없다.
2. 경로를 관리자의 의도대로 정밀하게 제어할 수 있다.
3. 네트워크의 변화를 제대로 반영하지 못한다.
4. 간접 연결된 링크가 다운되어도 감지하지 못한다.
5. 네트워크 규모가 커지면 설정 및 관리가 어렵다.
6. Static Route와 Dynamic Route를 적당히 혼합하여 사용하는 것이 일반적이다.

### 기본적인 정적 경로 설정

```bash
1. R1(config)#ip route [Destination Network Address] [Destination S/M] [Next Hop IP] 
2. R1(config)#ip route [Destination Network Address] [Destination S/M] [Interface Name]
```

1. 패킷을 목적지 네트워크로 보내기 위해 다음 라우터 IP 주소로 설정한 방법
2. 패킷을 목적지 네트워크로 보내기 위해 해당 라우터의 인터페이스를 지정한 방법

### 축약을 이용한 정적 경로 설정

축약과 Longest Match Rule을 이용하면 정적 경로 설정이 간편하고 장애처리가 쉽다.

```bash
R1(config)# ip route [Summary Network Address] [Summary S/M] [Next Hop IP]
```

목적지 네트워크가 여러 개일 때 축약을 사용하면 라우팅 테이블 사이즈를 줄일 수 있다.

### Default Route를 이용한 정적 경로 설정

```bash
R1(config)#ip route 0.0.0.0  0.0.0.0  [Next Hop IP]
```

해당 라우터가 패킷의 목적지를 모를 때 Default Route 설정 된 Next Hop으로 보내진다.

### 부하분산(Load Balancing)

1. 시스코 라우터에서의 부하 분산은 프로토콜 및 IOS 버전에 따라 차이가 있다.
2. IOS 12.4에서는 최대 16개의 경로까지 부하 분산한다.

### 플루팅 정적 경로(Floating Static Route)

목적지 주소로 가는 경로가 두 개 이상일 경우 회선의 정적 경로의 AD 값을 상대적으로 높게 하여 평소에는 Routing Table에 설치하지 않고 주 라인이 다운되었을 때만 설치되게 하는 경로이다.

```bash
R1(config)#ip route [Destination Network Address] [Destination S/M] [Next Hop IP] [AD]
```

### Cisco 실습 설정 순서

```
장치 연결
기본 설정
IP 주소 설정
인접 장치 간 통신 확인
라우팅 설정
```

1. Cisco 실습 라우터 기본 CLI 설정

    ```
    enable
    configure terminal
    line console 0
    logging synchronous
    exec-timeout 0
    password console
    login
    exit
    line vty 0 4
    password telnet
    login
    exit
    no ip domain-lookup
    enable secret cisco
    hostname R1
    ```

2. IP 설정

    ```
    R1(config)#int f0/0
    R1(config-if)#description *** Network A ***
    R1(config-if)#ip add 192.168.1.254 255.255.255.0
    R1(config-if)#no shutdown

    잘못입력한 경우
    R2(config-if)#no ip add
    다시 설정
    ```

3. 핑 테스트

    ```
    R1(config)#int f0/0
    R1(config-if)#do ping 192.168.1.1

    Type escape sequence to abort.
    Sending 5, 100-byte ICMP Echos to 192.168.1.1, timeout is 2 seconds:
    .!!!!
    Success rate is 80 percent (4/5), round-trip min/avg/max = 0/0/0 ms
    ```

4. ip route 연결

    ```
    R1#conf t
    Enter configuration commands, one per line.  End with CNTL/Z.
    R1(config)#ip route 192.168.2.0 255.255.255.0 192.168.12.2
    R1(config)#do sh ip route
    Codes: C - connected, S - static, I - IGRP, R - RIP, M - mobile, B - BGP
           D - EIGRP, EX - EIGRP external, O - OSPF, IA - OSPF inter area
           N1 - OSPF NSSA external type 1, N2 - OSPF NSSA external type 2
           E1 - OSPF external type 1, E2 - OSPF external type 2, E - EGP
           i - IS-IS, L1 - IS-IS level-1, L2 - IS-IS level-2, ia - IS-IS inter area
           * - candidate default, U - per-user static route, o - ODR
           P - periodic downloaded static route

    Gateway of last resort is not set

    C    192.168.1.0/24 is directly connected, FastEthernet0/0
    S    192.168.2.0/24 [1/0] via 192.168.12.2
    C    192.168.12.0/24 is directly connected, FastEthernet0/1
    ```

![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e593dc34-5988-4aeb-8069-062a89981c18/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e593dc34-5988-4aeb-8069-062a89981c18/Untitled.png)

![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4103992c-8cda-46cf-8763-1e30956ec6e9/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4103992c-8cda-46cf-8763-1e30956ec6e9/Untitled.png)

부하분산

```
192.168.1.1 ---------- 192.168.3.1 통신
R3(config)#ip route 192.168.1.0 255.255.255.0 192.168.23.2
R1(config)#ip route 192.168.3.0 255.255.255.0 192.168.12.2
```

## 문제

1. 요구사항
가) 주어진 작업내용과 네트워크 구성도를 참고하여 네트워크 구성 작업을 완성하시오.
나) 네트워크를 구성 후 최종 결과물은 “홍길동.pkt”로 저장하여 제출하시오.
2. 작업내용
**가) 기본설정**
① ‘네트워크 구성도’를 참조하여 라우터 및 PC를 연결하고 디스플레이 이름을 변경하시오. 

    ② 모든 라우터에서 명령어를 잘못 입력 할 경우 DNS 질의를 하지 않도록 설정하시오.  

    → no ip domain-lookup

    ③ 모든 라우터에 콘솔 및 텔넷 접속할 경우 패스워드를 사용하여 인증 받을 수 있도록
    설정하시오. (단, 패스워드는 admin, 텔넷 라인은 5개, 모든 패스워드는 암호화 함) 

    → line vty 0 4

    → password telnet

    ④ 모든 라우터에 관리자 모드로 진입 시 패스워드를 사용하여 인증 받을 수 있도록 설정
    하되 MD5로 암호화 하시오. (단, 패스워드는 cisco)

    → enable secret cisco

    ⑤ R1 라우터에 콘솔로 접속 시 메시지가 보이도록 하시오. (메시지: This is Router R1) 

    → banner motd $

    → This is Router R1

    → $

    ⑥ 모든 라우터에 콘솔로 접속 후 명령어 입력이 없으면(IDLE) 2분 30초 뒤에 자동 로그아
    웃 되도록 하시오.

    → exec-timeout 2 30

    ⑦ 모든 라우터의 부서별 네트워크와 연결된 인터페이스에 아래 IP 주소 할당표를 참고하 여 부서명으로 부연설명을 설정 하시오.

    → int f0/0

    → description Engineer

    → ip add 172.16.100.94 255.255.255.224

    ```
    Router>
    Router>enable
    Router#configure terminal
    Enter configuration commands, one per line.  End with CNTL/Z.
    Router(config)#line console 0
    Router(config-line)#logging synchronous
    Router(config-line)#exec-timeout 2 30
    Router(config-line)#password console
    Router(config-line)#login
    Router(config-line)#exit
    Router(config)#line vty 0 4
    Router(config-line)#password telnet
    Router(config-line)#login
    Router(config-line)#exit
    Router(config)#no ip domain-lookup
    Router(config)#enable secret cisco
    Router(config)#banner motd $
    Enter TEXT message.  End with the character '$'.
    This is Router R1
    $

    Router(config)#hostname R1
    R1(config)#int f0/0
    R1(config-if)#description Engineer
    R1(config-if)#ip add 172.16.100.94 255.255.255.224

    * 기본 설정 *
    enable
    configure terminal
    line console 0
    logging synchronous
    exec-timeout 2 30
    password console
    login
    exit
    line vty 0 4
    password telnet
    login
    exit
    no ip domain-lookup
    enable secret cisco
    hostname 
    ```

    **나) IP 주소 설정**
    ① 모든 장치의 인터페이스 IP 주소는 ‘서브넷팅’을 푼 뒤 문제에서 요구하는 바에 따라 표 를 완성하고 적용하시오.

    ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2e5a35a9-f540-4408-8768-d0796184676a/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2e5a35a9-f540-4408-8768-d0796184676a/Untitled.png)

    **다) 서브넷팅**
    ①   이   회사에    할당된    IP 네트워크는    172.16.100.0/24이다.
    ②   Engineer  부서에는    15명, Marketing  부서에는    7명, Sales  부서에는    50명, Manage  부서 에는   3명의    부원이    있다.
    ③ 각 부서의 부원 수에 맞게 최적화된 서브넷팅을 실시하되 Sales(50),  Engineer(15), Marketing(7),  Manage(3)순으로 서브넷팅하고 IP  주소도 순차적으로 할당하시오. (단, Zerobit Subnet은 사용된다.)
    ④   각    서브넷의    가용한    첫    번째    IP는    부서별    PC에    할당하고    마지막    IP는    게이트웨이로    할 당하시오.
    **라) 정적경로    설정**
    ①   모든    PC들은    서로    루프    없는    패킷    전송을    하여야    하며    정적경로    설정    시    Next Hop IP 주소를    사용하여    설정하시오.

    → R1(config)#ip route 172.16.100.0 255.255.255.192 172.16.100.122

    → R1(config)#ip route 172.16.100.96 255.255.255.240 172.16.100.126

    ②   R1-R2  또는    R1-R3  또는    R2-R3  링크에    장애    발생    시에도    PC들    간의    통신은    보장되도 록   플루팅    정적경로를    설정하시오.

    → R1(config)#ip route 172.16.100.0 255.255.255.192 172.16.100.126 2

    → R1(config)#ip route 172.16.100.96 255.255.255.240 172.16.100.122 2

    ③   R4의   라우팅    테이블    엔트리   수가   최소화    되도록    축약하시오.

    → R4(config)#

    ④   R1, R2, R3는    기본경로(Default Route)가    R4가    되도록    설정하되    R4에서    축약한    경로에 대해    루프가    발생하지    않도록    설정하시오.

    → 

![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/0fe5cf65-7fce-4859-98a0-5083edc26ca8/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/0fe5cf65-7fce-4859-98a0-5083edc26ca8/Untitled.png)
