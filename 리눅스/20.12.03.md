## ğŸ™‹ğŸ»â€â™€ï¸ ì—¬ëŸë²ˆì§¸ ë¹„ëŒ€ë©´ ìˆ˜ì—…

- **ë°°ìš´ ë‚´ìš©**

  SetUID/SetGID

  â€‹	sticky bits

  ì‚¬ìš©ì í†µì‹ 

  â€‹	mail/wall ëª…ë ¹ì–´

  â€‹		mail ëª…ë ¹ì–´

  â€‹		wall ëª…ë ¹ì–´

  ìœ ìš©í•œ ëª…ë ¹ì–´

  â€‹	diff/sort/file ëª…ë ¹ì–´

  â€‹		diff ëª…ë ¹ì–´

  â€‹		sort ëª…ë ¹ì–´

  â€‹		file ëª…ë ¹ì–´

------

# ë‚´ìš© ì •ë¦¬

------

# SetUID / SetGID

---

ì‹¤í–‰íŒŒì¼ â€” [íŒŒì¼]

[íŒŒì¼] < ê¶Œí•œì„ ì†Œìœ í•œ ê²ƒì²˜ëŸ¼

setuid, setgid

0 000

chmod[0]755

íŒŒì¼ì— ëŒ€í•œ ì†Œìœ ê¶Œì„ ì ì‹œ ë‹¤ë¥¸ ì‚¬ìš©ìì—ê²Œ ë¹Œë ¤ ì¤Œìœ¼ë¡œ ì¸í•´ ì†Œìœ ê¶Œì´ ì—†ëŠ” ì‚¬ìš©ìê°€ ì ì‹œ ë™ì•ˆ íŒŒì¼ì— ëŒ€í•œ ì†Œìœ ê¶Œìœ¼ë¡œ ê¶Œí•œì„ í–‰ì‚¬ í•  ìˆ˜ ìˆëŠ” ê²ƒì„ ë§í•œë‹¤.

ê³µìœ í•œ ë””ë ‰í† ë¦¬ë‚˜ íŒŒì¼ì— ëŒ€í•œ íŠ¹ë³„í•œ í¼ë¯¸ì…˜ì„ ë¶€ì—¬í•˜ëŠ” ê²ƒìœ¼ë¡œì„œ íŒŒì¼ ì†Œìœ ì(owner)ë‚˜ superuserë§Œì´ íŒŒì¼ì— ëŒ€í•´ì„œëŠ” setuidì™€ setgidë¥¼ ì„¤ì •í•˜ê³ ,ë””ë ‰í† ë¦¬ì— ëŒ€í•´ì„œëŠ” sticky-bit í¼ë¯¸ì…˜ì„ ì„¤ì • í•  ìˆ˜ ìˆë‹¤.

absolute mode (octal mode)ë‚˜ symbolic modeë¥¼ ì‚¬ìš©í•˜ì—¬ ì§€ì •í•˜ê±°ë‚˜ í•´ì§€í•  ìˆ˜ ìˆë‹¤.

![setuid](https://user-images.githubusercontent.com/56914461/100988198-ce71e480-3592-11eb-8d35-b42a310e2441.png)

```bash
íŒŒì¼ì˜ ì†Œìœ ì     : root
shell ì˜ id       : user01
íŒŒì¼ì„ ì‹¤í–‰í•˜ëŠ” ì : user01
íŒŒì¼ ì‹¤í–‰ ì‹œ í•´ë‹¹ íŒŒì¼ì˜ ì†Œìœ ìë¡œ(ê¶Œí•œ íšë“) ë³€ê²½í•´ì¤€ë‹¤
íŒŒì¼ ì¢…ë£Œ ì‹œ í˜„ì¬ ì‰˜ ì‹¤í–‰ ìœ ì €ë¡œ ë³€ê²½í•´ì¤€ë‹¤
```

[ì°¸ê³ ] SetUIDì™€ SetGIDë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” í”„ë¡œê·¸ë¨

ì‹¤í–‰ ê¶Œí•œ(x)ì´ ì£¼ì–´ì§„ í”„ë¡œê·¸ë¨ì— setuid í¼ë¯¸ì…˜ì´ ì£¼ì–´ì§€ë©´ ëˆ„êµ¬ì—ê²Œë‚˜ **ê·¸ í”„ë¡œê·¸ë¨ì˜ ì†Œìœ ìì²˜ëŸ¼** ê·¸ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•  ê¶Œí•œì´ ì£¼ì–´ì§€ê³ , ë˜í•œ ì–´ëŠ ëˆ„êµ¬ì—ê²Œë‚˜ ê·¸ í”„ë¡œê·¸ë¨ì˜ **ê·¸ë£¹ì— ì†í•œ ê²ƒì²˜ëŸ¼ í•  ìˆ˜ ìˆë‹¤.** ì¦‰, ì‹¤í–‰ ê¶Œí•œ(x)ì„ ê°€ì§„ í”„ë¡œê·¸ë¨ì´ setuidì™€ setgid í¼ë¯¸ì…˜ì´ ì£¼ì–´ì§€ë©´ ê·¸ í”„ë¡œê·¸ë¨ì˜ ownerë‚˜ groupìœ¼ë¡œë¶€í„° UIDì™€ GIDë¥¼ ì–»ëŠ”ë‹¤. ì´ëŠ” í•´ë‹¹ í”„ë¡œê·¸ë¨ì´ ì‹œì‘ë  ë•Œ í”„ë¡œì„¸ìŠ¤ë¡œë¶€í„° UIDì™€ GIDë¥¼ ìƒì†ë°›ëŠ” ê²ƒê³¼ëŠ” ë‹¤ë¥´ë‹¤.

[ì°¸ê³ ] SetUIDë¥¼ ê°€ì§„ íŒŒì¼ì˜ ì˜ˆì‹œ

íŒ¨ìŠ¤ì›Œë“œë¥¼ ë³€ê²½í•  ìˆ˜ ìˆëŠ” ê¶Œí•œì„ rootì˜ ê¶Œí•œì´ë‹¤. ê·¸ë ‡ê¸°ì— ì¼ë°˜ ì‚¬ìš©ìëŠ” íŒ¨ìŠ¤ì›Œë“œ ê¶Œí•œì„ ë³€ê²½í•  ìˆ˜ ì—†ë‹¤. ì¼ë°˜ ì‚¬ìš©ìë„ íŒ¨ìŠ¤ì›Œë“œë¥¼ ë³€ê²½í•  ë•Œ ë§Œí¼ì€ rootê°€ ë˜ë„ë¡ ë§Œë“¤ì–´ì£¼ì–´ì•¼ í•œë‹¤. ê·¸ë ‡ê¸° ìœ„í•´ì„  /usr/bin/passwdì‹¤í–‰íŒŒì¼ì˜ ê¶Œí•œì´ rootì˜ SetUID ê¶Œí•œì´ ë¶€ì—¬ë˜ì–´ ìˆìœ¼ë©´ ëœë‹¤.

```bash
# ls -l /usr/bin/passwd
-rwsr-xr-x. 1 root root 33600  4ì›”  7  2020 /usr/bin/passwd
s : setuid
```

[íŠ¹ìˆ˜ê¶Œí•œ SetUID, SetGID, sticky bit í¼ë¯¸ì…˜]

```bash
íŠ¹ìˆ˜ê¶Œí•œ                    ì†Œìœ ìê¶Œí•œë¹„íŠ¸  ê·¸ë£¹ê¶Œí•œë¹„íŠ¸  ê¸°íƒ€ê¶Œí•œë¹„íŠ¸
SetUID SetGID sticky-bit  r w x       r w x      r w x
1      1      1           1 1 1       1 1 1      1 1 1
4      2      1

       ì²œ                  ë°±          ì‹­           ì¼
# chmod 755 file1 
# chmod 0755 file1

# chmod 22 file1 
# chmod 0022 file1

# chmod 4755 file1 
# chmod 6755 file1 
(0755 : rwxr-xr-x)(0755 : rwxr-xr-x)
(4755 : rwsr-xr-x)(6755 : rwsr-sr-x)

# chmod 2755 file1 
(0755 : rwxr-xr-x)
(2755 : rwxr-sr-x)

# chmod 1777 dir1

(0777 : rwxrwxrwx)
(1777 : rwxrwxrwt)
```

### [EX1] SetUID,SetGID ê¶Œí•œ ë¶€ì—¬

```bash
# cd /test 
# rm -rf /test/* 

# touch file1 
# ls -l file1
-rw-r--r-- 1 root root 0 Feb 11 09:37 file1
# chmod 755 file1
# ls -l file1
-rwxr-xr-x 1 root root 0 Feb 11 09:37 file1
# chmod 4755 file1 
# ls -l file1
-rwsr-xr-x 1 root root 0 Feb 11 09:37 file1
# chmod 2755 file1 
# ls -l file1
-rwxr-sr-x 1 root root 0 Feb 11 09:37 file1
# chmod 6755 file1 
# ls -l file1
-rwsr-sr-x 1 root root 0 Feb 11 09:37 file1
```

[ì°¸ê³ ] ê¶Œí•œ ì„¤ì •ì‹œ ìœ ì˜ì‚¬í•­

```bash
# chmod 4755 file1 (rwxr-xr-x  ->  rwsr-xr-x)
# chmod 4100 file1 (--x------  ->  --s------)
# chmod 4655 file1 (rw-r-xr-x  ->  rwSr-xr-x)

# chmod 2755 file1 (rwxr-xr-x  ->  rwxr-sr-x)
# chmod 2010 file1 (-----x---  ->  -----s---)
# chmod 2765 file1 (rwxrw-r-x  ->  rwxrwSr-x)
ì›ë˜ëŠ” ê¶Œí•œì´ ì—†ì–´ â€“ ë¡œ í‘œì‹œë˜ì–´ì•¼ í•˜ëŠ” ìë¦¬ì§€ë§Œ SETIDê°€ ë“¤ì–´ê°€ë©´ì„œ ì´ì „ ê¶Œí•œì´ ë³´ì´ì§€ ì•Šê²Œë˜ì–´ ëŒ€ë¬¸ìë¡œ í‘œì‹œëœë‹¤.
	rwx -> rws
	rw- -> rwS
ì›ë˜ ì´ ìë¦¬ëŠ” xë¼ëŠ” ë¬¸ìë¥¼ í‘œì‹œí•˜ê³  ì‹¤í–‰ê¶Œí•œì´ ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ìë¦¬
í•˜ì§€ë§Œ setuid, setgit bitê°€ ì„¤ì •ì´ ë˜ë©´ì„œ xë¬¸ìë¥¼ ë”ì´ìƒ í™•ì¸ì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— sì™€ Së¥¼ ì‚¬ìš©í•˜ì—¬ í˜„ì¬ ìë¦¬ì— xë¬¸ì(ì‹¤í–‰ê¶Œí•œ) ìœ ë¬´ë¥¼ í‘œì‹œí•œë‹¤.
s -> ì‹¤í–‰ê¶Œí•œì´ ìˆìŒ
S -> ì‹¤í–‰ê¶Œí•œì´ ì—†ìŒ
```

### [EX2] SetUID í™•ì¸

```bash
(ì¼ë°˜ì‚¬ìš©ì) $ passwd 
-> /etc/passwd(user01:x:501:501::/home/user01:/bin/bash)
-> /etc/shadow(user01:$1$D0aOO1Ns$Src3NlrAeQH8YIQwJ44bp1:15911:0:99999:7:::)
[passwd ëª…ë ¹ì–´ì˜ ë™ì‘]
ì¼ë°˜ì‚¬ìš©ìê°€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•˜ëŠ” ê²½ìš° ì‚¬ìš©í•˜ëŠ” ë‘ ê°€ì§€ íŒŒì¼
# /etc/passwd > ê¶Œí•œì´ ìˆìŒ
# /etc/shadow > ê¶Œí•œì´ ì—†ìŒ

1. passwd ëª…ë ¹ì–´ ì…ë ¥
2. passwd ëª…ë ¹ì–´ ì†ì„±ì— (ê¶Œí•œ) ìˆëŠ” setUID bit ë™ì‘ì„ í•˜ë©° ì‚¬ìš©ìì˜ ê¶Œí•œì„ ì ì‹œ rootê¶Œí•œì„ íšë“
3. ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•˜ë©° /etc/shadow (ì•”í˜¸íŒŒì¼)ì— ë³€ê²½ëœ ë¹„ë°€ë²ˆí˜¸ë¥¼ rootê¶Œí•œìœ¼ë¡œ ìˆ˜ì •í•œë‹¤.
4. ëª¨ë“  ì‘ì—…ì´ ì¢…ë£Œë˜ë©´ ê¶Œí•œì„ ë°˜í™˜í•˜ê³  ì¼ë°˜ê³„ì •ìœ¼ë¡œ ëŒì•„ê°„ë‹¤.
# ps -ef | grep passwd
root      310298  310204  0 10:51 pts/2    00:00:00 passwd
root      310301  305863  0 10:51 pts/1    00:00:00 grep --color=auto passwd

# ps -ef | grep 310204 /* ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì „ */
fedora    310204  310194  0 10:50 pts/2    00:00:00 -bash
root      310586  305863  0 10:55 pts/1    00:00:00 grep --color=auto 310204

# ps -ef | grep 310204 /* ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì¤‘ */
fedora    310204  310194  0 10:50 pts/2    00:00:00 -bash
root      310298  310204  0 10:51 pts/2    00:00:00 passwd
root      310317  305863  0 10:52 pts/1    00:00:00 grep --color=auto 310204

# ps -ef | grep 310204 /* ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ í›„ */
fedora    310204  310194  0 10:50 pts/2    00:00:00 -bash
root      310586  305863  0 10:55 pts/1    00:00:00 grep --color=auto 310204
# ls -l /usr/bin/passwd /etc/passwd /etc/shadow
-rw-r--r-- 1 root root 2936  Feb 11 06:29 /etc/passwd
-r-------- 1 root root 1275  6ì›” 11 15:17 /etc/shadow
-rw**s**r-xr-x 1 root root 22984 Jan  7 2007  /usr/bin/passwd
# chmod 755 /usr/bin/passwd 
# ls -l /usr/bin/passwd
-rwxr-xr-x 1 root root 22984  1ì›”  7  2007 /usr/bin/passwd
# su - fedora 
$ passwd
Changing password for user fedora.
Changing password for fedora
(current) UNIX password: (fedora)
passwd: Authentication token manipulation error
$ exit 
# passwd fedora
Changing password for user fedora.
New UNIX password: (fedora)
BAD PASSWORD: it is based on a dictionary word
Retype new UNIX password: (fedora)
passwd: all authentication tokens updated successfully.

(ì›ë³µ) /usr/bin/passwd (rwxr-xr-x  ->  rwsr-xr-x)
      # chmod 4755 /usr/bin/passwd
```

### [EX3] fedoraê°€ user01 ì‚¬ìš©ìì˜ ê¶Œí•œì„ ë¹Œë¦¬ëŠ” ê²½ìš°

```bash
# ssh user01@localhost
user01 ì‚¬ìš©ìë¡œ ë¡œê·¸ì¸

$ chmod 775 /home/user01 
$ cp /bin/touch /home/user01 
$ ls -l
-rwxr-xr-x 1 user01 user01 42284  3ì›” 17 01:20 touch

		/bin/touch         (rwxr-xr-x 1 root root)
		/home/user01/touch (rwxr-xr-x 1 user01 user01)

$ ./touch file1 
$ ls -l
-rw-rw-r-- 1 user01 user01     0  3ì›” 17 01:20 file1
-rwxr-xr-x 1 user01 user01 42284  3ì›” 17 01:20 touch
		/home/user01 (rwxrwxr-x  user01  user01)
		|
		+--- file1((0)ìƒì„±ê°€ëŠ¥)

$ chmod 4755 touch 
$ ls -l
-rw-rw-r-- 1 user01 user01     0  3ì›” 17 01:20 file1
-rwsr-xr-x 1 user01 user01 42284  3ì›” 17 01:33 touch
$ su â€“ fedora 
-> fedora ì•”í˜¸ ì…ë ¥

$ cd /home/user01 
$ touch file2
touch: cannot touch `file2': í—ˆê°€ ê±°ë¶€ë¨
		/home/user01 (rwxrwxr-x  user01  user01)
		|
		+--- file2((X)ìƒì„± ë¶ˆê°€ëŠ¥)

/bin/touch         (rwxr-xr-x 1 root root)       
/home/user01/touch (rwsr-xr-x 1 user01 user01)

$ ./touch file2 
$ ls -l
-rw-rw-r-- 1 user01 user01     0  3ì›” 17 01:20 file1
-rw-rw-r-- 1 user01 fedora     0  3ì›” 17 01:20 file2
-rwsr-xr-x 1 user01 user01 42284  3ì›” 17 01:33 touch
$ exit 
$ id 
-> user01 ì‚¬ìš©ì í™•ì¸

$ chmod 2755 touch  (rwxr-xr-x   ->   )
$ ls â€“l touch
-rwxr-sr-x  user01 user01  size mtime  touch
$ su - fedora 
-> fedora ì‚¬ìš©ì ì•”í˜¸ ì…ë ¥

$ cd /home/user01 
$ ./touch file3 
$ ls -l
-rw-rw-r-- 1 user01 user01     0 Apr 21 15:59 file1
-rw-rw-r-- 1 user01 fedora     0 Apr 21 16:02 file2
-rw-rw-r-- 1 fedora user01     0 Apr 21 16:04 file3
-rwxr-sr-x 1 user01 user01 42284 Apr 21 15:59 touch
		/home/user01   (rwxrwxr-x  user01 user01)
		|
		+--- file3((0)ìƒì„±ê°€ëŠ¥)
$ exit 
$ exit 
#
```

setuid, setgid ì“¸ê¹Œ..?

íŒŒì¼ ê³µìœ . í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ì—ì„œ ì‚¬ìš©

íŒŒì¼ì„ ìƒì„±í•˜ê³  ë‚˜ë©´ ê¶Œí•œ ë³€ê²½ì„ í•´ì¤˜ì•¼ í•˜ëŠ”ë° í•˜ì§€ ì•Šê³  ì‚¬ìš©í•  ë°©ë²•ì´ ë¬´ì—‡ì´ ìˆë‚˜ìš”?

### [EX4] bashì‰˜ì˜ SetUID ê¶Œí•œ ë¶€ì—¬

[TERM1] root ì‚¬ìš©ì í„°ë¯¸ë„

```bash
# ls -l /bin/bash
-rwxr-xr-x 1 root root 735004 Jan 22  2009 /bin/bash
# cp /bin/bash /test 
# cd /test 
# ls -l bash
-rwxr-xr-x 1 root root 735004 Feb 11 09:06 bash
		/bin/bash   (-rwxr-xr-x 1 root root 719K Jul 22  2011 /bin/bash*)
		/test/bash  (-rwxr-xr-x 1 root root 719K Jan 13 11:33 bash*)
# bash 
# ps 
# exit
exit
# ./bash
# ps 
# exit 

# chmod 4755 bash 
# ls -l bash
-rwsr-xr-x 1 root root 735004 Feb 11 09:06 bash
```

[TERM2] root ì‚¬ìš©ìì˜ ë‘ë²ˆì§¸ í„°ë¯¸ë„

```bash
# su - fedora 
$ cd /test 
$ ls -l bash
-rwsr-xr-x 1 root root 735004  Feb 11 09:06 bash
$ ./bash 
$ id         /* ì»¤ë„ 2.6ë²„ì „ë¶€í„°ëŠ” ì‰˜ì€ SetUID, SetGIDê¶Œí•œ ë¶€ì—¬ ë§‰ìŒ */
uid=1001(fedora) gid=1001(fedora) groups=1001(fedora) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
$ exit 
$ exit 
#
```

[ì°¸ê³ ] gcc í”„ë¡œê·¸ë¨ ì„¤ì¹˜ê°€ ë˜ì–´ ìˆì§€ ì•Šìœ¼ë©´

```bash
# which gcc 
# rpm -qa | grep gcc 
# dnf -y install gcc
```

[TERM1] root ì‚¬ìš©ìì˜ ì²«ë²ˆì§¸ í„°ë¯¸ë„

```bash
# cd /test 
# vi backdoor.c /* í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ í”„ë¡œê·¸ë¨ ë‚´ì—ì„œ ì‰˜ì„ ì‹¤í–‰ ì‹œí‚¤ëŠ” ê²ƒ */
------------------------------
#include <stdio.h>

main() 
{
setuid(0);
setgid(0);
system("/bin/bash");
}
------------------------------

------------------------------     < ë³€ê²½ëœ ë²„ì „
#include <stdio.h>
#include <unistd.h>
#include<stdlib.h>
#define _GNU_SOURCE

int main () 
{
	setuid(0);
	setgid(0);
	system("/bin/bash");
}
------------------------------
# gcc -o bashshell backdoor.c 
# ls -l bashshell
-rwxr-xr-x 1 root root 4934 Feb 11 09:22 bashshell
		# file /bin/ls
		# file /test/bashshell
```

[TERM2] fedora ì‚¬ìš©ì í„°ë¯¸ë„

```bash
# ssh fedora@localhost
-> fedora ì‚¬ìš©ìë¡œ ë¡œê·¸ì¸

$ cd /test 
$ ls -l bashshell
-rwxr-xr-x 1 root root 4934 Feb 11 09:22 bashshell
$ ./bashshell 
$ ps
 PID TTY          TIME CMD
 7195 pts/2    00:00:00 bash
 7226 pts/2    00:00:00 bashshell
 7227 pts/2    00:00:00 bash
 7249 pts/2    00:00:00 ps
$ id
uid=500(fedora) gid=500(fedora) groups=500(fedora)
$ exit 
$
```

[TERM1] root ì‚¬ìš©ì í„°ë¯¸ë„

```bash
# cd /test 
# chmod 4755 bashshell 
# ls -l bashshell
-rwsr-xr-x 1 root root 4934 Feb 11 09:22 bashshell
```

[TERM2] fedora ì‚¬ìš©ìì˜ í„°ë¯¸ë„

```bash
$ ./bashshell 
# id
uid=0(root) gid=0(root) groups=500(fedora)
# pwd
/test
# chmod 755 bash 
# ls -l
-rw-r--r--  1 root root     77  2??11 09:22 backdoor.c
-rwxr-xr-x  1 root root 735004  2??11 09:06 bash
-rwsr-xr-x  1 root root   4934  2??11 09:22 bashshell
# ./bash
# id
uid=0(root) gid=0(root) groups=500(fedora)
# exit 
# exit 
$ exit 
#
```

[ì°¸ê³ ] íŠ¹ìˆ˜ í¼ë¯¸ì…˜ì„ ê°€ì§„ íŒŒì¼ ì°¾ê¸°

```bash
[TERM1] # find / -perm -4000 -type f 
[TERM2] # find / -perm -2000 -type f
[TERM3] # find / \\( -perm -4000 -o -perm -2000 \\) -type f   (-o : OR, -a : AND)
# find / -perm -4000 -or -perm -2000 -type f 2> /dev/null
# find / -perm -4000 -or -perm -2000 -type f 2> /dev/null | wc -l
```

## Sticky Bits

---

íŒŒì¼ì— ì“°ê¸° ê¶Œí•œ ì—†ì–´ë„ ë””ë ‰í† ë¦¬ì— ì“°ê¸° ê¶Œí•œì´ ìˆëŠ” ê²½ìš° ë””ë ‰í† ë¦¬ ê¶Œí•œì— ì˜í•´ íŒŒì¼ì€ ì‚­ì œ ëœë‹¤. íŠ¹ì • ë””ë ‰í† ë¦¬ì˜ ê²½ìš° ê³µìœ ì˜ ëª©ì ìœ¼ë¡œ ì‚¬ìš© í•  ë•Œ ì‚¬ìš©ìë“¤ì— ì˜í•´ íŒŒì¼ì´ ìƒì„± ë  ìˆ˜ ìˆìœ¼ë‚˜ ë””ë ‰í† ë¦¬ì— íŒŒì¼ì„ ë§ˆìŒëŒ€ë¡œ ì‚­ì œ í•  ìˆ˜ ì—†ë„ë¡ sticky ê¶Œí•œì„ ë¶€ì—¬í•´ ì¤„ ìˆ˜ ìˆë‹¤. ë””ë ‰í† ë¦¬ì— ì“°ê¸° (íŒŒì¼ìƒì„±: touch, vië“±) ê¶Œí•œì´ ìˆì–´ë„ íŒŒì¼ì— ì‚­ì œê¶Œí•œ(rm)ì„ ì œê±°í•˜ë ¤ í•  ë•Œ ì‚¬ìš©í•œë‹¤. íŒŒì¼ì˜ ì†Œìœ ìë‚˜ ê·¸ë£¹ì˜ ê²½ìš° ë˜ëŠ” ê´€ë¦¬ìì˜ ê²½ìš° íŒŒì¼ì— ëŒ€í•œ ì†Œìœ ê¶Œì„ í–‰ì‚¬ í•  ìˆ˜ ê²½ìš°ëŠ” ì œì™¸ ëœë‹¤. ì¼ë°˜ì ìœ¼ë¡œ sticky bitëŠ” **ë””ë ‰í† ë¦¬ê°€ 777 ê¶Œí•œì¼ ë•Œ ì‚¬ìš©ëœë‹¤.**

ex) ê²Œì‹œíŒì˜ ê²½ìš°uid=1002(user01) gid=1002(user01) groups=1002(user01) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023

```bash
1ë²ˆê¸€
ì†Œìœ ì team01
ê´€ë¦¬ì master
ìœ ì €   ...
2ë²ˆê¸€
ì†Œìœ ì team02
ê´€ë¦¬ì master
ìœ ì €   ...
íŠ¹ìˆ˜ê¶Œí•œ                     ì†Œìœ ìê¶Œí•œë¹„íŠ¸  ê·¸ë£¹ê¶Œí•œë¹„íŠ¸  ê¸°íƒ€ê¶Œí•œë¹„íŠ¸  
SetUID  SetGID  sticky-bit r w x       r w x      r w x
0       0       1          1 1 1       1 1 1      1 1 1

        ì²œ                    ë°±          ì‹­          ì¼
```

[ì°¸ê³ ] sticky bitë¡œ ì„¤ì •ëœ ë””ë ‰í† ë¦¬

```bash
# ls -ld /tmp
drwxrwxrwt 13 root root 4096 Feb 11 09:22 /tmp
# rm -rf /tmp/*

tê¶Œí•œ í‘œê¸° 
# chmod 1777 dir1 (drwxrwxrwx  ->  drwwrwxrwt)
# chmod 1001 dir1 (d--------x  ->  d--------t)
# chmod 1776 dir1 (drwxrwxrw-  ->  drwxrwxrwT)
```

### [EX1] sticky bitë¡œ íŒŒì¼ ì‚­ì œ ê¶Œí•œ ì œê±°

[TERM1] user01 ì‚¬ìš©ì í„°ë¯¸ë„

```bash
# ssh user01@localhost
user01 ì‚¬ìš©ìë¡œ ë¡œê·¸ì¸

$ id
uid=1002(user01) gid=1002(user01) groups=1002(user01) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
$ cd /tmp 
$ mkdir stickybit 
$ echo 1111 > file10 
$ echo 2222 > stickybit/file2 
$ ls -l | grep user01
-rw-rw-r--. 1 user01 user01  5  6ì›” 26 12:02 file10
drwxrwxr-x. 2 user01 user01 19  6ì›” 26 12:02 sticybit
```

[TERM2] fedora ì‚¬ìš©ì í„°ë¯¸ë„

```bash
# ssh fedora@localhost
fedora ì‚¬ìš©ìë¡œ ë¡œê·¸ì¸

$ id
uid=1001(fedora) gid=1001(fedora) groups=1001(fedora) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
$ cd /tmp 
$ mkdir linux 
$ echo 3333 > file3 
$ echo 4444 > linux/file4 
$ ls -l | grep fedora
-rw-rw-r--. 1 fedora fedora  5  6ì›” 26 12:03 file3
drwxrwxr-x. 2 fedora fedora 19  6ì›” 26 12:03 linux
$ vi file3  ($ echo 4444 >> file3 )
3333
4444        <----- 'ìƒˆë¡œìš´ ë¼ì¸ ì¶”ê°€'
$ rm -rf linux 
$ rm file3 
$

$ ls -l file10
-rw-rw-r-- 1 user01 user01 5  3ì›” 18 12:44 file10
$ rm file10
rm: remove write-protected ì¼ë°˜ íŒŒì¼ 'file10'? y
rm: cannot remove 'file1': ëª…ë ¹ì´ í—ˆìš©ë˜ì§€ ì•ŠìŒ
$ mv file10 file2
mv: cannot move 'file1' to 'file2': ëª…ë ¹ì´ í—ˆìš©ë˜ì§€ ì•ŠìŒ
$ cp file10 file2 
$ ls -l file10 file2
-rw-rw-r-- 1 user01 user01 5  4ì›” 14 10:46 file1
-rw-rw-r-- 1 fedora fedora 5  4ì›” 14 10:51 file2
[ê²°ë¡ ] ìì‹ ì´ ì†Œìœ ê¶Œì„ ê°€ì§€ì§€ ì•Šì€ íŒŒì¼ì— ëŒ€í•´ì„œëŠ” ì›ë³¸ íŒŒì¼ì„ ìˆ˜ì •í•  ìˆ˜ ìˆëŠ” ëª…ë ¹ì–´ëŠ” í—ˆìš©ë˜ì§€ ì•ŠëŠ”ë‹¤.

ì›¹ ì‚¬ì´íŠ¸ ê²Œì‹œíŒì—ì„œ ë§ì´ ì‚¬ìš©í•˜ëŠ”ê²ƒì´ sticyBIT
```

# ì‚¬ìš©ì í†µì‹ 

---

# ë‹¨ì›ëª©í‘œ

------

- mail / mailx
- wall

------

# mail / wall ëª…ë ¹ì–´

------

- mail ëª…ë ¹ì–´

  ```bash
  # mail -s "OK : LINUXXXX" root < report.txt
  ```

- wall ëª…ë ¹ì–´

  ```bash
  # wall < /etc/MESS/work.txt
  ```

mail -s

```bash
/etc/hosts
í˜¸ìŠ¤íŠ¸ íŒŒì¼ì— ëŒ€í•œ ì •ì˜ íŒŒì¼
[ì‹ ë¢°]í•  ìˆ˜ ìˆëŠ” í˜¸ìŠ¤íŠ¸ì— ëŒ€í•œ ì •ì ì¸ í˜¸ìŠ¤íŠ¸ í…Œì´ë¸”
IP, hostname[FQDN], host í˜•ì‹
FQDN : domain name (www.example.com)
```

## mail ëª…ë ¹ì–´

---

ì „ì ìš°í¸ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ mailì´ë¼ëŠ” ëª…ë ¹ì„ ì‚¬ìš©í•œë‹¤. System V ê°™ì€ ê³„ì—´ì˜ Unixì—ì„œëŠ” mailxë¼ê³  í•˜ê¸°ë„ í•œë‹¤. BSDì—ì„œëŠ” mailì´ë¼ê³  í•˜ë©°, ë‹¹ì—°íˆ BSD ê³„ì—´ì¸ ë¦¬ëˆ…ìŠ¤ì—ì„œë„ ê·¸ë ‡ê²Œ ë¶€ë¥¸ë‹¤. ì‚¬ìš©ì IDë¥¼ ëª…ì‹œë˜ì§€ ì•Šê³ , ì¸ìˆ˜ ì—†ì´ mailì„ ì‹¤í–‰í•˜ë©´ ìˆ˜ì‹ ëœ í¸ì§€ë¥¼ ì½ì„ ìˆ˜ ìˆë‹¤. í¸ì§€ëŠ” mail ë””ë ‰í† ë¦¬ ì‚¬ìš©ìID ì´ë¦„ìœ¼ë¡œ ë§Œë“¤ì–´ì§„ íŒŒì¼ì— ì €ì¥ëœë‹¤.

```
# mail
bash: mail: ëª…ë ¹ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤...   8ë²„ì „ì—ì„œëŠ” mailëª…ë ¹ì–´ê°€ ê¸°ë³¸ì ìœ¼ë¡œ ì„¤ì¹˜ë˜ì–´ ìˆì§€ ì•Šê¸° ë•Œë¬¸ì— ì„¤ì¹˜í•´ì£¼ì–´ì•¼ í•œë‹¤.
'mailx' ëª…ë ¹ì„ ì œê³µí•˜ëŠ” 'mail' ê¾¸ëŸ¬ë¯¸ë¥¼ ì„¤ì¹˜í•˜ì‹œê² ìŠµë‹ˆê¹Œ? [N/y] y

 * í ëŒ€ê¸° ì¤‘... 
 * íŒ¨í‚¤ì§€ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ê³  ìˆìŠµë‹ˆë‹¤.... 
ë‹¤ìŒ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤:
 mailx-12.5-29.el8.x86_64	Enhanced implementation of the mailx command
ë³€ê²½ ì‚¬í•­ì„ ìˆ˜í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ? [N/y] y

 * í ëŒ€ê¸° ì¤‘... 
 * ì¸ì¦ ëŒ€ê¸° ì¤‘... 
 * í ëŒ€ê¸° ì¤‘... 
 * íŒ¨í‚¤ì§€ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ê³  ìˆìŠµë‹ˆë‹¤.... 
 * íŒ¨í‚¤ì§€ ë‹¤ìš´ë¡œë“œ ì¤‘... 
 * ë°ì´í„° ìš”ì²­ ì¤‘... 
 * ë³€ê²½ ì‚¬í•­ ì‹œí—˜ ì¤‘... 
 * íŒ¨í‚¤ì§€ ì„¤ì¹˜ ì¤‘... 
No mail for root

# mail
No mail for root
```

**[ëª…ë ¹ì–´ í˜•ì‹]**

```bash
# mail                        /* ë©”ì¼ í™•ì¸ */
# mail user01                 /* íŠ¹ì • ì‚¬ìš©ìë¡œ ë©”ì¼ ë³´ë‚´ê¸°, user01@example.com */
# mail -u user01              /* íŠ¹ì • ì‚¬ìš©ìì˜ mail í™•ì¸ */
# mail -s "Test Mail" user01  /* ì œëª©ì„ ëª…ë ¹ì–´ ì…ë ¥ì‹œ í¬í•¨í•˜ì—¬ mail ë³´ë‚´ê¸° */
```

**[ëª…ë ¹ì–´ ì˜µì…˜]**

**ì˜µì…˜ : ì„¤ ëª…**

-s : mailì˜ ì œëª©ì„ ë¨¼ì € ê¸°ì¬í•œë‹¤. -u : ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬ìš©ìì˜ mailì„ ì—´ì–´ ë³¼ ìˆ˜ ìˆë‹¤.

[ì°¸ê³ ]

```bash
 # mail -s "OK: linuxXXX" [admin@example.com](<mailto:admin@example.com>) < /test/report.txt
/test/report.txt íŒŒì¼ì„ ë‚´ìš©ì„ ì…ë ¥ë°›ì•„ ë©”ì¼ì „ì†¡í•œë‹¤
íŒ¨í‚¤ì§€ = windows > ì„¤ì¹˜ í”„ë¡œê·¸ë¨, ì„¤ì¹˜ ê¾¸ëŸ¬ë¯¸
rmp..?
ì˜ì¡´ì„± ë¬¸ì œ í•´ê²°ì„ ìœ„í•´ì„œ dnf -
```

(ì£¼ì˜) ë©”ì¼ í…ŒìŠ¤íŠ¸ í•˜ê¸° ì „ ì‘ì—…

```bash
# vi /etc/hosts
[ìˆ˜ì •ì „]
127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
::1         localhost localhost.localdomain localhost6 localhost6.localdomain6
[ìˆ˜ì •í›„]
127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
::1         localhost localhost.localdomain localhost6 localhost6.localdomain6
192.168.10.200  server1.example.com     server1
192.168.10.252  server2.example.com     server2

# vi /etc/resolv.conf
search example.com
nameserver 168.126.63.1

[ì°¸ê³ ]
centos 5ë²„ì „ì€ postfixê°€ ì•„ë‹ˆë¼ sendmail íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤. í•˜ì§€ë§Œ í˜„ì¬ëŠ” postfixë¡œ ì‚¬ìš©í•œë‹¤.

**# dnf -y install postfix mailx
# systemctl restart postfix
# systemctl status postfix**
```

### [EX1] user01 ì‚¬ìš©ìì—ê²Œ mailë³´ë‚´ê³  í™•ì¸í•˜ê¸°

```bash
# mail user01 /* ë°›ëŠ” ì‚¬ëŒì˜ ë©”ì¼ ì£¼ì†Œ(EX: user01@naver.com) */
Subject: test mail
user01 Hi~~
<CTRL + D> or <.>
# mail
No mail for root (í˜„ì¬ rootì—ëŠ” ë©”ì¼ì´ ì—†ë‹¤.)
```

### [EX2] ë‹¤ë¥¸ ì‚¬ìš©ìì˜ mail í™•ì¸í•˜ê¸°

ê´€ë¦¬ì(EX: root) ì‚¬ìš©ìëŠ” ëª¨ë“  ì‚¬ìš©ìì˜ ë©”ì¼ í™•ì¸ì´ ê°€ëŠ¥í•˜ë‹¤. ì¼ë°˜ ì‚¬ìš©ì(EX: fedora)ëŠ” ìì‹ ì˜ ë©”ì¼ í™•ì¸ë§Œ ê°€ëŠ¥í•˜ë‹¤.

```bash
# mail -u user01 /* í•´ë‹¹ ì‚¬ìš©ìì˜ mail ì½ê¸° */
Heirloom Mail version 12.5 7/5/10.  Type ? for help.
"/var/mail/user01": 1 message 1 new
>N  1 root                  Mon Mar 16 15:49  18/605   "test mail"
	N : ìƒˆë¡œìš´ ë©”ì¼
  1 : ì²«ë²ˆì§¸ ë©”ì¼ 
	root : ë³´ë‚¸ ID
  Mon Mar 16 15:49  18/605 : ë³´ë‚¸ ì‹œê°„
  "test mail" : ë©”ì¼ ì œëª©
& quit
Held 1 message in /var/mail/user01

[user01ë¡œ ìƒˆë¡œìš´ ë©”ì¼ì„ í•˜ë‚˜ ë” ì‘ì„±]
# mail user01
Subject: test mail2
user01 HI
.
EOT

# mail -u user01
Heirloom Mail version 12.5 7/5/10.  Type ? for help.
"/var/mail/user01": 2 messages 1 new 2 unread
 U  1 root                  Mon Mar 16 15:49  19/615   "test mail"
>N  2 root                  Mon Mar 16 15:53  18/606   "test mail2"

& 1
Message  1:
From root@server1.example.com  Mon Mar 16 15:49:18 2020
Return-Path: <root@server1.example.com>
X-Original-To: user01
Delivered-To: user01@server1.example.com
Date: Mon, 16 Mar 2020 15:49:18 +0900
To: user01@server1.example.com
Subject: test mail
User-Agent: Heirloom mailx 12.5 7/5/10
Content-Type: text/plain; charset=us-ascii
From: root@server1.example.com (root)
Status: RO

user01 HI

&

& 2
Message  2:
From root@server1.example.com  Mon Mar 16 15:53:44 2020
Return-Path: <root@server1.example.com>
X-Original-To: user01
Delivered-To: user01@server1.example.com
Date: Mon, 16 Mar 2020 15:53:44 +0900
To: user01@server1.example.com
Subject: test mail2
User-Agent: Heirloom mailx 12.5 7/5/10
Content-Type: text/plain; charset=us-ascii
From: root@server1.example.com (root)
Status: R

user01 HI

& quit 
Held 2 messages in /var/mail/user01
```

### [EX3] ì œëª©ì„ í¬í•¨í•˜ì—¬ mail ì „ì†¡í•˜ê¸°

```bash
# mail -s "test" user01 /* -s: Subject, mailì˜ ì œëª©ì„ í¬í•¨í•˜ì—¬ mail ì°½ ì—´ê¸° */

Linux
.
EOT
# mail -u user01
Heirloom Mail version 12.5 7/5/10.  Type ? for help.
"/var/mail/user01": 3 messages 1 new
    1 root                  Mon Mar 16 15:49  19/616   "test mail"
    2 root                  Mon Mar 16 15:53  19/617   "test mail2"
>N  3 root                  Mon Mar 16 16:00  18/596   "test"
& 3
Message  3:
From root@server1.example.com  Mon Mar 16 16:00:27 2020
Return-Path: <root@server1.example.com>
X-Original-To: user01
Delivered-To: user01@server1.example.com
Date: Mon, 16 Mar 2020 16:00:27 +0900
To: user01@server1.example.com
Subject: test
User-Agent: Heirloom mailx 12.5 7/5/10
Content-Type: text/plain; charset=us-ascii
From: root@server1.example.com (root)
Status: R

Linux

&
& q
Held 3 messages in /var/mail/user01

# mail -s "TEST" user01 < /etc/hosts   (# mail -s "OK : linux200" admin@example.com < report.txt)
# mail -u user01
Heirloom Mail version 12.5 7/5/10.  Type ? for help.
"/var/mail/user01": 4 messages 1 new
    1 root                  Mon Mar 16 15:49  19/616   "test mail"
    2 root                  Mon Mar 16 15:53  19/617   "test mail2"
    3 root                  Mon Mar 16 16:00  19/607   "test"
>N  4 root                  Mon Mar 16 16:02  21/834   "TEST"
& 4
Message  4:
From root@server1.example.com  Mon Mar 16 16:02:22 2020
Return-Path: <root@server1.example.com>
X-Original-To: user01
Delivered-To: user01@server1.example.com
Date: Mon, 16 Mar 2020 16:02:22 +0900
To: user01@server1.example.com
Subject: TEST
User-Agent: Heirloom mailx 12.5 7/5/10
Content-Type: text/plain; charset=us-ascii
From: root@server1.example.com (root)
Status: R

127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
::1         localhost localhost.localdomain localhost6 localhost6.localdomain6
192.168.10.200	server1.example.com	server1
192.168.10.252	server2.example.com	server2

&
```

### [EX4] ì™¸ë¶€ ë©”ì¼ ì „ì†¡

```bash
# mail -s "test mail(EX: linuxXXX)" XXXXXX@gmail.com < /etc/hosts 
-> ì›¹ì—ì„œ í™•ì¸
```

[ì°¸ê³ ] ë‹¤ì¤‘ ì‚¬ìš©ìì—ê²Œ ë©”ì¼ ë³´ë‚´ê¸°

```bash
# cat email.list
root
user01
fedora
......

# for email in `cat emal.list`
do
mailx -s "OK: linux2XX" admin@example.com < report.txt
done
```

[ì°¸ê³ ] mail í™•ì¸í•˜ê¸°

```bash
# mail
& help /* ë„ì›€ë§ ì¶œë ¥ */
& ?/* ë„ì›€ë§ ì¶œë ¥ */
Mail   Commands
t <message list>                type messages
n                               goto and type next message
e <message list>                edit messages
f <message list>                give head lines of messages
d <message list>                delete messages
s <message list> file           append messages to file
u <message list>                undelete messages
R <message list>                reply to message senders
r <message list>                reply to message senders and all recipients
pre <message list>              make messages go back to /usr/spool/mail
m <user list>                   mail to specific users
q                               quit, saving unresolved messages in mbox
x                               quit, do not remove system mailbox
h                               print out active message headers
!                               shell escape
cd [directory]                  chdir to directory or home if none given

A <message list> consists of integers, ranges of same, or user names separated
by spaces.  If omitted, Mail uses the last message typed.

A <user list> consists of user names or aliases separated by spaces.
Aliases are defined in .mailrc in your home directory.

& h/* ëª©ë¡ë³´ê¸° */
& d 1-3/* 1ë²ˆë¶€í„° 3ë²ˆ ë©”ì¼ ì‚­ì œ */
& 5/* ë²ˆí˜¸ ì…ë ¥ -> íŠ¹ì • ë²ˆí˜¸ ë©”ì¼ ì½ê¸° */
& q         /* í•œ ë²ˆ ì½ì€ ë©”ì¼ì€ q ë¡œ ì¢…ë£Œí•˜ë©´ ì €ì¥ì´ ë˜ê¸° ë•Œë¬¸ì— ë‚˜íƒ€ë‚˜ì§€ ì•ŠìŒ
                                       x ë¡œ ì¢…ë£Œí•˜ë©´ ì½ì€ ë©”ì¼ë„ ë‹¤ì‹œ ë‚˜íƒ€ë‚œë‹¤. */
```

## wall ëª…ë ¹ì–´

---

ì ‘ì† ì¤‘ì¸ ëª¨ë“  ì‚¬ìš©ìì—ê²Œ ë©”ì‹œì§€ë¥¼ ì „ì†¡í•  ë•Œ ì‚¬ìš©í•œë‹¤. ì˜ˆë¥¼ ë“¤ë©´, ê´€ë¦¬ìê°€ ì‹œìŠ¤í…œ ì¬ì‹œì‘í•˜ë ¤ í•  ë•Œ ë¯¸ë¦¬ ì ‘ì† ì¤‘ì¸ ì‚¬ìš©ìë“¤ì—ê²Œ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ê³ ì í•  ë•Œ ì‚¬ìš©í•œë‹¤.

**[ëª…ë ¹ì–´ í˜•ì‹]**

```bash
# wall "test messages"
```

### [EX] wall ëª…ë ¹ì–´ ì‹¤ìŠµ

[TERM1] user01 ì‚¬ìš©ì ìœˆë„ìš°

```bash
# telnet localhost 
user01 ì‚¬ìš©ìì˜ ìœˆë„ìš°
```

[TERM2] ê´€ë¦¬ì ìœˆë„ìš°

```bash
# wall "hello welcome to linux"
```

### [EX2] wall ëª…ë ¹ì–´ ì‹¤ìŠµ

```bash
# wall < /etc/hosts 

# wall
hello welcome to linux
<CTRL + D>
```

[ì‹¤ë¬´ ì˜ˆ] ê¸´ê¸‰í•œ ì‘ì—… ê³µì§€ì‹œ

```bash
â–  ê¸´ê¸‰í•œ ì‘ì—…(EX: fsck CMD, dump CMD)
# wall < /etc/MESS/work.txt 
..... 10ë¶„ .....
# wall < /etc/MESS/work.txt 
..... 20ë¶„ ......
#
```

# ìœ ìš©í•œ ëª…ë ¹ì–´

---

# ë‹¨ì›ëª©í‘œ

------

- diff ëª…ë ¹ì–´
- sort ëª…ë ¹ì–´
- file ëª…ë ¹ì–´

------

# diff/sort/file ëª…ë ¹ì–´

------

- **diff ëª…ë ¹ì–´**

  ```bash
  # diff file1 file2
  # diff â€“-recursive dir1 dir2
  ```

- **sort ëª…ë ¹ì–´**

  ```bash
  # CMD | sort â€“k 3
  # CMD | sort â€“k 3 â€“r
  # df â€“h
  # du â€“sk /var
  # cd /var ; du â€“sk * | sort â€“nr | more
  ```

- **file ëª…ë ¹ì–´**

  ```bash
  # cd /etc ; file *
  ```

## diff ëª…ë ¹ì–´

---

ì–´ëŠ íŒŒì¼ì— ë‚´ìš©ì´ ì¶”ê°€ ë˜ì—ˆê³  ì–´ëŠ íŒŒì¼ì— ë‚´ìš©ì´ ì‚­ì œ ë˜ì—ˆëŠ”ì§€ ì°¾ëŠ” ìš©ë„

UDP, TCP

ë³´ë‚´ëŠ” ë„ì¤‘ í™•ì¸ì„ í•˜ì§€ ì•ŠëŠ” íŒŒì¼ì— ëŒ€í•´ì„œëŠ” ì–´ë–»ê²Œ í™•ì¸ì„ í•  ê²ƒì¸ê°€?

[ëª…ë ¹ì–´ í˜•ì‹]

```bash
# diff file1 file2/* ë‘ ê°œì˜ íŒŒì¼ì— ëŒ€í•œ ê°„ëµí•œ ì°¨ì´ì  */
# diff -c file1 file2 /* ë‘ ê°œì˜ íŒŒì¼ì— ëŒ€í•œ ìì„¸í•œ ì°¨ì´ì  í™•ì¸ */
# diff -i file1 file2 /* -i : ëŒ€ì†Œë¬¸ìë¥¼ êµ¬ë¶„í•˜ì§€ ë§ì•„ë¼. Aì™€ aëŠ” ê°™ì€ ê²ƒìœ¼ë¡œ ê°„ì£¼ */
```

[ëª…ë ¹ì–´ ì˜µì…˜]

**ì˜µì…˜ : ì„¤ëª…**

--brief : ë‘ íŒŒì¼ì˜ ë‚´ìš©ì´ ê°™ì€ì§€ ë‹¤ë¥¸ì§€ ì•Œì•„ë´„ -c : íŒŒì¼ì˜ ì´ë¦„, ë‚ ì§œ ë“± íŒŒì¼ì˜ ì°¨ì´ì ì„ ìƒì„¸íˆ ì¶œë ¥ -d : ë‘ ë””ë ‰í† ë¦¬ê°„ì˜ ì°¨ì´ì  ì¶œë ¥ -H : ìš©ëŸ‰ì´ í° íŒŒì¼ ë¹„êµ ì‹œ ì†ë„ë¥¼ ë¹ ë¥´ê²Œ ë¹„êµ -i : ëŒ€ì†Œë¬¸ì êµ¬ë¶„í•˜ì§€ ì•ŠìŒ -r **--recursive :** ë‘ ë””ë ‰í† ë¦¬ë¥¼ ë¹„êµí• ë•Œ, ëª¨ë“  ì„œë¸Œë””ë ‰í† ë¦¬ëŠ” ì¬ê·€ì ìœ¼ë¡œ(recursively) ë¹„êµí•œë‹¤.

[ì„ ìˆ˜ì‘ì—…]

```bash
# cd /test 
# cat > file1
11111
22222
33333
<Ctrl + D>
# cat > file2
11111
22222
33333
<Ctrl + D>
# cat > file3
11111
22222
44444
<Ctrl + D>
```

### [EX1] íŒŒì¼ ë¹„êµ

```bash
# cd /test
# diff file1 file2
# diff file1 file3  [ cmpì™€ ë‹¬ë¦¬ íŒŒì¼ì˜ í‹€ë¦° ë¼ì¸ì„ í‘œì‹œí•´ ì¤€ë‹¤ ì¢Œ : < , ìš° : > ]
3c3
< 33333
---
> 44444
# diff -c file1 file3
*** cmpfile1    Wed Jan 27 00:54:39 2010
--- cmpfile3    Wed Jan 27 00:55:05 2010
***************
*** 1,3 ****
  11111
  22222
! 33333
--- 1,3 ----
  11111
  22222
! 44444
```

### [EX2] ëŒ€ì†Œë¬¸ì êµ¬ë³„ ì—†ì´ íŒŒì¼ ë¹„êµ

```bash
# echo "iiiii" >> file1
# echo "IIIII" >> file2

# diff file1 file2
4c4
< iiiii
---
> IIIII
# diff -i file1 file2        (-i : ignore case, ëŒ€ì†Œë¬¸ì êµ¬ë¶„í•˜ì§€ ì•ŠìŒ)
#
```

### [EX3] ë””ë ‰í† ë¦¬ ë¹„êµì‹œ

```bash
# cd /test 
# rm -rf /test/* 

# mkdir dir1 
# echo "1111" > dir1/file1
# mkdir dir2 
# echo "2222" > dir2/file1
# diff --recursive dir1 dir2   /* -r ì˜µì…˜ìœ¼ë¡œë„ ì‚¬ìš©ê°€ëŠ¥) */
diff --recursive dir1/file1 dir2/file1
1c1
< 1111
---
> 2222
# echo "1111" >  dir2/file1   <----- '2222 -> 1111' ë³€ê²½
# touch dir2/file2 
# diff --recursive dir1 dir2 ë‘ ë””ë ‰í† ë¦¬ë¥¼ ë¹„êµí•  ë•Œ ì‚¬ìš©í•œë‹¤
Only in dir2: file2
```

(ì‹¤ë¬´ ì˜ˆ) íŒŒì¼ ë¹„êµ

```bash
(ì› ë³¸)                                -------------------------------->      (ë°±ì—… ë³¸) 
	/stage1/source/* (server.xml)                                           /stage2/source/* (server.xml)
  stage1 ìŠ¤í† ë¦¬ì§€ ì„œë²„ì—ì„œ stage2 ìŠ¤í† ë¦¬ì§€ ì„œë²„ë¡œ ë°ì´í„° ë°±ì—… ì‘ì—…
  ë°±ì—… ì™„ë£Œ
# diff server.xml servier.xml

[EX] /etc/httpd/conf/httpd.conf íŒŒì¼
# dnf -y install httpd
# cd /test ; rm -rf /test/*
# cp /etc/httpd/conf/httpd.conf /test 
# cp httpd.conf httpd.conf.old 
# vi httpd.conf 
/ServerName -> n 
[ìˆ˜ì •ì „]
#ServerName www.example.com:80
[ìˆ˜ì •í›„] [192.168.10.200 ì„œë²„ì—ì„œ ì‘ì—…]
ServerName 192.168.10.200:80
> íŒŒì¼ ì €ì¥
# diff httpd.conf httpd.conf.old

(ì‹¤ë¬´ ì˜ˆ) ë””ë ‰í† ë¦¬ ë§ˆì´ê·¸ë ˆì´ì…˜ ì‘ì—…
/was1/*  ---- Migration ----> /was2/*

# ls -alR /was1 | wc -l
500
# ls -alR /was2 | wc -l
500

# diff --recursive /was1 /was2
ë§ˆì´ê·¸ë ˆì´ì…˜ë“±ì˜ ìŠ¤í† ë¦¬ì§€ ì´ë™, ë°ì´í„° ì´ë™í›„ì—ëŠ” diff ëª…ë ¹ì–´ì™€ ë””ë ‰í† ë¦¬ ì „ì²´ ë¹„êµ ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ 
ë””ë ‰í† ë¦¬ë‚´ì˜ íŒŒì¼ë“¤ì˜ ìë£Œ ë¬´ê²°ì„±ì„ ê²€ì‚¬í•œë‹¤.

[ì¶”ê°€ ì‘ì—…ì„ í• ì‹œ]
# du -sk /was1
# du -sk /was2
```

íŒŒì¼ ë³µì‚¬, ì¼ë°˜ ë³µì‚¬ëŠ” ìƒê´€ì—†ë‹¤.

í•˜ì§€ë§Œ ë””ë ‰í† ë¦¬ë¥¼ í†µì§¸ë¡œ ë³µì‚¬í•˜ê±°ë‚˜ ë§ˆì´ê·¸ë ˆì´ì…˜ ì´ì „ ì‘ì—…ì€ ìƒê´€ ì—†ë‹¤.

## sort ëª…ë ¹ì–´

---

íŒŒì¼ì˜ ì •ë ¬. í•˜ë‚˜ ë˜ëŠ” ê·¸ ì´ìƒì˜ íŒŒì¼ì˜ í…ìŠ¤íŠ¸ ì¤„ì„ ìŠ¤í¬ë¦° ìƒì—ì„œ ì •ë ¬ í•˜ê³ ì í•  ë•Œ ì‚¬ìš©í•œë‹¤. ì¦‰ ì¶œë ¥ ë‚´ìš©ì„ ì •ë ¬í•˜ì—¬ í‘œí˜„í•˜ê³ ì í•  ë•Œ ì‚¬ìš©í•œë‹¤. sort ëª…ë ¹ì–´ëŠ” ì•„ë¬´ëŸ° ì˜µì…˜ ì—†ì´ ì‚¬ìš©ë˜ë©´ ìˆ«ìë‚˜ ì•ŒíŒŒë²³ ìˆœìœ¼ë¡œ ì •ë ¬í•˜ì—¬ ì¤€ë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ sort ëª…ë ¹ì–´ëŠ” ê³µë°± ë¬¸ì(white space: space, Tab)ë¥¼ í•„ë“œ êµ¬ë¶„ìë¡œ ì¸ì‹í•œë‹¤.

[ëª…ë ¹ì–´ í˜•ì‹]

```bash
# sort /etc/passwd 
# sort â€“r /etc/passwd              /* -r : reverse */
# sort -k 3 filename               /* -k : key */
# sort -t : -k 3 â€“n /etc/passwd    /* -t : seperate, -n : numeric */
```

[ëª…ë ¹ì–´ ì˜µì…˜]

**ì˜µì…˜ : ì„¤ëª…**

-n : ìˆ«ìë¡œ ì •ë ¬í•œë‹¤. -r : ë‚´ë¦¼ì°¨ìˆœìœ¼ë¡œ ì •ë ¬í•œë‹¤. ê¸°ë³¸ì€ ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì •ë ¬í•˜ëŠ” ê²ƒì´ë‹¤. -o : ì¶œë ¥ ê²°ê³¼ë¥¼ íŒŒì¼ì— ì €ì¥í•œë‹¤. **-t : í•„ë“œ êµ¬ë¶„ìë¥¼ ì§€ì •í•œë‹¤. (ê¸°ë³¸ê°’ì€ ê³µë°±ì´ ê¸°ì¤€ì´ ëœë‹¤) -k : ì •ë ¬í•  í•„ë“œë¥¼ ì§€ì •í•œë‹¤.**

### [EX1] sort ì •ë ¬ ì‹¤ìŠµ

```bash
# vi sortfile1
linux100 10 20 31 50
linux200 20 25 31 20
linux300 30 20 30 40
linux400 50 20 30 80

â–ª ì˜¤ë¦„ì°¨ìˆœ ì •ì—´                 **<---> (-r)** ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
â–ª 1í•„ë“œ->2í•„ë“œ->3í•„ë“œ-> ... ì •ì—´ **<---> (-k)** í•„ë“œ ì§€ì • ì •ì—´
â–ª ë¬¸ìì—´ ì •ì—´                  **<---> (-n)** ìˆ«ìì—´ ì •ì—´

# sort sortfile1 /* ì²« ë²ˆì§¸ í•„ë“œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬ */
linux100 10 20 31 50
linux200 20 25 31 20
linux300 30 20 30 40
linux400 50 20 30 80
# sort -r sortfile1 /* ë‚´ë¦¼ì°¨ìˆœìœ¼ë¡œ ì •ë ¬ */
linux400 50 20 30 80
linux300 30 20 30 40
linux200 20 25 31 20
linux100 10 20 31 50
# sort -k 3 -n sortfile1 /* ì„¸ ë²ˆì§¸ í•„ë“œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ìˆ«ìë¡œ ì •ë ¬ */
linux100 10 20 31 50
linux300 30 20 30 40
linux400 50 20 30 80
linux200 20 25 31 20
# sort -t : -k 1 /etc/passwd /* -t (seperate) êµ¬ë¶„ìë¡œ :ì‚¬ìš©, ê¸°ì¤€ìœ¼ë¡œ ì²«ë²ˆì§¸ í–‰ ì •ë ¬ */
adm:x:3:4:adm:/var/adm:/sbin/nologin
amanda:x:33:6:Amanda user:/var/lib/amanda:/bin/bash
apache:x:48:48:Apache:/var/www:/sbin/nologin
avahi-autoipd:x:101:107:avahi-autoipd:/var/lib/avahi-autoipd:/sbin/nologin
avahi:x:70:70:Avahi daemon:/:/sbin/nologin
bin:x:1:1:bin:/bin:/sbin/nologin
cyrus:x:76:12:Cyrus IMAP Server:/var/lib/imap:/bin/bash
..... (ì¤‘ëµ) .....
# sort -t : -k 3 -n /etc/passwd
root:x:0:0:root:/root:/bin/bash
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
sync:x:5:0:sync:/sbin:/bin/sync
..... (ì¤‘ëµ) .....

# sort -n -t : -k 3 /etc/passwd | more
ë§ì´ ì‚¬ìš©í•˜ëŠ” í˜•íƒœ
```

### [EX2] sort ëª…ë ¹ì–´ í™œìš©

```bash
# CMD | sort 
# CMD | sort â€“r 
# CMD | sort â€“nr 

# ps -ef | head | sort 
# ps -ef | head | sort â€“r 
# ps -ef | head | sort -k 3 
# ps -ef | head | sort -k 3 â€“r 

# df â€“h | sort -k 4 
# df -h | sort -k 4 -r (df ëª…ë ¹ì–´ì—ì„œ sort ì‹œì—ëŠ” -h ì˜µì…˜ì„ ì‚¬ìš©í•˜ì§€ ë§ì)
# df -h
Filesystem            Size  Used Avail Use% Mounted on
/dev/sda1              18G  5.5G   12G  33% /
tmpfs                 252M     0  252M   0% /dev/shm
# du -sk /var      /* -s : sum, -k : Kbytes */
191416  /var
# cd /var 
# du -sk * | sort
12      account
146552  lib
16      empty
16      ftp
20      gdm
248     named
28      db
30948   cache
3164    log
32      kerberos
356     arpwatch
4       mail
40      yp
# du -sk * | sort -n /* ì²«ë²ˆì§¸ ì—´ì„ ìˆ«ìë¡œ ì •ë ¬ */
4       mail
8       crash
8       cvs
8       games
8       local
8       nis
8       opt
8       preserve
8       racoon
8       tmp
8       tux
12      account
16      empty
16      ftp
20      gdm
# du -sk * | sort -nr | more /* ì²«ë²ˆì§¸ í•„ë“œì—´ ì—­ìˆœìœ¼ë¡œ ì •ë ¬ */
146552  lib
30948   cache
8920    www
3168    log
464     run
436     spool
356     arpwatch
248     named
# du /etc/*  | sort -n -k 1 -r | more
du : í˜„ì¬ ë””ë ‰í† ë¦¬ì—ì„œ ì–¼ë§ˆë¥¼ ì¼ëƒ
# df | sort -n -k 3 -r | head -1

ì €ì¥ë˜ì–´ ìˆëŠ” íŒŒì¼ì„ ì •ë ¬í•˜ëŠ” ê²½ìš°ì—ëŠ” sort ë‹¨ë…ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ê²½ìš°ë„ ìˆì§€ë§Œ
ì‹¤ì‹œê°„ ì •ë³´ë“¤ì˜ ê²½ìš°ì—ëŠ” 
	CMD | sort |
```

## file ëª…ë ¹ì–´

---

file ëª…ë ¹ì–´ëŠ” íŒŒì¼ì˜ ì¢…ë¥˜(File Type)ì„ ì•Œ ìˆ˜ ìˆëŠ” ëª…ë ¹ì–´ì´ë‹¤. ë§ì´ ì‚¬ìš©ë˜ëŠ” ëª…ë ¹ì–´ëŠ” ì•„ë‹ˆì§€ë§Œ íŠ¹ë³„í•œ ê²½ìš°ì— ì‚¬ìš© ë  ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ì¸í„°ë„· ìƒì—ì„œ ë‹¤ìš´ë¡œë“œ ë°›ì€ íŒŒì¼ì´ ì •í™•íˆ ì–´ë–¤ ì¢…ë¥˜ì¸ì§€ë¥¼ í™•ì¸í•  ë•Œ ì‚¬ìš©í•œë‹¤.

Unixì™€ ë¦¬ëˆ…ìŠ¤ì—ì„œëŠ” í™•ì¥ì(Extention)ëŠ” íŠ¹ë³„í•œ ì˜ë¯¸ë¥¼ ê°€ì§€ê³  ìˆì§€ ì•Šì€ ê²½ìš°ê°€ ëŒ€ë¶€ë¶„ì´ê¸° ë•Œë¬¸ì´ë‹¤. ì¸í„°ë„·ìƒì—ì„œ ë‹¤ìš´ë¡œë“œ ë°›ëŠ” ëŒ€ë¶€ë¶„ì˜ í”„ë¡œê·¸ë¨ íŒŒì¼ë“¤ì€ filename.tar.gz í˜•íƒœë¡œ ë˜ì–´ì ¸ ìˆëŠ” ê²½ìš°ê°€ ë§ë‹¤. filename.tar.gz ë¼ëŠ” ì´ë¦„ì€ ë§Œë“  ì‚¬ëŒì´ ì˜ëª» ë°°í¬í•˜ëŠ” ê²½ìš° filename.tarë¡œ ë°°í¬ ë˜ëŠ” ê²½ìš°ê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤. ì´ëŸ° ê²½ìš° ë‹¤ìš´ë¡œë“œ ë°›ì€ íŒŒì¼ì˜ í˜•íƒœë¥¼ ì •í™•íˆ ì•Œì§€ ëª»í•˜ëŠ” ê²½ìš° í”„ë¡œê·¸ë¨ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ê²Œ ëœë‹¤. fileëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ íŒŒì¼ì˜ í˜•ì‹(File Type)ì„ ì •í™•íˆ ì•Œì•„ì„œ ì›ë³¸ í™•ì¸ì˜ í™•ì¥ì(Extention)ë¡œ ë³µêµ¬í•œ í›„ ì••ì¶•ì„ í’€ê³  ì•„ì¹´ì´ë¸Œ(Archive)ì„ í’€ì–´ ì‚¬ìš©í•˜ê²Œ ë˜ë©´ í•´ê²°ëœë‹¤.

[ì°¸ê³ ] Windos / Unix ê³„ì—´ì˜ íŒŒì¼ í™•ì¥ìì— ëŒ€í•´ì„œ

Windows -> íŒŒì¼ì— í™•ì¥ì(ì˜ˆ: file.txt, hwp.exe, ....) Unix,Linux -> íŒŒì¼ì˜ í™•ì¥ìê°€ ê±°ì˜ ì˜ë¯¸ê°€ ì—†ë‹¤.

[ëª…ë ¹ì–´ í˜•ì‹]

```bash
# file /etc/passwd
```

### [EX1] íŒŒì¼ì˜ ì¢…ë¥˜ í™•ì¸

```bash
# file /etc/passwd /* ASCIIíŒŒì¼ (# cat /etc/passwd) */
/etc/passwd: ASCII text
# file /bin/ls /* Binary íŒŒì¼ (# strings /bin/ls) */
/bin/ls: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), for GNU/Linux 2.6.9, dynamically 
linked (uses shared libs), for GNU/Linux 2.6.9, stripped
# file /var/run/utmp /* Date íŒŒì¼ */
/var/run/utmp:data
# file /etc/rc.d/init.d/sendmail /* Script íŒŒì¼ */
/etc/rc.d/init.d/sendmail: Bourne-Again shell script text executable
# file /etc/hosts /etc /* ì—¬ëŸ¬ê°œì˜ íŒŒì¼ ì§€ì • */
/etc/hosts: ascii text
/etc: directory                   /* Directory íŒŒì¼ */
# cd /etc 
# file *
DIR_COLORS:                    ASCII English text
DIR_COLORS.xterm:              ASCII English text
Muttrc:                        ASCII English text
Muttrc.local:                  empty
NetworkManager:                directory
Pegasus:                       directory
X11:                           directory
a2ps-site.cfg:                 ASCII English text
a2ps.cfg:                      ASCII English text
acpi:                          directory
adjtime:                       ASCII text
aide.conf:                     ASCII English text
..... (ì¤‘ëµ) .....
wget <http://mirror.centos.org/centos/8/BaseOS/x86_64/os/Packages/kernel-4.18.0-193.el8.x86_64.rpm>
ls
mv kernel-4.18.0-193.el8.x86_64.rpm install.rpm
file *
uname -a
```
