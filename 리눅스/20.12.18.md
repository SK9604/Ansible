## ğŸ™‹ğŸ»â€â™€ï¸ ì—´ì•„í™‰ë²ˆì§¸ ë¹„ëŒ€ë©´ ìˆ˜ì—…

---

# ë‚´ìš© ì •ë¦¬

---

# íŒŒì¼ì‹œìŠ¤í…œ ì ê²€ ë° ì‚¬ìš©ëŸ‰ ì ê²€

---

DISK - ìŠ¤í† ë¦¬ì§€ ê´€ë ¨   -   íŒŒí‹°ì…˜

ë¬¼ë¦¬ì ì¸ ë‹¨ê³„            â†’   ë…¼ë¦¬ì  ë‹¨ê³„

ì„œë²„ë””ìŠ¤í¬ì˜ ê²½ìš° ìˆ˜ëª… 2ë…„

- **fsck CMD** í†µí•´ì„œ íŒŒì¼ì‹œìŠ¤í…œì„ ì ê²€í•œë‹¤.

    **(umount + fsck) or (single user mode + fsck)**

    ```bash
    # fsck /dev/sdb1
    # fsck.ext4 /dev/sdb1
    # e2fsck /dev/sdb1
    # fsck â€“y /dev/sdb1
    ```

- **df/du ëª…ë ¹ì–´ ì‚¬ìš©ë²•**

    ```bash
    # df â€“k
    # du â€“sk /var
    # cd /var ; du â€“sk * | sort â€“nr | more
    ```

---

## íŒŒì¼ ì‹œìŠ¤í…œ ì ê²€ fsck (File system check)

íŒŒì¼ì‹œìŠ¤í…œì´ ì „ì›ì´ìƒì´ë‚˜ ì»¤ë„ì—ì„œ ë™ì‘í•˜ëŠ” í”„ë¡œê·¸ë¨ì˜ ì´ìƒ, í•˜ë“œì›¨ì–´ì ì¸ ì´ìƒ, ë¹„ì •ìƒì ì¸ ì‹œìŠ¤í…œ shutdownì´ ë°œìƒí•˜ì—¬ ë°ë¯¸ì§€(Damaged)ë¥¼ ì…ê²Œ ë˜ë©´, íŒŒì¼ì‹œìŠ¤í…œì„ fsck ëª…ë ¹ì–´ë¥¼ í†µí•´ íŒŒì¼ì‹œìŠ¤í…œì˜ ë¬´ê²°ì„±ì„ ì ê²€í•˜ê²Œ ëœë‹¤. fsck ëª…ë ¹ì–´ì™€ ë¹„ìŠ·í•œ ëª…ë ¹ì–´ë¡œëŠ” fsck.ext3, e2fsckê°€ ìˆë‹¤. ì´ë“¤ ëª¨ë‘ëŠ” íŒŒì¼ì‹œìŠ¤í…œì„ ì ê²€í•˜ê³ , ì†ìƒëœ íŒŒì¼ì‹œìŠ¤í…œì„ ë³µêµ¬í•˜ëŠ” ëª…ë ¹ì–´ì´ë‹¤.

[ëª…ë ¹ì–´ í˜•ì‹]

```bash
# fsck /dev/sda1 
# fsck -y /dev/sd1 

# fsck /dev/sda1 
# fsck.ext4 /dev/sda1 
# e2fsck /dev/sda1
```

(fsck, fsck.ext3 ëª…ë ¹ì–´ ì˜µì…˜)

```bash
ì˜µì…˜ ì„¤ëª…
-A /etc/fstab íŒŒì¼ì— ìˆëŠ” ëª¨ë“  íŒŒì¼ì‹œìŠ¤í…œì„ í•œë²ˆì”© ì ê²€
-R -Aì™€ í•¨ê»˜ ì‚¬ìš©ì‹œ /(root) íŒŒì¼ì‹œìŠ¤í…œì€ ì œì™¸
-T ì‹œì‘ì‹œ ì œëª©ì€ ìƒëµ
-N ì‹¤í–‰ì€ í•˜ì§€ ì•Šê³  ì–´ë–¤ ì‘ì—…ì„ í•  ê²ƒì¸ì§€ë§Œ ì¶œë ¥
-P -Aì™€ í•¨ê»˜ ì‚¬ìš©ì‹œ /íŒŒì¼ì‹œìŠ¤í…œê³¼ ë‹¤ìŒ íŒŒì¼ì‹œìŠ¤í…œì„ ë³‘ë ¬ì²˜ë¦¬í•˜ì—¬ ì ê²€í•¨
-V ìì„¸í•œ ì •ë³´ê°€ ì¶œë ¥
-a ì—ëŸ¬ ë°œìƒì‹œ ìë™ìœ¼ë¡œ ë³µêµ¬í•¨
-t íŠ¹ì • ì¢…ë¥˜ì˜ íŒŒì¼ì‹œìŠ¤í…œë§Œ ì ê²€í•¨.
```

(e2fsck ì˜µì…˜)

```bash
ì˜µì…˜ ì„¤ëª…
-f íŒŒì¼ì‹œìŠ¤í…œì— ì˜¤ë¥˜ê°€ ì—†ë”ë¼ë„ ê°•ì œë¡œ ì ê²€í•˜ë„ë¡ í•¨
-p ì—ëŸ¬ ë°œìƒì‹œ ìë™ìœ¼ë¡œ ë³µêµ¬í•˜ë„ë¡ í•¨
-y ëª¨ë“  ì§ˆë¬¸ì— yesë¼ê³  ë‹µí•˜ë„ë¡ ì„¤ì •í•¨
-b ìˆ˜í¼ ë¸”ëŸ­ì„ ì´ìš©í•œ ë³µêµ¬
```

```bash
(ì£¼ì˜) fsck ëª…ë ¹ì–´ ì‚¬ìš©ì‹œ ì£¼ì˜ì 
ë§ˆìš´íŠ¸ëœ íŒŒì¼ì‹œìŠ¤í…œì— ëŒ€í•´ì„œ fsck ëª…ë ¹ì–´ë¥¼ ìˆ˜í–‰í•˜ì§€ ë§ì•„ì•¼ í•œë‹¤. 

/home, /data1, /data2, .... -> umount CMD + fsck CMD 
/, /usr, /var, /tmp         -> single user mode + fsck CMD

-------+---------------+-------     ----   # fsck /dev/sda1
       |      f=2      |             |
       +---------------+             | 
       |     file1     |             V
       |               |            ----
       |     file2     |
       |               |
       |               |
       |  file3(ìƒì„±)   |
       |               |
-------+---------------+-------
```

### [EX1] fsck ì‹¤ìŠµ

```bash
# e2[TAB][TAB]
e2fsck   e2image  e2label
# fsck.[TAB][TAB]
fsck.cramfs   fsck.ext2     fsck.ext3     fsck.ext4     fsck.ext4dev  fsck.msdos    fsck.vfat
# df -h
Filesystem            Size  Used Avail Use% Mounted on
/dev/sda1              17G  3.4G   12G  22% /
/dev/sda8             487M   11M  451M   3% /data1
/dev/sda7             487M   11M  451M   3% /data2
/dev/sda6             487M   11M  451M   3% /data3
/dev/sda5             487M   11M  451M   3% /data4
/dev/sda3             487M   11M  451M   3% /home
tmpfs                 506M     0  506M   0% /dev/shm
# fsck /dev/sda3       (# fsck /home)
fsck 1.39 (29-May-2006)
e2fsck 1.39 (29-May-2006)
/dev/sda3 is mounted.  

WARNING!!!  Running e2fsck on a mounted filesystem may cause
SEVERE filesystem damage.

Do you really want to continue (y/n)? yes       <----- 'yes' ì…ë ¥

/home: recovering journal
/home: clean, 59/128520 files, 26852/514080 blocks
# umount /home 
# fsck /dev/sda3     (# fsck /home)
fsck 1.39 (29-May-2006)
e2fsck 1.39 (29-May-2006)
/home: clean, 59/128520 files, 26852/514080 blocks
# fsck â€“y /dev/sda3
fsck 1.39 (29-May-2006)
e2fsck 1.39 (29-May-2006)
/home: clean, 59/128520 files, 26852/514080 blocks
# e2fsck /dev/sda3
e2fsck 1.39 (29-May-2006)
/home: clean, 59/128520 files, 26852/514080 blocks
# mount /home 
# df -h 
-> /home ë³´ì—¬ì•¼ í•œë‹¤.
```

(ì‹¤ë¬´ ì˜ˆ) "# fsck -y /dev/sda1" ì‚¬ìš©ì‹œ

```bash
# script -a fsck.log 
# fsck â€“y /dev/sda3 
# exit 
# cat fsck.log
```

## íŒŒì¼ ì‹œìŠ¤í…œ ì‚¬ìš©ëŸ‰ ì¸¡ì • (df, du)

[1] df (disk free space) - íŒŒí‹°ì…˜ ë‹¨ìœ„ì˜ ì‚¬ìš©ëŸ‰ ì ê²€

df ëª…ë ¹ì–´ëŠ” ë‚¨ì€ ë””ìŠ¤í¬ ë¸”ëŸ­ê³¼ ë‚¨ì€ íŒŒì¼ì˜ ìˆ˜ë¥¼ ì¶œë ¥í•˜ëŠ” ëª…ë ¹ì–´ì´ë‹¤. df ëª…ë ¹ì–´ì— -k, -h ì˜µì…˜ ë“±ì„ ì‚¬ìš©í•˜ë©´ ì¶œë ¥ ê²°ê³¼ëŠ” íŒŒì¼ì‹œìŠ¤í…œ í¬ê¸°, ì‚¬ìš©ëœ ê³µê°„, ë‚¨ì€ ê³µê°„, ì „ì²´ì—ì„œ ì‚¬ìš©ì¤‘ì¸ %ì‚¬ìš©ëŸ‰, ë§ˆìš´íŠ¸ í¬ì¸íŠ¸ë“±ì„ ì¶œë ¥í•œë‹¤.

[ëª…ë ¹ì–´ í˜•ì‹]

```bash
# df 
# df â€“k      (-k : KB)
# df â€“m      (-m : MB)
# df â€“h      (-h : human)

# df â€“k /data1 
# df -k /data1 /home 

# df -T       (# alias df='df -T -h')
```

[ëª…ë ¹ì–´ ì˜µì…˜]

```bash
ì˜µì…˜ ì„¤ëª…
-k ì—¬ìœ  ìš©ëŸ‰ì„ í‚¬ë¡œë°”ì´íŠ¸(kilobyte) ë‹¨ìœ„ë¡œ ì¶œë ¥
-h ì—¬ìœ  ìš©ëŸ‰ì„ ì‚¬ìš©ìê°€ ë³´ê¸° ì‰½ê²Œ í‚¬ë¡œë°”ì´íŠ¸(kilobyte)ì™€ ë©”ê°€ë°”ì´íŠ¸(megabyte) ë‹¨ìœ„ë“±ìœ¼ë¡œ ì¶œë ¥
-F íŒŒì¼ ì‹œìŠ¤í…œì˜ íƒ€ì…ì„ ì§€ì •í•˜ì—¬ ì§€ì •í•œ íŒŒì¼ì‹œìŠ¤í…œ ì˜ì—­ë§Œì„ ì¶œë ¥
-i ë¸”ë¡ ì—¬ìœ  ìš©ëŸ‰ ëŒ€ì‹  inode ì‚¬ìš© ì •ë³´ë¡œ ì¶œë ¥
-a ë””í”Œë¡œì´ë¡œ ìƒëµëœ 0 ë¸”ë¡ í¬ê¸°ì˜ íŒŒì¼ ì‹œìŠ¤í…œë„ ë³´ì—¬ì¤Œ
-t fstype ê°’ì„ ê°€ì§„ íŒŒì¼ ì‹œìŠ¤í…œì— ëŒ€í•œ ë””ìŠ¤í¬ ì •ë³´
-T íŒŒì¼ ì‹œìŠ¤í…œì˜ ì¢…ë¥˜ì™€ í•¨ê»˜ ë””ìŠ¤í¬ì˜ ì •ë³´ë¥¼ ë³´ì—¬ì¤Œ
```

### [EX1] df ëª…ë ¹ì–´ ì‹¤ìŠµ

```bash
# df
Filesystem           1K-blocks      Used Available Use% Mounted on
/dev/sda1             16798832   3477340  12454388  22% /
/dev/sda8               497829     10544    461583   3% /data1
/dev/sda7               497829     10544    461583   3% /data2
/dev/sda6               497829     10544    461583   3% /data3
/dev/sda5               497829     10544    461583   3% /data4
tmpfs                   517520         0    517520   0% /dev/shm
# df -k
Filesystem           1K-blocks      Used Available Use% Mounted on
/dev/sda1             16798832   3477340  12454388  22% /
/dev/sda8               497829     10544    461583   3% /data1
/dev/sda7               497829     10544    461583   3% /data2
/dev/sda6               497829     10544    461583   3% /data3
/dev/sda5               497829     10544    461583   3% /data4
tmpfs                   517520         0    517520   0% /dev/shm
# df -k /
Filesystem           1K-blocks      Used Available Use% Mounted on
/dev/sda1             16798832   3477340  12454388  22% /
# df -h
Filesystem            Size  Used Avail Use% Mounted on
/dev/sda1              17G  3.4G   12G  22% /
/dev/sda8             487M   11M  451M   3% /data1
/dev/sda7             487M   11M  451M   3% /data2
/dev/sda6             487M   11M  451M   3% /data3
/dev/sda5             487M   11M  451M   3% /data4
tmpfs                 506M     0  506M   0% /dev/shm
# df -h -F ext2
Filesystem            Size  Used Avail Use% Mounted on
# df -h -F ext3
Filesystem            Size  Used Avail Use% Mounted on
/dev/sda1              17G  3.4G   12G  22% /
/dev/sda8             487M   11M  451M   3% /data1
/dev/sda7             487M   11M  451M   3% /data2
/dev/sda6             487M   11M  451M   3% /data3
/dev/sda5             487M   11M  451M   3% /data4
# df -T
Filesystem    Type   1K-blocks      Used Available Use% Mounted on
/dev/sda1     ext3    16798832   3477340  12454388  22% /
/dev/sda8     ext3      497829     10544    461583   3% /data1
/dev/sda7     ext3      497829     10544    461583   3% /data2
/dev/sda6     ext3      497829     10544    461583   3% /data3
/dev/sda5     ext3      497829     10544    461583   3% /data4
tmpfs        tmpfs      517520         0    517520   0% /dev/shm
```

```bash
# alias df='df -h -T' 
# df 
-> ì¶œë ¥ ë‚´ìš© ìƒëµ($HOME/.bashrc)
-> # vi ~/.bashrc
   alias df='df â€“h -T'
   # . ~/.bashrc
   # alias df
```

[ì‹¤ë¬´ ì˜ˆ] ì—ëŸ¬ë©”ì„¸ì§€ : .... out of inodes ....

```bash
(ì¦ìƒ) : df -h(-k) ì˜µì…˜ìœ¼ë¡œ ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰ì„ ë³´ë©´ ë‚¨ì€ê³µê°„ì€ ìˆì§€ë§Œ, ë”ì´ìƒ íŒŒì¼ì´ ë§Œë“¤ì–´ ì§€ì§€ ì•ŠëŠ” ìƒíƒœì¸ ê²½ìš°, ê·¸ë¦¬ê³  /var/log/messages íŒŒì¼ì•ˆì— ì—ëŸ¬ë©”ì„¸ì§€(...out of inodes....)ê°€ ë°œìƒí•˜ëŠ” ê²½ìš°ì´ë‹¤.
# df -h -F ext3
Filesystem            Size  Used Avail Use% Mounted on
/dev/sda1              17G  3.4G   12G  22% /
/dev/sda8             487M   11M  451M   3% /data1
/dev/sda7             487M   11M  451M   3% /data2
/dev/sda6             487M   11M  451M   3% /data3
/dev/sda5             487M   11M  451M   3% /data4
/dev/sda3             487M   11M  451M   3% /home
# df -i
Filesystem            Inodes   IUsed   IFree IUse% Mounted on
/dev/sda1            4336864  129090 4207774    3% /
/dev/sda8             128520      11  128509    1% /data1
/dev/sda7             128520      11  128509    1% /data2
/dev/sda6             128520      11  128509    1% /data3
/dev/sda5             128520      11  128509    1% /data4
tmpfs                 129380       1  129379    1% /dev/shm
/dev/sda3             128520      59  128461    1% /home
# vi ~/.bashrc
------------------------------------------
# .bashrc

# User specific aliases and functions

alias rm='rm -i'
alias cp='cp -i'
alias mv='mv -i'

# Source global definitions
if [ -f /etc/bashrc ]; then
        . /etc/bashrc
fi

#
# (1) Sfecific Configuration(EX: Alias)
#
alias ddf='/bin/df -h -F ext3 ; echo ; /bin/df -i'
------------------------------------------
# .  ~/.bashrc 
# ddf
Filesystem            Size  Used Avail Use% Mounted on
/dev/sda1              17G  3.4G   12G  22% /
/dev/sda8             487M   11M  451M   3% /data1
/dev/sda7             487M   11M  451M   3% /data2
/dev/sda6             487M   11M  451M   3% /data3
/dev/sda5             487M   11M  451M   3% /data4
/dev/sda3             487M   11M  451M   3% /home

Filesystem            Inodes   IUsed   IFree IUse% Mounted on
/dev/sda1            4336864  129090 4207774    3% /
/dev/sda8             128520      11  128509    1% /data1
/dev/sda7             128520      11  128509    1% /data2
/dev/sda6             128520      11  128509    1% /data3
/dev/sda5             128520      11  128509    1% /data4
tmpfs                 129380       1  129379    1% /dev/shm
/dev/sda3             128520      59  128461    1% /home
```

[2] du (disk usage) - ë””ë ‰í† ë¦¬ ë‹¨ìœ„ì˜ ì‚¬ìš©ëŸ‰ ì ê²€

du ëª…ë ¹ì–´ëŠ” ë””ìŠ¤í¬ì™€ íŒŒì¼ì˜ ì‚¬ìš©ëŸ‰ì„ ë³´ì—¬ì¤€ë‹¤. du ëª…ë ¹ì–´ì— -s, -a, -k, -h ì˜µì…˜ ë“±ì„ ì‚¬ìš©í•˜ë©´ ì¶œë ¥ ê²°ê³¼ëŠ” ë””ë ‰í† ë¦¬ì™€ íŒŒì¼ì˜ í¬ê¸°, ì‚¬ìš©ëœ ê³µê°„, ë‚¨ì€ ê³µê°„, ì „ì²´ì—ì„œ ì‚¬ìš©ì¤‘ì¸ ì‚¬ìš©ëŸ‰ì„ ì¶œë ¥í•œë‹¤.

ë””ìŠ¤í¬ì˜ ê° íŒŒì¼ë“¤ì˜ ì‚¬ìš©ëŸ‰. í•©ì‚°ì„ í•˜ê±°ë‚˜ ë˜ëŠ” ê°ê°ì˜ íŒŒì¼ì— ëŒ€í•˜ì—¬ ë”°ë¡œ í™•ì¸ì„ í•˜ëŠ” ê²½ìš°

SERVER1ì—ì„œ ê°€ì¥ í° íŒŒì¼ ì°¾ê¸°

```bash

```

SERVER1ì—ì„œ ê°€ì¥ í° ë””ë ‰í† ë¦¬ ì°¾ê¸°

```bash
# du -s /* | sort -n -r
```

[ëª…ë ¹ì–´ í˜•ì‹]

```bash
# du /etc 
# du â€“k /etc    /* -k : KBytes */
# du â€“m /etc    /* -m : MBytes */
# du â€“h /etc    /* -h : human */

# du â€“ak /etc 
# du â€“am /etc 
# du -ah /etc 

# du â€“sk /etc   /* -s : sum */
# du â€“sm /etc 
# du -sh /etc
```

[ëª…ë ¹ì–´ ì˜µì…˜]

```bash
ì˜µì…˜ ì„¤ëª…
-s í•´ë‹¹ ê²½ë¡œì˜ ë””ìŠ¤í¬ ìš©ëŸ‰ ì´ í•©ê³„ë§Œ ì¶œë ¥
-a í•´ë‹¹ ê²½ë¡œì— ëŒ€í•œ ì‚¬ìš©í•œ ë””ìŠ¤í¬ ìš©ëŸ‰ í‘œì‹œ
-k ìš©ëŸ‰ í‘œì‹œë¥¼ í‚¬ë¡œë°”ì´íŠ¸(kilobyte) ë‹¨ìœ„ë¡œ í‘œì‹œ
-m ìš©ëŸ‰ í‘œì‹œë¥¼ ë©”ê°€ë°”ì´íŠ¸(megabyte) ë‹¨ìœ„ë¡œ í‘œì‹œ
-h ì—¬ìœ  ìš©ëŸ‰ì„ ì‚¬ìš©ìê°€ ë³´ê¸° ì‰½ê²Œ í‚¬ë¡œë°”ì´íŠ¸(kilobyte)ì™€ ë©”ê°€ë°”ì´íŠ¸(megabyte) ë‹¨ìœ„ë“±ìœ¼ë¡œ ì¶œë ¥
```

### [EX1] du ëª…ë ¹ì–´ ì‹¤ìŠµ

```bash
# du /etc/sysconfig
24      /etc/sysconfig/cbq
404     /etc/sysconfig/network-scripts
8       /etc/sysconfig/networking/profiles/default
..... (ì¤‘ëµ) .....

(du ì¶œë ¥ê²°ê³¼ í•´ì„)
-----------------------------------------
í•„ë“œ                         ì„¤ ëª…
-----------------------------------------
24                          ì‚¬ìš©ëŸ‰(Kbytes)
/etc/sysconfig/cbq          ë””ë ‰í† ë¦¬ ì´ë¦„
-----------------------------------------

# du -a /etc/sysconfig
8       /etc/sysconfig/kadmin
8       /etc/sysconfig/grub
8       /etc/sysconfig/rawdevices
..... (ì¤‘ëµ) .....
# du -sk /etc/sysconfig
1184    /etc/sysconfig/
# cd /var 
# du -sk * | sort -rn | more
49700   lib
11576   cache
8752    www
4380    log
536     spool
388     run
140     named
32      lock
32      empty
28      db
24      yp
..... (ì¤‘ëµ) .....
```

[ì°¸ê³ ] (ìœˆë„ìš°ì¦ˆ <-----> ë¦¬ëˆ…ìŠ¤) ë¹„êµ

```bash
# df â€“k   (# df â€“h) 

# du -sk /var 

# cd /var 
# du -sk * | sort -nr | more 

**# find /var -size +300M -type f**
```

# ë§ˆìš´íŠ¸ í™•ì¸ ë° ë§ˆìš´íŠ¸ ê´€ë ¨ íŒŒì¼ë“¤

- **ë§ˆìš´íŠ¸í™•ì¸**

    ```bash
    # df-h
    # mount
    # mount | column â€“t
    ```

- **ë§ˆìš´íŠ¸ ê´€ë ¨ íŒŒì¼ë“¤**

    ```bash
    /etc/mntab
    /proc/mounts
    /etc/fstab
    ```

## ë§ˆìš´íŠ¸ í™•ì¸

ì¥ì¹˜(Device)ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ë°˜ë“œì‹œ ë§ˆìš´íŠ¸ ê³¼ì •ì„ ê±°ì³ì•¼ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤. ê·¸ë¦¬ê³  ë‹¤ ì‚¬ìš©í•œ ìì›ì€ ì–¸ë§ˆìš´íŠ¸(Umount)í•˜ë©´ ëœë‹¤. ë§ˆìš´íŠ¸ ë˜ì–´ì§„ ì¥ì¹˜ë¥¼ ëˆ„êµ°ê°€ ì‚¬ìš©í•œë‹¤ë©´ ê¸°ë³¸ì ìœ¼ë¡œ ì–¸ë§ˆìš´íŠ¸ ë˜ì§€ ì•ŠëŠ”ë‹¤. ë¶€íŒ…ì‹œì— ë§ˆìš´íŠ¸ í•´ì•¼ í•˜ëŠ” ìì›(ì˜ˆ: ì¥ì¹˜)ì´ ì¡´ì¬í•œë‹¤ë©´ /etc/fstab íŒŒì¼ì„ ì‚¬ìš©í•˜ë©´ ëœë‹¤.

í˜„ì¬ ìì›(Resource)ë¥¼ ë§ˆìš´íŠ¸ í•˜ê¸° ìœ„í•´ì„œëŠ” mount ëª…ë ¹ì–´ë¥¼ ìˆ˜í–‰í•˜ê³ , ë¶€íŒ…ì‹œì— ë§ˆìš´íŠ¸ í•  ìì›ì´ ìˆë‹¤ë©´ /etc/fstab íŒŒì¼ì— ì •ì˜í•˜ì—¬ ì‚¬ìš©í•˜ë©´ ëœë‹¤. mount ëª…ë ¹ì–´ì— ì˜í•´ì„œ ìˆ˜í–‰ë˜ëŠ” ìì› ë§ˆìš´íŠ¸ëŠ” í˜„ì¬ ì“°ì´ê¸°ëŠ” í•˜ì§€ë§Œ mount ëª…ë ¹ì–´ë¥¼ í†µí•´ì„œë§Œ ë§ˆìš´íŠ¸ê°€ ëœ ê²½ìš°, ë¶€íŒ…ì‹œì—ëŠ” ë§ˆìš´íŠ¸ê°€ ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì— /etc/fstab íŒŒì¼ì—ë„ ë°˜ë“œì‹œ ì •ì˜í•˜ì—¬ì•¼ í•œë‹¤.

â–  í˜„ì¬ ë§ˆìš´íŠ¸ í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ëª…ë ¹ì–´ : **mount CMD**

â–  ë¶€íŒ…ì‹œ ë§ˆìš´íŠ¸ í•  ë•Œ ì‚¬ìš©í•˜ëŠ” íŒŒì¼ : **/etc/fstab**Â  (ë¶€íŒ…ì‹œì— ìë™ ë§ˆìš´íŠ¸)

í˜„ì¬ ë§ˆìš´íŠ¸ ë˜ì–´ì§„ ì •ë³´ë¥¼ í™•ì¸ í•˜ê¸° ìœ„í•´ì„œëŠ” df ëª…ë ¹ì–´ì— -k ì˜µì…˜ì„ ì‚¬ìš©í•˜ê±°ë‚˜, mount ëª…ë ¹ì–´ì— ì•„ë¬´ëŸ° ì˜µì…˜ì—†ì´ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ ë§ì´ ì‚¬ìš©í•œë‹¤. df ëª…ë ¹ì–´ëŠ” ì£¼ë¡œ ë§ˆìš´íŠ¸ ëœ ìƒí™©ì„ ë³´ê¸° ìœ„í•´ì„œë‚˜ íŒŒì¼ì‹œìŠ¤í…œì˜ ì‚¬ìš©ëŸ‰ì„ ì ê²€í•  ë•Œ ì£¼ë¡œ ì‚¬ìš©í•˜ê³ , mount ëª…ë ¹ì–´ì— íŠ¹ë³„í•œ ì˜µì…˜ì´ ì—†ëŠ” ê²½ìš°ì—ëŠ” ì£¼ë¡œ ë§ˆìš´íŠ¸ ì˜µì…˜ ì •ë³´ë¥¼ í™•ì¸ í•˜ê±°ë‚˜, ë§ˆìš´íŠ¸ ëœ ì‹œê°„ì„ í™•ì¸ í•  ë•Œ ì‚¬ìš©í•œë‹¤.

ë§ˆìš´íŠ¸ - ì¥ì¹˜ ë””ë ‰í† ë¦¬ê°„ì˜ ì—°ê²°

ìì›ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ì ˆì°¨.

PnP

[ëª…ë ¹ì–´ í˜•ì‹]

```bash
# df -k        /* ë§ˆìš´íŠ¸ ìƒí™© ì •ë³´, ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰ ì ê²€ í™•ì¸ */
# mount        /* ë§ˆìš´íŠ¸ ì˜µì…˜ ì •ë³´ í™•ì¸, ë§ˆìš´íŠ¸ ì‹œê°„ í™•ì¸ */
```

### [EX1] df ëª…ë ¹ì–´ ì¶œë ¥ ê²°ê³¼ í•´ì„

```bash
# df -k    (# df -h)
Filesystem           1K-blocks      Used Available Use% Mounted on
/dev/sda1             16798832   3477500  12454228  22% /
/dev/sda8               497829     10544    461583   3% /data1
/dev/sda7               497829     10544    461583   3% /data2
/dev/sda6               497829     10544    461583   3% /data3
/dev/sda5               497829     10544    461583   3% /data4
/dev/sda3               497861     10633    461524   3% /home
tmpfs                   517520         0    517520   0% /dev/shm

(df -h ì¶œë ¥ í™”ë©´ í•´ì„)
-------------------------------------------------------------------
/dev/sda1         ì¥ì¹˜ ì´ë¦„(Filesystem)
18G               ì „ì²´ ê³µê°„(Size)
5.3G              ì‚¬ìš©ì¤‘ì¸ ê³µê°„(Used)
12G               ë‚¨ì€ ê³µê°„(Avail)
32%               ì „ì²´ê³µê°„ì—ì„œ ì‚¬ìš©ì¤‘ì¸ ê³µê°„ì˜ ë°±ë¶„ìœ¨(Use%)
/                 ë§ˆìš´íŠ¸ í¬ì¸íŠ¸(Mounted on)
-------------------------------------------------------------------
# mount
/dev/sda1 on / type ext4 (rw)
proc on /proc type proc (rw)
sysfs on /sys type sysfs (rw)
devpts on /dev/pts type devpts (rw,gid=5,mode=620)
/dev/sda8 on /data1 type ext4 (rw)
/dev/sda7 on /data2 type ext4 (rw)
/dev/sda6 on /data3 type ext4 (rw)
/dev/sda5 on /data4 type ext4 (rw)
/dev/sda3 on /home type ext4 (rw)
tmpfs on /dev/shm type tmpfs (rw)
none on /proc/sys/fs/binfmt_misc type binfmt_misc (rw)
none on /proc/fs/vmblock/mountPoint type vmblock (rw)
sunrpc on /var/lib/nfs/rpc_pipefs type rpc_pipefs (rw)

(mount ëª…ë ¹ì–´ ì¶œë ¥ê²°ê³¼ í•´ì„)
----------------------------------------------
/dev/sda1ì¥ì¹˜ ì´ë¦„
/ë§ˆìš´íŠ¸ í¬ì¸í„°
ext4ë§ˆìš´íŠ¸ íŒŒì¼ì‹œìŠ¤í…œ
(rw)ë§ˆìš´íŠ¸ ì˜µì…˜
----------------------------------------------
```

[ì°¸ê³ ] mount ëª…ë ¹ì–´ ì¶œë ¥ í˜•ì‹ ë³´ê¸° ì¢‹ê²Œ ì¶œë ¥í•˜ê¸°

```bash
# mount | column -t   (# CMD | column -t)
```

## ë§ˆìš´íŠ¸ì— ê´€ë ¨í•œ íŒŒì¼ë“¤

ë¦¬ëˆ…ìŠ¤ ì‹œìŠ¤í…œì—ì„œ /etc/mtab íŒŒì¼ì€ í˜„ì¬ ë§ˆìš´íŠ¸ ë˜ì–´ì ¸ ìˆëŠ” ì •ë³´ë¥¼ ë‹´ëŠ”ë‹¤. /etc/mtab íŒŒì¼ì€ ë§ˆìš´íŠ¸ ëœ ìì›ì´ ìˆë‹¤ë©´ mntfsì— ì˜í•´ì„œ ìë™ìœ¼ë¡œ ì •ë³´ê°€ ë“±ë¡ë˜ê³ , ì–¸ë§ˆìš´íŠ¸ê°€ ë˜ë©´ ìë™ìœ¼ë¡œ ì •ë³´ê°€ ì‚­ì œëœë‹¤. ë”°ë¼ì„œ ê´€ë¦¬ìê°€ /etc/mtab íŒŒì¼ì„ ê´€ë¦¬í•  í•„ìš”ëŠ” ì—†ë‹¤. /etc/fstab íŒŒì¼ì€ ë¶€íŒ…ì‹œì— ë§ˆìš´íŠ¸ í•  ë§Œí•œ ìì›(Resource, ì˜ˆ: ì¥ì¹˜)ì— ëŒ€í•œ ì •ë³´ë¥¼ ë‹´ëŠ”ë‹¤. ì´ íŒŒì¼ì€ ê´€ë¦¬ìê°€ ì§ì ‘ í¸ì§‘ì„ í†µí•´ì„œ ê´€ë¦¬í•´ì•¼ í•œë‹¤. ìƒˆë¡œì´ ë§ˆìš´íŠ¸ í•  ìì›ì´ ìˆë‹¤ë©´ /etc/fstab íŒŒì¼ì— ì •ë³´ë¥¼ ë“±ë¡í•˜ë©´ ëœë‹¤.

â–  **/proc/mounts** : proc ê°€ìƒ íŒŒì¼ ì‹œìŠ¤í…œì˜ ì¼ë¶€ (ë¦¬ëˆ…ìŠ¤ ì»¤ë„ì´ ì‹œìŠ¤í…œ ìƒíƒœë¥¼ íŒŒì¼ í˜•ì‹ìœ¼ë¡œ ë³´ì—¬ì£¼ëŠ” ê²ƒ)

â–  **/etc/mtab** : í˜„ì¬ ë§ˆìš´íŠ¸ëœ ì •ë³´ë¥¼ ë‹´ëŠ”ë‹¤.

â–  **/etc/fstab** : ë¶€íŒ…ì‹œì— ë§ˆìš´íŠ¸ í•  ë§Œí•œ ì •ë³´ë¥¼ ë‹´ëŠ”ë‹¤.

[1] /etc/mtab íŒŒì¼

í˜„ì¬ ë§ˆìš´íŠ¸ ìƒíƒœì— ëŒ€í•œ ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆëŠ” íŒŒì¼ì´ë‹¤. mount ëª…ë ¹ì„ ë‚´ë¦´ ë•Œ ì–´ë–¤ ì˜µì…˜ë„ ì£¼ì§€ ì•Šìœ¼ë©´ ì´ ëª©ë¡ì´ í‘œì‹œëœë‹¤. mountì™€ umountëŠ” /etc/mtabì´ë¼ëŠ” íŒŒì¼ì— í˜„ì¬ ë§ˆìš´íŠ¸ ë˜ì–´ ìˆëŠ” íŒŒì¼ ì‹œìŠ¤í…œì˜ ëª©ë¡ì„ ê¸°ë¡í•œë‹¤.

/procë¼ëŠ” ë””ë ‰í† ë¦¬ì— proc íŒŒì¼ ì‹œìŠ¤í…œì´ ë§ˆìš´íŠ¸ ë  ë•Œ, /etc/mtabê³¼ /proc/mountsëŠ” ë¹„ìŠ·í•œ ë‚´ìš©ì„ ê°€ì§€ê²Œ ëœë‹¤. ì „ìëŠ” ë§ˆìš´íŠ¸ ì˜µì…˜ ë“± ë”ìš± ìì„¸í•œ ì •ë³´ë¥¼ ì§€ë‹ˆê³  ìˆì§€ë§Œ í•­ìƒ ìµœì‹  ì •ë³´ë¥¼ ì§€ë‹ˆê³  ìˆëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤.

(/etc/mtab íŒŒì¼ì˜ í•´ì„)

```bash
# cat /etc/mtab | grep /dev/sda1
/dev/sda1 / ext4 rw 0 0

í•„ ë“œ              ì„¤ ëª…
/dev/sda1        [íŒŒì¼ì‹œìŠ¤í…œ ì¥ì¹˜ëª…]
/                [ë§ˆìš´íŠ¸ í¬ì¸íŠ¸]
ext4             [íŒŒì¼ ì‹œìŠ¤í…œ ì¢…ë¥˜]
rw               [ì˜µì…˜]
0                [dump ê´€ë ¨ ì„¤ì •]
0                [íŒŒì¼ ì ê²€ ì˜µì…˜]
```

(mount ëª…ë ¹ì–´ ì¶œë ¥ í™”ë©´ í•´ì„)

```bash
# mount | grep /dev/sda1
/dev/sda1 on / type ext4 (rw)
í•„ ë“œ              ì„¤ ëª…
/dev/sda1        [íŒŒì¼ì‹œìŠ¤í…œ ì¥ì¹˜ëª…]]
on /             [ë§ˆìš´íŠ¸ í¬ì¸íŠ¸]
type ext4        [íŒŒì¼ ì‹œìŠ¤í…œ ì¢…ë¥˜]
(rw)             [ì˜µì…˜]
```

mount ëª…ë ¹ì–´ì— ì•„ë¬´ëŸ° ì˜µì…˜ì´ë‚˜ ì¸ì(Arguments) ì—†ì´ ì‚¬ìš©í•˜ë©´ í˜„ì¬ ë§ˆìš´íŠ¸ ë˜ì–´ì§„ ìì›ë“¤ì— ëŒ€í•œ ì •ë³´ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤. mount ëª…ë ¹ì–´ëŠ” /etc/mtab íŒŒì¼ì„ ì •ë³´ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¼ì •í•œ í˜•ì‹(ì¶œë ¥ í˜•ì‹)ìœ¼ë¡œ ë³´ì—¬ì¤€ë‹¤. /etc/mtab íŒŒì¼ì€ í˜„ì¬ ë§ˆìš´íŠ¸ëœ ì •ë³´ë¥¼ ë‹´ê³  ìˆê³  mntfs ê°€ìƒ íŒŒì¼ì‹œìŠ¤í…œìœ¼ë¡œ ë¦¬ëˆ…ìŠ¤ì— ì˜í•´ ê´€ë¦¬ëœë‹¤. ê´€ë¦¬ìê°€ ê´€ë¦¬í•  í•„ìš”ê°€ ì—†ëŠ” íŒŒì¼ì´ë‹¤.

### [EX1] /etc/mtab íŒŒì¼ ì‹¤ìŠµ

```bash
# cat /etc/mtab | grep /dev/sdb1 
#

# mkdir -p /testmount 
# mount /dev/sdb1 /testmount 
# cat /etc/mtab | grep /dev/sdb1
/dev/sdb1 /testmount ext4 rw 0 0
# umount /testmount 
# cat /etc/mtab | grep /dev/sdb1 
#
```

[2] /etc/fstab íŒŒì¼

/etc/fstab íŒŒì¼ì€ ë¶€íŒ…ì‹œì— ë§ˆìš´íŠ¸ í•  ë§Œí•œ ì •ë³´ë¥¼ ë‹´ê³  ìˆë‹¤. ë¶€íŒ…ì‹œ ì»¤ë„ì€ /etc/fstab íŒŒì¼ì„ ì½ì–´ì„œ ë§ˆìš´íŠ¸ í•  ë””ë°”ì´ìŠ¤ë¥¼ ì°¾ê³  ì´ ë””ë°”ì´ìŠ¤ë“¤ì„ /etc/fstabíŒŒì¼ì— ëª…ì‹œëœ ë””ë ‰í† ë¦¬ì— ë§ˆìš´íŠ¸ ì‹œí‚¨ë‹¤.

```bash
# cat /etc/fstab
# This file is edited by fstab-sync - see 'man fstab-sync' for details
[íŒŒì¼ ì‹œìŠ¤í…œ ì¥ì¹˜ëª…]  [ë§ˆìš´íŠ¸ í¬ì¸íŠ¸]  [íŒŒì¼ì‹œìŠ¤í…œ ì¢…ë¥˜] [ì˜µì…˜]            [dumpê´€ë ¨ì„¤ì •]  [íŒŒì¼ì ê²€ì˜µì…˜]
LABEL=/              /            ext4        defaults         1            1
LABEL=/data1         /data1       ext4        defaults         1            2
LABEL=/data2         /data2       ext4        defaults         1            2
LABEL=/data3         /data3       ext4        defaults         1            2
LABEL=/data4         /data4       ext4        defaults         1            2
LABEL=/home          /home        ext4        defaults         1            2
tmpfs                /dev/shm     tmpfs       defaults         0            0
devpts               /dev/pts     devpts      gid=5,mode=620   0            0
sysfs                /sys         sysfs       defaults         0            0
proc                 /proc        proc        defaults         0            0
LABEL=SWAP-sda2       swap        swap        defaults         0            0

ì˜µì…˜: íŒŒì¼ ì‹œìŠ¤í…œ ì†ì„±ì„ ì„¤ì •í•˜ëŠ” ì˜µì…˜
Â·defaults: rw, nouser, auto, exec, suid ì†ì„±ì„ ëª¨ë‘ ê°€ì§€ëŠ” ì˜µì…˜
Â·auto   : ë¶€íŒ…ì‹œ ìë™ ë§ˆìš´íŠ¸
Â·noauto : ë¶€íŒ…ì‹œ ìë™ ë§ˆìš´íŠ¸ ì•ˆí•¨
Â·exec   : ì‹¤í–‰ íŒŒì¼ì´ ì‹¤í–‰ë˜ëŠ” ê²ƒì„ í—ˆìš© í•¨
Â·noexec: ì‹¤í–‰ íŒŒì¼ì´ ì‹¤í–‰ë˜ëŠ” ê²ƒì„ í—ˆìš© ì•ˆí•¨
Â·suid   : SetUID, SetGIDì˜ ì‚¬ìš©ì„ í—ˆìš©í•˜ëŠ” ì˜µì…˜
Â·ro[read-only]  : ì½ê¸° ì „ìš©
Â·rw[read-write] : ì½ê³  ì“°ê¸° ê°€ëŠ¥
Â·user: ì¼ë°˜ ê³„ì • ì‚¬ìš©ìë“¤ë„ ë§ˆìš´íŠ¸ í•  ìˆ˜ ìˆëŠ” ì˜µì…˜
Â·nouser: rootë§Œ mount ê°€ëŠ¥
Â·usrquota : ì¼ë°˜ ì‚¬ìš©ì quota ì ìš©
Â·grpquota : ê·¸ë£¹ quota ì ìš©
noatime : access timeì— ëŒ€í•˜ì—¬ ì‹œê°„ ì •ë³´ë¥¼ íŒŒì¼ì— ê¸°ë¡í•˜ì§€ ì•ŠìŒ (/var ë””ë ‰í† ë¦¬ì— ë³´í†µ ì„¤ì •)

-dump ê´€ë ¨ ì„¤ì • : 0 or 1
Â· 0: ë¤í”„ë˜ì§€ ì•Šì€ íŒŒì¼ ì‹œìŠ¤í…œ
Â· 1: ë°ì´í„° ë°±ì—…ì„ ìœ„í•´ dump ê°€ëŠ¥

- íŒŒì¼ ì ê²€ ì˜µì…˜ : 0, 1, 2 ê°’ì„ ì§€ì •
Â· 0: ë¶€íŒ…ì‹œ fsckë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ
Â· 1: ë£¨íŠ¸ íŒŒì¼ ì‹œìŠ¤í…œì„ ì˜ë¯¸
Â· 2: ë£¨íŠ¸ íŒŒì¼ ì‹œìŠ¤í…œ ì´ì™¸ì˜ íŒŒì¼ ì‹œìŠ¤í…œì„ ì˜ë¯¸
```

(/etc/fstab íŒŒì¼ ì¶œë ¥ê²°ê³¼ í•´ì„)

```bash
----------------------------------------------------------------------------------------------------------
í•„ë“œ ì„¤ ëª…
----------------------------------------------------------------------------------------------------------
LABEL=/          ë§ˆìš´íŠ¸í•  ì¥ì¹˜ì´ë¦„
/             ë§ˆìš´íŠ¸í¬ì¸í„°, íŒŒì¼ ì‹œìŠ¤í…œì„ ë§ˆìš´íŠ¸í•´ì„œ ì‚¬ìš©í•  ê²½ë¡œë¥¼ ì§€ì •
ext4     ë§ˆìš´íŠ¸í•  íŒŒì¼ ì‹œìŠ¤í…œì˜ í˜•ì‹ ì§€ì • (ë¦¬ëˆ…ìŠ¤ : ext4, ìœˆë„ìš° : FAT, NTFS, CD-ROM : iso9660)
defaults     ë§ˆìš´íŠ¸ í•  ë•Œ ì‚¬ìš©í•  ì˜µì…˜ ì§€ì •   
1       dumpë¼ëŠ” í”„ë¡œê·¸ë¨ì— ì˜í•´ ë¤í”„ íŒŒì¼ì‹œìŠ¤í…œ ì§€ì •. (ext4 ë¦¬ëˆ…ìŠ¤ íŒŒí‹°ì…˜ - 1, ì´ì™¸ íŒŒí‹°ì…˜ - 0ìœ¼ë¡œ í• ë‹¹)
1ë¶€íŒ…ê³¼ì •ì—ì„œ íŒŒì¼ ì‹œìŠ¤í…œì˜ ì´ìƒ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ê³  ë¬¸ì œê°€ ìˆë‹¤ë©´ ìë™ìœ¼ë¡œ ì ê²€
0 : íŒŒì¼ ì‹œìŠ¤í…œ ì ê²€í•˜ì§€ ì•ŠëŠ”ë‹¤.
1 : íŒŒì¼ ì‹œìŠ¤í…œ ì ê²€ ì‹œ ê°€ì¥ ë¨¼ì € check
2 ì´ìƒ : íŒŒì¼ ì‹œìŠ¤í…œ ì ê²€ ì‹œ ìˆœì„œ
----------------------------------------------------------------------------------------------------------
```

[ì°¸ê³ ] /etc/fstab íŒŒì¼ì˜ í•´ì„ì¤‘ LABEL=/data4 ì˜ë¯¸ëŠ”?

'LABEL=/data4' í˜•ì‹ì€ RedHat Linux ê³„ì—´ì—ì„œë§Œ ì¡´ì¬í•œë‹¤.

```bash
# cat /etc/fstab 
----------------------------------------------------------------------------
LABEL=/data4            /data4                  ext4    defaults        1 2
/dev/sda5               /data4                  ext4    defaults        1 2
----------------------------------------------------------------------------
# e2label /dev/sda5      (# e2label /dev/sda5 /data4)
/data4
```

### [EX2] /etc/fstab íŒŒì¼ ì‹¤ìŠµ

```bash
(ì„ ìˆ˜ì‘ì—…) í˜„ì¬ /testmount ë§ˆìš´íŠ¸ê°€ ë˜ì–´ ìˆì§€ ì•Šë‹¤.
 # df -h 
 # umount /testmount
```

```bash
# vi /etc/fstab
LABEL=/                 /                       ext4    defaults        1 1
LABEL=/data1            /data1                  ext4    defaults        1 2
LABEL=/data2            /data2                  ext4    defaults        1 2
LABEL=/data3            /data3                  ext4    defaults        1 2
LABEL=/data4            /data4                  ext4    defaults        1 2
LABEL=/home             /home                   ext4    defaults        1 2
tmpfs                   /dev/shm                tmpfs   defaults        0 0
devpts                  /dev/pts                devpts  gid=5,mode=620  0 0
sysfs                   /sys                    sysfs   defaults        0 0
proc                    /proc                   proc    defaults        0 0
LABEL=SWAP-sda2         swap                    swap    defaults        0 0
/dev/sdb1               /testmount              ext4    defaults        1 0
-> (ë¶€íŒ…) # mount -t ext4 -o defaults /dev/sdb1 /testmount
# df -h
Filesystem            Size  Used Avail Use% Mounted on
/dev/sda1              17G  3.4G   12G  22% /
/dev/sda8             487M   11M  451M   3% /data1
/dev/sda7             487M   11M  451M   3% /data2
/dev/sda6             487M   11M  451M   3% /data3
/dev/sda5             487M   11M  451M   3% /data4
/dev/sda3             487M   11M  451M   3% /home
tmpfs                 506M     0  506M   0% /dev/shm
# reboot    (# init 6, # shutdown -r now)
ë¶€íŒ…ì´ ëœ ì´í›„ì— í™•ì¸
# df -h
Filesystem            Size  Used Avail Use% Mounted on
/dev/sda1              17G  3.4G   12G  22% /

/dev/sda8             487M   11M  451M   3% /data1
/dev/sda7             487M   11M  451M   3% /data2
/dev/sda6             487M   11M  451M   3% /data3
/dev/sda5             487M   11M  451M   3% /data4
/dev/sda3             487M   11M  451M   3% /home
tmpfs                 506M     0  506M   0% /dev/shm
/dev/sdb1            1004M   18M  936M   2% /testmount

-------------------------------------------------------------------------------------------------------------------------------

UUIDë¥¼ ì‚¬ìš©í•œ fstab íŒŒì¼ êµ¬ì„±
UUID = ì†Œí”„íŠ¸ì›¨ì–´ êµ¬ì„±ì— ì‚¬ìš©í•˜ëŠ” í‘œì¤€ ì‹ë³„ì.

# vi /etc/fstab
fstab íŒŒì¼ì˜ í•˜ë‹¨ì— ì¶”ê°€í•œë‹¤.
UUID=f8e014cf-b3e8-4f01-a03f-f7c6a0b4b137 /data			  xfs     defaults        0 0

fstab íŒŒì¼ ì €ì¥

[root@server3 ~]# cat /etc/fstab | grep data
UUID=f8e014cf-b3e8-4f01-a03f-f7c6a0b4b137 /data			  xfs     defaults        0 0 
[root@server3 ~]# blkid | grep sdb1
/dev/sdb1: UUID="f8e014cf-b3e8-4f01-a03f-f7c6a0b4b137" TYPE="xfs" PARTUUID="a58a6a09-01"
[root@server3 ~]# mount -a

[root@server3 ~]# df  /data
Filesystem     1K-blocks  Used Available Use% Mounted on
/dev/sdb1        2085888 47580   2038308   3% /data
```

[3] /proc/mounts íŒŒì¼

/proc/mounts íŒŒì¼ì€ proc ê°€ìƒ íŒŒì¼ ì‹œìŠ¤í…œì˜ ì¼ë¶€ì´ë‹¤. ë‹¤ë¥¸ /proc/ íŒŒì¼ ì‹œìŠ¤í…œê³¼ ë§ˆì°¬ê°€ì§€ë¡œ, mounts "íŒŒì¼"ì€ Linux ì‹œìŠ¤í…œ ìƒ ì–´ëŠ ë””ìŠ¤í¬ ë“œë¼ì´ë¸Œì—ë„ ì‹¤ì œ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤. ì‹¤ì œë¡œ ì´ íŒŒì¼ì€ íŒŒì¼ì´ë¼ê³  í•  ìˆ˜ê°€ ì—†ë‹¤. ì˜¤íˆë ¤ ë¦¬ëˆ…ìŠ¤ ì»¤ë„ì´ ì‹œìŠ¤í…œ ìƒíƒœë¥¼ íŒŒì¼ í˜•ì‹ìœ¼ë¡œ ë‚˜íƒ€ë‚´ì–´ ë³´ì—¬ì£¼ëŠ” ê²ƒì´ë‹¤. cat /proc/mounts ëª…ë ¹ì„ ì‚¬ìš©í•˜ì—¬ ë§ˆìš´íŠ¸ ëœ ëª¨ë“  íŒŒì¼ ì‹œìŠ¤í…œ ìƒíƒœ ì •ë³´ë¥¼ ë³¼ ìˆ˜ ìˆë‹¤.

/procë¼ëŠ” ë””ë ‰í† ë¦¬ì— proc íŒŒì¼ ì‹œìŠ¤í…œì´ ë§ˆìš´íŠ¸ ë  ë•Œ, /etc/mtabê³¼ /proc/mountsëŠ” ë¹„ìŠ·í•œ ë‚´ìš©ì„ ê°€ì§€ê²Œ ëœë‹¤. ì „ìëŠ” ë§ˆìš´íŠ¸ ì˜µì…˜ ë“± ë”ìš± ìì„¸í•œ ì •ë³´ë¥¼ ì§€ë‹ˆê³  ìˆì§€ë§Œ í•­ìƒ ìµœì‹  ì •ë³´ë¥¼ ì§€ë‹ˆê³  ìˆëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤.

```bash
# cat /etc/mtab
/dev/sda1 /ext4 rw 0 0
proc /proc proc rw 0 0
sysfs /sys sysfs rw 0 0
devpts /dev/pts devpts rw,gid=5,mode=620 0 0
tmpfs /dev/shm tmpfs rw 0 0
none /proc/sys/fs/binfmt_misc binfmt_misc rw 0 0
sunrpc /var/lib/nfs/rpc_pipefs rpc_pipefs rw 0 0
/dev/sda1 /ext4 rw 0 0
# cat /proc/mounts
rootfs / rootfs rw 0 0
/dev/root / ext4 rw,data=ordered 0 0
/dev /dev tmpfs rw 0 0
/proc /proc proc rw 0 0
/sys /sys sysfs rw 0 0
/proc/bus/usb /proc/bus/usb usbfs rw 0 0
devpts /dev/pts devpts rw 0 0
tmpfs /dev/shm tmpfs rw 0 0
none /proc/sys/fs/binfmt_misc binfmt_misc rw 0 0
sunrpc /var/lib/nfs/rpc_pipefs rpc_pipefs rw 0 0
/etc/auto.misc /misc autofs rw,fd=7,pgrp=2163,timeout=300,minproto=5,maxproto=5,indirect 0 0
-hosts /net autofs rw,fd=13,pgrp=2163,timeout=300,minproto=5,maxproto=5,indirect 0 0
/proc /var/named/chroot/proc proc rw 0 0
/dev/root /var/named/chroot/var/run/dbus ext4 rw,data=ordered 0 0
```

[ì°¸ê³ ] ë¡œì»¬ & ì›ê²© íŒŒì¼ì‹œìŠ¤í…œ ë§ˆìš´íŠ¸ì‹œ (Local & NFS Mount)

```bash
â–  ë¡œì»¬ ì˜ì—­ íŒŒì¼ ì‹œìŠ¤í…œ ë§ˆìš´íŠ¸ì‹œ
# mount -t ext4 [-o options] /dev/sdb1 /testmount 
# mount /dev/sdb1 /testmount 

â–  ì›ê²© ì˜ì—­ íŒŒì¼ ì‹œìŠ¤í…œ ë§ˆìš´íŠ¸ì‹œ
# mount -t nfs [-o options] [ì„œë²„ipì£¼ì†Œ]:/root/shell /testmount
# mount 192.168.10.252:/root/shell /testmount 

[EX] NFS ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸
# showmount -e 192.168.10.252
/nfstest 192.168.10.0/24

# mkdir â€“p /mnt/server 
# mount 192.168.10.252:/nfstest /mnt/server 

# df â€“h 
192.168.10.252:/nfstest nfs 18G  5.3G   12G  31% /mnt/server
# cd 
# umount /mnt/server
```

# ë§ˆìš´íŠ¸ ê´€ë ¨ ëª…ë ¹ì–´ë“¤

---

- **mount CMD**

     **# mount [-t ext3] [-o rw] /dev/sdb1 /p**

     **# mount /dev/sdb1 /p**

     **# mount /p (/etc/fstab)**

     **# mount LABLE=/home /home**

     **OPTION: ro, noatiome, sosuid, usrquota**

- **umount CMD**

     **# umount /dev/sdb1**

     **# umount /p**

- **mount â€“a (/etc/fstab)**
- **umount â€“a (/etc/mtab)**

---

## mount ëª…ë ¹ì–´

ë§ˆìš´íŠ¸ ê´€ë ¨ ëª…ë ¹ì–´

â–  mount CMD	**/* ìì›(Resource)ì„ ë§ˆìš´íŠ¸í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ëª…ë ¹ì–´ */**

â–  umount CMD	**/* ìì› ë§ˆìš´íŠ¸ë¥¼ í•´ì œ í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ëª…ë ¹ì–´ */**

â–  mount -a CMD	**/* ë§ˆìš´íŠ¸ í•  ë§Œí•œ ì •ë³´ë¥¼ ëª¨ë‘ ë§ˆìš´íŠ¸ í•˜ëŠ” ëª…ë ¹ì–´ */**

â–  umount -a CMD	**/* ë§ˆìš´íŠ¸ ë˜ì–´ ìˆëŠ” ìì›ì„ ëª¨ë‘ í•´ì œí•  ë•Œ ì‚¬ìš©í•˜ëŠ” ëª…ë ¹ì–´ */**

ë§ˆìš´íŠ¸ëŠ” ìì›(ì˜ˆ: ì¥ì¹˜)ì„ ë§ˆìš´íŠ¸ í¬ì¸í„°ì— ì–»ì–´ì ¸ ë§ˆìš´íŠ¸ í¬ì¸í„°ë¥¼ ì‚¬ìš©í•˜ë©´, ìì›ì„ ì‚¬ìš©í•˜ë„ë¡ í•˜ëŠ” ë°©ì‹ì´ë‹¤. ë¦¬ëˆ…ìŠ¤ëŠ” ì¥ì¹˜ë¥¼ íŒŒì¼ ì‹œìŠ¤í…œìœ¼ë¡œ ë°”ê¾¸ì–´ ì£¼ì–´ì•¼ë§Œ ì¸ì‹ í•  ìˆ˜ ìˆê³  ê·¸ ì—­í• ì„ í•˜ëŠ” ê²ƒì´ ë§ˆìš´íŠ¸ ê¸°ëŠ¥ì´ë‹¤. ì‹œìŠ¤í…œì˜ ëª¨ë“  íŒŒì¼ë“¤ì€ í•˜ë‚˜ì˜ ê±°ëŒ€í•œ ë‚˜ë¬´ êµ¬ì¡°ì— ì†í•´ ìˆìœ¼ë©° ê·¸ ë¿Œë¦¬ëŠ” "/" ì´ë‹¤.

## [1] mount / umount ëª…ë ¹ì–´

[ëª…ë ¹ì–´ í˜•ì‹]

```bash
# mount [-t ext4] [-o OPTIONS] /dev/sdb1 /testmount 
# mount /dev/sdb1 /testmount 
# mount /testmount (/etc/fstab)

# umount /dev/sdb1 
# umount /testmount
```

[ë§ˆìš´íŠ¸ ì˜µì…˜]

ë§ˆìš´íŠ¸ì‹œ ê¸°ë³¸ ì˜µì…˜(Defaut Options)ì„ ì‚¬ìš©í•œë‹¤. í•˜ì§€ë§Œ, ê¸°ë³¸ ì˜µì…˜ì€ mount ëª…ë ¹ì–´ ìˆ˜í–‰ì‹œ ì˜µì…˜ì„ ë”°ë¡œ ì£¼ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ ì˜µì…˜ìœ¼ë¡œ ë§ˆìš´íŠ¸ í•˜ê²Œ ëœë‹¤. ê¸°ë³¸ ì˜µì…˜ì€ rw, suid, exec, auto, nouser ì´ë‹¤.

```bash
# mount
defaults : rw, nouser, auto, exec, suid ì†ì„±ì„ ëª¨ë‘ ê°€ì§€ëŠ” ì˜µì…˜

rw     <-> ro /* ro : ì“¸ìˆ˜ ì—†ë‹¤. */
auto   <-> noauto   /* noauto : ë¶€íŒ…ì‹œ ìë™ ë§ˆìš´íŠ¸í•˜ì§€ ì•ŠìŒ */
atime  <-> noatime  /* noatime : Access Timeì„ ê¸°ë¡ìœ¼ë¡œ ë‚¨ê¸°ì§€ ì•ŠëŠ” ì˜µì…˜ */
exec   <-> noexec   /* noexec ì‹¤í–‰ íŒŒì¼ì´ ì‹¤í–‰ë˜ëŠ” ê²ƒì„ í—ˆìš© ì•ˆí•¨ */
suid   <-> nosuid /* nosuid : SetUID í”„ë¡œê·¸ë¨ì²˜ëŸ¼ ë™ì‘í•˜ì§€ ì•ŠëŠ”ë‹¤. */
nouser <-> user  /* nouser : ì¼ë°˜ ê³„ì • ì‚¬ìš©ìì´ ë§ˆìš´íŠ¸ í•  ìˆ˜ ì—†ëŠ” ì˜µì…˜ */

nousrquota <-> usrquota /* nousrpuota : ì¼ë°˜ì‚¬ìš©ì quotaì ìš©í•˜ì§€ ì•ŠìŒ(ext4 ì§€ì›í•˜ì§€ ì•ŠìŒ)*/
nogrpquota <-> grpquota /* nogrpquota : ê·¸ë£¹ quota ì ìš©í•˜ì§€ ì•ŠìŒ */
```

(ë§ˆìš´íŠ¸ ì˜µì…˜ ì˜ˆì œ)

```bash
mount ëª…ë ¹ì–´ ìˆ˜í–‰ì‹œ ro ì˜µì…˜ì„ ì‚¬ìš©í•˜ë©´, ì—¬ëŸ¬ê°€ì§€ ê¸°ë³¸ ì˜µì…˜ ì¤‘ read/writeë§Œ read only ì˜µì…˜ìœ¼ë¡œ ë°”ë€Œê³  ë‚˜ë¨¸ì§€ ì˜µì…˜(ì§€ì •ë˜ì§€ ì•Šì€ ì˜µì…˜)ì€ ê·¸ëŒ€ë¡œ ê¸°ë³¸ì˜µì…˜ì„ ë”°ë¥¸ë‹¤. ì—¬ëŸ¬ê°€ì§€ ì˜µì…˜ì„ ì§€ì •í•˜ëŠ” ê²½ìš° ì»´ë§ˆ(,)ë¡œ êµ¬ë¶„í•œë‹¤.

# mount -o ro /dev/sdb /testmount  (# mount -o ro,nouser,auto,exec,suid /dev/sdb /testmount)
# mount -o ro,nosuid /dev/sdb /testmount
# mount -o noatime /dev/sdb /testmount

ê° íŒŒí‹°ì…˜ë³„ ê¶Œì¥í•˜ëŠ” ë§ˆìš´íŠ¸ ì˜µì…˜(mount Options Reference)]
ro      /usr/local,         /* ì¶”ê°€ì ì¸ íŒ¨í‚¤ì§€ ì„¤ì¹˜ ê³µê°„ -> (read-only) */
nosuid  /home/fedora, /user /* ì‚¬ìš©ì í™ˆë””ë ‰í† ë¦¬(íŒŒí‹°ì…˜) -> SetUID í”„ë¡œê·¸ë¨ìœ¼ë¡œ ë™ì‘(X) */
noatime /var                /* ê°€ë³€ì ì¸ ë°ì´í„° ê¸°ë¡ íŒŒí‹°ì…˜ -> access timeì„ ë‚¨ê¸°ì§€ ì•ŠìŒ*/
```

### [EX1] "ro ë§ˆìš´íŠ¸ ì˜µì…˜" ì‹¤ìŠµ

```bash
# df â€“h
Filesystem            Size  Used Avail Use% Mounted on
/dev/sda1              17G  3.5G   12G  23% /
/dev/sda8             487M   11M  451M   3% /data1
/dev/sda7             487M   11M  451M   3% /data2
/dev/sda6             487M   11M  451M   3% /data3
/dev/sda5             487M   11M  451M   3% /data4
/dev/sda3             487M   11M  451M   3% /home
tmpfs                 506M     0  506M   0% /dev/shm
/dev/sdb1            1004M   18M  936M   2% /testmount
# umount /testmount 
#

# mount -o ro /testmount 
# mount | grep testmount
/dev/sdb1 on /testmount type ext4 (ro)
# touch /testmount/file1
touch: cannot touch `/testmount/file1': Read-only file system
# umount /testmount   (# mount -o remount /testmount)
# mount /testmount
```

### [EX2] "noatime ì˜µì…˜" ì‹¤ìŠµ

atime(Access Time)ì„ ê¸°ë¡ìœ¼ë¡œ ë‚¨ê¸°ì§€ ì•ŠëŠ” ì˜µì…˜ í™•ì¸

```bash
[ì°¸ê³ ] íŒŒì¼ì˜ ì†ì„± ì •ë³´ ì¤‘ ì‹œê°„

mtime(Modify Time)   # ls -l    íŒŒì¼ ìƒì„± ë° íŒŒì¼ì˜ ë‚´ìš©ì„ ìˆ˜ì •í•œ ì‹œê°„ ê¸°ë¡
atime(Access Time)   # ls -lu   íŒŒì¼ ì ‘ê·¼ì‹œê°„ - íŒŒì¼ì„ ì—´ì–´ë³¼ ë•Œ ì‹œê°„ ê¸°ë¡
ctime(Changed Time)  # ls -lc   íŒŒì¼ ì†ì„± ì •ë³´ ë³€ê²½ ì‹œê°„ ê¸°ë¡
```

```bash
# stat file1 
File: `file1'
Size: 1904            Blocks: 8          IO Block: 4096   ì¼ë°˜ íŒŒì¼
Device: 801h/2049d      Inode: 846147      Links: 1
Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)
Access: 2010-06-22 16:09:03.000000000 +0900
Modify: 2010-06-22 16:09:01.000000000 +0900
Change: 2010-06-22 16:09:01.000000000 +0900
```

```bash
â‘  /testmount(/dev/hda1) ë§ˆìš´íŠ¸ ì˜µì…˜ í™•ì¸
# mount | grep testmount
/dev/hda1 on /testmount type ext4 (rw)
-> noatime : ë³´ì´ëŠ” ì˜µì…˜
-> atime(Access Time) : ì•ˆ ë³´ì´ëŠ” ì˜µì…˜
# cat /etc/fstab | grep testmount

â‘¡ ë§ˆìš´íŠ¸ í¬ì¸íŠ¸ ë³€ê²½ ë° ë§ˆìš´íŠ¸ ì˜µì…˜ í™•ì¸(/testmount -> /noatime)
ë§ˆìš´íŠ¸ í•  ë‹¹ì‹œì— íŠ¹ë³„í•˜ê²Œ ì˜µì…˜ì„ ì£¼ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ ì˜µì…˜(Default Options)ìœ¼ë¡œ ë§ˆìš´íŠ¸ ëœë‹¤.

# cd 
# umount /testmount 

# mkdir /noatime 
# mount /dev/sdb1 /noatime 
# mount | grep noatime
/dev/sba1 on /noatime type ext4 (rw)
â‘¢ ë§ˆìš´íŠ¸ì‹œ ê¸°ë³¸ ì˜µì…˜(noatime ì•„ë‹Œ ê²½ìš°) ì„¤ì • í™•ì¸
ê¸°ë³¸ ì˜µì…˜ì„ ì‚¬ìš©í•˜ê²Œ ë˜ë©´ íŒŒì¼ì„ ì ‘ê·¼(Access) í•  ë•Œ ë§ˆë‹¤ atime(Access Time)ì´ ë³€ê²½ëœë‹¤.

# cd /noatime 
# echo "hello" > testfile 
# ls -l testfile /* -l : mtime í™•ì¸í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ì˜µì…˜ */
-rw-r--r-- 1 root root 6 Jan 27 03:39 testfile
# ls -lu testfile /* -u : atime í™•ì¸í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ì˜µì…˜ */
-rw-r--r-- 1 root root 6 Jan 27 03:39 testfile
....
<ì–¼ë§ˆì˜ ì‹œê°„ì´ ì§€ë‚œ í›„>
....

# cat testfile
hello
# ls -l testfile
-rw-r--r-- 1 root root 6 Jan 27 03:39 testfile
# ls -lu testfile
-rw-r--r-- 1 root root 6 Jan 27 03:45 testfile
â‘£ ë§ˆìš´íŠ¸ ì˜µì…˜ noatimeìœ¼ë¡œ ì„¤ì •(noatime)
# cd ; umount /noatime 
**# mount -o noatime /dev/sdb1 /noatime** 
# mount | grep /noatime
/dev/sdb1 on /noatime type ext4 (rw,noatime)
â‘¤ ë³€ê²½ëœ ë§ˆìš´íŠ¸ ì˜µì…˜(noatime) í™•ì¸
# cd /noatime 
# rm -rf /noatime/* 

# echo "hello" > testfile 
# ls -l testfile
-rw-r--r-- 1 root root 6 Jan 27 03:49 testfile
# ls -lu testfile
-rw-r--r-- 1 root root 6 Jan 27 03:49 testfile
......
<ì–¼ë§ˆì˜ ì‹œê°„ì´ ì§€ë‚œ í›„>
......

# cat testfile
hello
# ls -l testfile
-rw-r--r-- 1 root root 6 Jan 27 03:49 testfile
# ls -lu testfile
-rw-r--r-- 1 root root 6 Jan 27 03:49 testfile
# vi testfile 
-> ìƒˆë¡œìš´ ë‚´ìš© ì¶”ê°€

# ls -l testfile
-rw-r--r-- 1 root root 10 Jan 27 10:20 testfile1
# ls -lu testfile
-rw-r--r-- 1 root root 10 Jan 27 10:20 testfile1
```

**(ê¶Œì¥)** **(ì„±ëŠ¥)** noatime ì˜µì…˜ì— ëŒ€í•´ì„œ

/var(Log/Spool/Caching) íŒŒì¼ì‹œìŠ¤í…œì— noatime ì˜µì…˜ì„ í†µí•´ ë§ˆìš´íŠ¸ í•˜ë©´, ì„±ëŠ¥ì´ ì¢‹ì•„ì§„ë‹¤.

ê·¸ë ‡ê¸° ë•Œë¬¸ì— /varë””ë ‰í† ë¦¬ë„ ë³„ë„ì˜ íŒŒí‹°ì…˜ìœ¼ë¡œ ìƒì„±í•˜ëŠ”ê²ƒì„ ì¶”ì²œí•œë‹¤.

### [EX3] nosuid ì˜µì…˜ ì‹¤ìŠµ

nosuid : SetUID í”„ë¡œê·¸ë¨ì²˜ëŸ¼ ë™ì‘í•˜ì§€ ì•ŠëŠ”ë‹¤.

```bash
â‘  ë§ˆìš´íŠ¸ í¬ì¸íŠ¸ ë³€ê²½ ë° ë§ˆìš´íŠ¸ ì˜µì…˜ í™•ì¸
ë§ˆìš´íŠ¸ í•  ë‹¹ì‹œì— íŠ¹ë³„í•˜ê²Œ ì˜µì…˜ì„ ì£¼ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ ì˜µì…˜(Default Options)ìœ¼ë¡œ ë§ˆìš´íŠ¸ ëœë‹¤.

# cd 
# umount /noatime 

# mkdir /setuid 
# mount /dev/sdb1 /setuid 
# mount | grep /setuid
/dev/hda1 on /setuid type ext4 (rw)
â‘¡ SetUID í”„ë¡œê·¸ë¨ ìƒì„±
ì»¤ë„ 2.6ë²„ì „ë¶€í„°ëŠ” ì‰˜ì€ SetUID, SetGIDë¥¼ ë¶€ì—¬í•  ìˆ˜ ì—†ë‹¤. SetUID íŠ¹ìˆ˜ê¶Œí•œì„ ì§€ë‹Œ bashì‰˜ì„ ë§Œë“¤ê¸° ìœ„í•´ vi í¸ì§‘ê¸°ë¥¼ ì´ìš©í•˜ì—¬ í”„ë¡œê·¸ë¨ì„ ë§Œë“ ë‹¤.

# cd /test 
# vi backdoor.c
#include <stdio.h>
--------------------------------
main() 
{
setuid(0);
setgid(0);
system("/bin/bash");
}
--------------------------------
		(gcc íŒ¨í‚¤ì§€ê°€ ì—†ìœ¼ë©´ gcc RPM íŒ¨í‚¤ì§€ ì„¤ì¹˜)
		# rpm -qa | grep gcc 
		# yum -y install gcc
# gcc -o back backdoor.c 
# ls -l back
-rwxr-xr-x 1 root root 5.1K Apr 28 17:24 back*
# chmod 4755 back/* SetUID ê¶Œí•œì„ ë¶€ì—¬ */
# ls -l back
-rwsr-xr-x 1 root root 5.1K Apr 28 17:24 back*
# cp /test/back /setuid /* SetUID ê¶Œí•œì´ ì‹¤í–‰ ê°€ëŠ¥í•˜ë„ë¡ ë§ˆìš´íŠ¸ ëœ ë””ë ‰í† ë¦¬ë¡œ cp */
ë³µì‚¬ëœ íŒŒì¼ì—ëŠ” setuid ê¶Œí•œì´ ì—†ê¸° ë•Œë¬¸ì— ë‹¤ì‹œ setuid ê¶Œí•œì„ ë¶€ì—¬í•´ì¤€ë‹¤.

â‘¢ SetUID í”„ë¡œê·¸ë¨ ì‚¬ìš©ìë¡œ ì‹¤í–‰
# telnet localhost 
fedora ì‚¬ìš©ìë¡œ ë¡œê·¸ì¸

$ id
uid=500(fedora) gid=500(fedora) groups=500(fedora)
$ cd /setuid 
$ ./back
# id
uid=0(root) gid=0(root) groups=500(fedora)
# exit 
$ exit 
#

â‘£ ë§ˆìš´íŠ¸ ì˜µì…˜ nosuidë¡œ ì„¤ì •
# cd ; umount /setuid 
# mount -o nosuid /dev/sdb1 /setuid 
# mount | grep setuid
/dev/hda1 on /setuid type ext4 (rw,nosuid)
# cp /test/back /setuid
â‘¤ nosuid ì˜µì…˜ ì„¤ì • í™•ì¸
# telnet localhost 
fedora ì‚¬ìš©ìë¡œ ë¡œê·¸ì¸

$ id
uid=500(fedora) gid=500(fedora) groups=500(fedora)
$ cd /setuid 
$ ./back 

$ id
uid=500(fedora) gid=500(fedora) groups=500(fedora)
$ exit 
$ exit 
#
```

```bash
(ê¶Œì¥) (ë³´ì•ˆ) nosuid ì˜µì…˜ì— ëŒ€í•´ì„œ
/home(ì‚¬ìš©ì í™ˆë””ë ‰í† ë¦¬) íŒŒì¼ì‹œìŠ¤í…œì€ nosuid ì˜µì…˜ìœ¼ë¡œ ë§ˆìš´íŠ¸ë¥¼ í•˜ë©´, ì‚¬ìš©ìë“¤ì´ SetUID í”„ë¡œê·¸ë¨ì„ ë§Œë“¤ì–´ë„ SetUID ë™ì‘ì„ í•˜ì§€ ì•ŠëŠ”ë‹¤. ë”°ë¼ì„œ ì‹œìŠ¤í…œì˜ ë³´ì•ˆì´ ê°•í™”ëœë‹¤.
# find /home -perm -4000 -exec rm -f {} \; 
# mount -o nosuid /home[EX4] "usrquota ë§ˆìš´íŠ¸ ì˜µì…˜" ì‹¤ìŠµ
```

- [EX4] "usrquota ë§ˆìš´íŠ¸ ì˜µì…˜" ì‹¤ìŠµ

[2] mount -a / umount -a ëª…ë ¹ì–´

mount -a ëª…ë ¹ì–´ëŠ” ë§ˆìš´íŠ¸ í•  ë§Œí•œ ì •ë³´ë“¤ì„ ëª¨ë‘ ë§ˆìš´íŠ¸ í•œë‹¤. ë§ˆìš´íŠ¸ í•  ë§Œí•œ ì •ë³´ë“¤ì€ /etc/fstab íŒŒì¼ì„ ì°¸ì¡°í•˜ì—¬ ë§ˆìš´íŠ¸í•œë‹¤. umount -a ëª…ë ¹ì–´ëŠ” í˜„ì¬ ë§ˆìš´íŠ¸ ë˜ì–´ ìˆëŠ” ëª¨ë“  íŒŒì¼ì‹œìŠ¤í…œì„ ì–¸ ë§ˆìš´íŠ¸ í•œë‹¤. í˜„ì¬ ë§ˆìš´íŠ¸ ëœ ì •ë³´ëŠ” /etc/mtab íŒŒì¼ì— ì¡´ì¬í•œë‹¤. í•˜ì§€ë§Œ ì–¸ë§ˆìš´íŠ¸ ì‹œí‚¬ ìˆ˜ ì—†ëŠ” íŒŒì¼ì‹œìŠ¤í…œì´ ìˆë‹¤. ì´ê²ƒë“¤ì€ /, /usr, /var, /tmp, ê°€ìƒ íŒŒì¼ì‹œìŠ¤í…œë“±ì´ë‹¤.

[ëª…ë ¹ì–´ í˜•ì‹]

```bash
# mount -a /* (/etc/fstab) ë§ˆìš´íŠ¸ í•  ë§Œí•œ ì •ë³´ë¥¼ ëª¨ë‘ ë§ˆìš´íŠ¸ í•˜ëŠ” ëª…ë ¹ì–´ */
# umount -a /* (/etc/mtab)  ë§ˆìš´íŠ¸ ë˜ì–´ ìˆëŠ” ìì›ì„ ëª¨ë‘ í•´ì œí•  ë•Œ ì‚¬ìš©í•˜ëŠ” ëª…ë ¹ì–´ */
```

### [EX] mount -a /umount -a ì‹¤ìŠµ

â‘  umount -a ëª…ë ¹ì–´ ì‹¤ìŠµ

**# df -h**

```bash
# df -h
Filesystem            Size  Used Avail Use% Mounted on
/dev/sda1              17G  3.4G   12G  22% /
/dev/sda8             487M   11M  451M   3% /data1
/dev/sda7             487M   11M  451M   3% /data2
/dev/sda6             487M   11M  451M   3% /data3
/dev/sda5             487M   11M  451M   3% /data4
/dev/sda3             487M   11M  451M   3% /home
tmpfs                 506M     0  506M   0% /dev/shm
/dev/sdb1            1004M   18M  936M   2% /testmount
# umount -a
umount: /var/lib/nfs/rpc_pipefs: device is busy
umount: /: device is busy
# df -h
Filesystem            Size  Used Avail Use% Mounted on
/dev/sda1              17G  3.4G   12G  22% /
â‘¡ mount -a ëª…ë ¹ì–´ ì‹¤ìŠµ
# vi /etc/fstab
LABEL=/                 /                       ext4    defaults        1 1
LABEL=/data1            /data1                  ext4    defaults        1 2
LABEL=/data2            /data2                  ext4    defaults        1 2
LABEL=/data3            /data3                  ext4    defaults        1 2
LABEL=/data4            /data4                  ext4    defaults        1 2
LABEL=/home             /home                   ext4    defaults        1 2
tmpfs                   /dev/shm                tmpfs   defaults        0 0
devpts                  /dev/pts                devpts  gid=5,mode=620  0 0
sysfs                   /sys                    sysfs   defaults        0 0
proc                    /proc                   proc    defaults        0 0
LABEL=SWAP-sda2         swap                    swap    defaults        0 0
#/dev/sdb1              /testmount              ext4    defaults        1 2

# mount -a 
# df -h
Filesystem            Size  Used Avail Use% Mounted on
/dev/sda1              17G  3.4G   12G  22% /
/dev/sda8             487M   11M  451M   3% /data1
/dev/sda7             487M   11M  451M   3% /data2
/dev/sda6             487M   11M  451M   3% /data3
/dev/sda5             487M   11M  451M   3% /data4
/dev/sda3             487M   11M  451M   3% /home
tmpfs                 506M     0  506M   0% /dev/shm
```

## ì‚¬ìš© ì¤‘ì¸ íŒŒì¼ì‹œìŠ¤í…œ ë§ˆìš´íŠ¸ í•´ì œ

ë§ˆìš´íŠ¸ ëœ íŒŒì¼ì‹œìŠ¤í…œì„ ëˆ„êµ°ê°€ ì‚¬ìš©í•˜ê³  ìˆë‹¤ë©´ ê¸°ë³¸ì ìœ¼ë¡œ ê´€ë¦¬ìëŠ” íŒŒì¼ì‹œìŠ¤í…œì„ ì–¸ë§ˆìš´íŠ¸ í•  ìˆ˜ ì—†ë‹¤. ê´€ë¦¬ìëŠ” ì´ëŸ° ê²½ìš°ë¼ í•˜ë”ë¼ë„ ë°˜ë“œì‹œ ì–¸ë§ˆìš´íŠ¸ í•´ì•¼ í•œë‹¤ë©´ fuser -ckë¡œ ë§ˆìš´íŠ¸í¬ì¸í„°ë¥¼ ì‚¬ìš©í•˜ëŠ” ì‚¬ìš©ìë“¤ì„ ê°•ì œë¡œ ë¡œê·¸ì•„ì›ƒ ì‹œí‚¤ê³  umount ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ ê°•ì œì ìœ¼ë¡œ íŒŒì¼ì‹œìŠ¤í…œì„ ì–¸ë§ˆìš´íŠ¸ í•  ìˆ˜ ìˆë‹¤.

[ëª…ë ¹ì–´ í˜•ì‹]

```bash
# fuser -cu /home 
# fuser -ck /home
```

### [EX1] ì‚¬ìš©ì¤‘ì¸ íŒŒì¼ì‹œìŠ¤í…œ ì–¸ë§ˆìš´íŠ¸ ì‹¤ìŠµ

[TERM1] ì‚¬ìš©ì ìœˆë„ìš°

```bash
# telnet localhost 
fedora ì‚¬ìš©ìë¡œ ë¡œê·¸ì¸

$ pwd
/home/fedora
```

[TERM2] ê´€ë¦¬ì ìœˆë„ìš°

```bash
	â–  ì„œë¹„ìŠ¤ ìš´ìš©ì¤‘ì— ì‘ì—…í•´ì•¼ í•˜ëŠ” ê²½ìš°
			- F/S Check     (fsck CMD) : (umount CMD + fsck CMD)
			- Offline Backup(dump CMD) : (umount CMD + dump CMD)
# umount /home
umount: /home: device is busy
umount: /home: device is busy
# fuser -cu /home       /* -c : PID, -u : username */
/home:                5103c(fedora)
# wall '/home directory! stops a use'
Broadcast message from root (pts/1) (Wed Jan 27 05:53:29 2010):
/home directory! stops a use
..... (30ë¶„ ì •ë„ í›„) .....

# fuser â€“cu /home
/home:                5103c(fedora)
# fuser â€“ck /home
/home:                5103c
# umount /home
```

### [EX2] ìì‹ ì´ ì‚¬ìš©ì¤‘ ì¼ë•Œ

```bash
# mount /home 

# cd /home 
# umount /home
umount: /home: device is busy
umount: /home: device is busy
# fuser â€“cu /home
/home:                9018c(root)
# ps
 PID TTY          TIME CMD
 9018 pts/3    00:00:00 bash
# cd 
# umount /home 

# mount /home 
# df -h 
-> /home ë§ˆìš´íŠ¸ í™•ì¸
```

[ì°¸ê³ ] e2label ëª…ë ¹ì–´

â–  e2label : íŠ¹ì • ë³¼ë¥¨ì— ëŒ€í•œ ë³µì¡í•œ ì¥ì¹˜ëª…ì— ë¼ë²¨ì„ ë¶™ì—¬ ì‰½ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” ëª…ë ¹ì–´

[ëª…ë ¹ì–´ í˜•ì‹]

```bash
# e2label /dev/sdb1 
# e2label /dev/sdb1 /testmount
```

### [EX3] e2label ì‹¤ìŠµ

```bash
# e2label
Usage: e2label device [newlabel]
# e2label /dev/sda3
/home
# e2label /dev/sdb1 
#

# e2label /dev/sdb1 /testmount 
# e2label /dev/sdb1
/testmount
# vi /etc/fstab
LABEL=/                 /                       ext4    defaults        1 1
LABEL=/data1            /data1                  ext4    defaults        1 2
LABEL=/data2            /data2                  ext4    defaults        1 2
LABEL=/data3            /data3                  ext4    defaults        1 2
LABEL=/data4            /data4                  ext4    defaults        1 2
LABEL=/home             /home                   ext4    defaults        1 2
tmpfs                   /dev/shm                tmpfs   defaults        0 0
devpts                  /dev/pts                devpts  gid=5,mode=620  0 0
sysfs                   /sys                    sysfs   defaults        0 0
proc                    /proc                   proc    defaults        0 0
LABEL=SWAP-sda2         swap                    swap    defaults        0 0
#
# (1) DISK Configuration
#
#/dev/sdb1              /testmount              ext4    defaults        1 2
LABEL=/testmount        /testmount              ext4    defaults        1 2
# umount /testmount 
# mount /testmount 
# df -h
Filesystem            Size  Used Avail Use% Mounted on
/dev/sda1              17G  3.4G   12G  22% /
/dev/sda8             487M   11M  451M   3% /data1
/dev/sda7             487M   11M  451M   3% /data2
/dev/sda6             487M   11M  451M   3% /data3
/dev/sda5             487M   11M  451M   3% /data4
/dev/sda3             487M   11M  451M   3% /home
tmpfs                 506M     0  506M   0% /dev/shm
/dev/sdb1            1004M   18M  936M   2% /testmount
		# e2label /dev/sdb1 /testmount (/etc/fstab)
		# mount /dev/sdb1 /testmount
		# mount LABEL=/testmount /testmount
		# mount /testmount
```

(ì •ë¦¬|ì‹¤ìŠµ) ë””ìŠ¤í¬ ì¶”ê°€ ì‘ì—…

```bash
ë””ìŠ¤í¬ ì¶”ê°€
- (ã„±) ë””ìŠ¤í¬ ì¸ì‹(# chkconfig kudzu on)
- (ã„´) íŒŒí‹°ì…˜ ì„¤ì •(# fdisk /dev/sdc)
- (ã„·) íŒŒì¼ì‹œìŠ¤í…œ ì‘ì—…(# mkfs.ext4 /dev/sdc1)
- (ã„¹) ë§ˆìš´íŠ¸ ì‘ì—…(# mount /dev/sdc1 /oracle, /etc/fstab)

(ã„±) ë””ìŠ¤í¬ ì¸ì‹
# chkconfig --list kudzu
# chkconfig kudzu on 
Power OFF
ë””ìŠ¤í¬ ì¥ì°©(VMWare > VM > Add > "Hard Drive" > "Create a new virtual disk" > 
                     SCSI > 1.0G > Finish)
Power ON
# ls -l /dev/sd?  (# fdisk -l)
(ã„´) íŒŒí‹°ì…˜ ì„¤ì •
# fdisk /dev/sdc 
/dev/sdc1(primary partition(1G))
# fdisk â€“l /dev/sdc 
(ã„·) íŒŒì¼ì‹œìŠ¤í…œ ì‘ì—…
# mkfs.ext4 /dev/sdc1 
# dumpe2fs /dev/sdc1   (# tune2fs â€“l /dev/sdc1)
(ã„¹) ë§ˆìš´íŠ¸ ì‘ì—…
# mkdir /oracle
# mount /dev/sdc1 /oracle
# vi /etc/fstab
# df â€“h
```

## ì˜¤ë²„ë§ˆìš´íŠ¸

- ì¥ì¹˜ë¥¼ ë§ˆìš´íŠ¸ í•˜ëŠ” ê²½ìš°ì— ë””ë ‰í† ë¦¬ ë‚´ë¶€ê°€ ë¹„ì–´ ìˆëŠ” ë””ë ‰í† ë¦¬ë¥¼ ì‚¬ìš©í•œë‹¤. í•˜ì§€ë§Œ ê°€ë” íŒŒì¼ì´ ìˆëŠ” ì¥ì¹˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ê°€ ìˆë‹¤.
- ì´ë ‡ê²Œ ì˜¤ë²„ ë§ˆìš´íŠ¸ë¥¼ ì‹¤ì‹œí•œ ê²½ìš°ì— ê¸°ì¡´ íŒŒì¼ì´ ì–´ë–»ê²Œ ë˜ëŠ”ì§€ë¥¼ í™•ì¸í•´ë³´ì

```bash
# df
Filesystem     1K-blocks    Used Available Use% Mounted on
devtmpfs         4061940       0   4061940   0% /dev
tmpfs            4077496   12668   4064828   1% /run
tmpfs            4077496       0   4077496   0% /sys/fs/cgroup
/dev/sda1       98490636 4432388  89032100   5% /
tmpfs             815500      12    815488   1% /run/user/42
/dev/sda3         487634    2320    455618   1% /data1
/dev/sda5         487634    2320    455618   1% /data2
/dev/sda6         487634    2320    455618   1% /data3
/dev/sda7         487634    2320    455618   1% /data4
/dev/sdc1        1014680    2564    890980   1% /testdir
/dev/sda8         486610    2338    454628   1% /home
/dev/sdb1        1014680    2580    890964   1% /testmount <<<< í˜„ì¬ /dev/sdb1 ë§ˆìš´íŠ¸ë˜ì–´ ìˆëŠ”ê²ƒì„ í™•ì¸
# umount /testmount
# cd /testmount
# df .
Filesystem     1K-blocks    Used Available Use% Mounted on
/dev/sda1       98490636 4432388  89032100   5% /
# touch file1 file2
# ls
file1  file2
# touch sda1_file
# ls
file1  file2  sda1_file   << /testmount ë””ë ‰í† ë¦¬ ìì²´ì— íŒŒì¼ì„ ìƒì„±
# cd 
# mount /dev/sdb1 /testmount/  >> /dev/sdb1ì— ë‹¤ì‹œ ë§ˆìš´íŠ¸
# cd /testmount/
# ls
back  file1.txt  lost+found    << ê¸°ì¡´ì— ìƒì„±í•œ íŒŒì¼ì´ ë‚˜ì˜¤ì§€ ì•Šìœ¼ë©° /dev/sdb1 ë‚´ì˜ íŒŒì¼ì´ ì¶œë ¥ëœë‹¤.
# cd
# umount /testmount/
# cd /testmount/
# ls
file1  file2  sda1_file

ì˜¤ë²„ë§ˆìš´íŠ¸ë¥¼ í•˜ê²Œë˜ë©´ ë””ë ‰í† ë¦¬ ìì²´ì— ì €ì¥ë˜ì–´ ìˆëŠ” íŒŒì¼ë“¤ì€ ë¬´ì‹œë˜ê³  ë§ˆìš´íŠ¸ëœ ì¥ì¹˜ì˜ íŒŒì¼ë§Œ ë³´ì—¬ì§€ê²Œ ëœë‹¤.
ì´ì „ì— ì‘ì—…í•œ íŒŒì¼ë“¤ì€ ë§ˆìš´íŠ¸ í•´ì œë¥¼ í•´ì•¼ì§€ë§Œ ë³¼ìˆ˜ìˆë‹¤.
ë§ˆìš´íŠ¸ìš© ë””ë ‰í† ë¦¬ì—ëŠ” íŒŒì¼ì„ ì €ì¥í•˜ì§€ ì•ŠëŠ”ë‹¤.
```

ìˆ˜ë™ ë§ˆìš´íŠ¸ë¡œ í™•ì¸

```bash
fstab
stystemctl daemon-reload
mount -a í™•ì¸
init 6
```

ì´ë²ˆì£¼ ë°°ìš´ ë‚´ìš©

í”„ë¡œì„¸ìŠ¤

ë””ìŠ¤í¬ ì¸ì‹

ë””ìŠ¤í¬ íŒŒí‹°ì…˜

ë””ìŠ¤í¬ í¬ë§·

ë””ìŠ¤í¬ ê¸°ë³¸ ë§ˆìš´íŠ¸

ë””ìŠ¤í¬ fstab ë“±ë¡

ê·¸ë¦¬ê³ 

ë””ìŠ¤í¬ ì¸ì‹ë¶€í„° ë¶€íŒ…ì‹œ ë“±ë¡ ê¹Œì§€ì˜ ì‘ì—… ìˆœì„œ ë° êµ¬ì„±
