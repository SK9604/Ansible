## ğŸ™‹ğŸ»â€â™€ï¸ ìŠ¤ë¬¼ë„¤ë²ˆì§¸ ë¹„ëŒ€ë©´ ìˆ˜ì—…

---

# ë‚´ìš© ì •ë¦¬

---

### [EX1] ì‚¬ìš©ì ì„¤ëª… ì •ë³´(Comment) ë° ë¡œê·¸ì¸ ì‰˜(Shell) ë³€ê²½

```bash
# cat /etc/passwd | grep user01 
#
-> ì‚¬ìš©ì ì—†ìŒ

# useradd user01 
# passwd user01
New UNIX password: (ì‚¬ìš©ìì•”í˜¸ì…ë ¥)
Retype new UNIX password: (ì‚¬ìš©ìì•”í˜¸ì…ë ¥)
# cat /etc/passwd | grep user01
user01:x:1000:1000::/home/user01:/bin/bash
# useradd -c testuser -s /bin/sh user02         /* -c ì˜µì…˜ì€ ì‚¬ìš©ìì— ëŒ€í•œ ì„¤ëª… ì¶”ê°€ */
# passwd user02
New UNIX password: (ì‚¬ìš©ìì•”í˜¸ì…ë ¥)
Retype new UNIX password: (ì‚¬ìš©ìì•”í˜¸ì…ë ¥)
# cat /etc/shells
/bin/sh
/bin/bash
/usr/bin/sh
/usr/bin/bash
# cat /etc/passwd | grep user02        /* ì‚¬ìš©ìì— ëŒ€í•œ ì„¤ëª…ê³¼ ì‰˜ì— ëŒ€í•œ ë‚´ìš©ì´ ê¸°ë³¸ ì„¤ì •ê³¼ ë‹¤ë¥´ê²Œ ì„¤ì • */
user02:x:1001:1001:testuser:/home/user02:/bin/sh
# mkdir -p /users 
# dnf -y install ksh
# cat /etc/shells | grep ksh
/bin/ksh
/bin/rksh
/usr/bin/ksh
/usr/bin/rksh
# useradd -s /bin/ksh -d /users/test user03    /* -s ì‚¬ìš©ìê°€ ì‚¬ìš©í•  ì‰˜ê³¼ -d í™ˆë””ë ‰í† ë¦¬ ì„ íƒ */
# passwd user03
New UNIX password: (ì‚¬ìš©ìì•”í˜¸ì…ë ¥)
Retype new UNIX password: (ì‚¬ìš©ìì•”í˜¸ì…ë ¥)
# cat /etc/passwd | grep user03                 /* user3ë§Œ "/users" ë””ë ‰í† ë¦¬ì— í™ˆë””ë ‰í† ë¦¬ê°€ ë§Œë“¤ì–´ì¡Œë‹¤. */
user03:x:1002:1002::/users/test:/bin/tcsh
# ls â€“l /users
drwx------. 3 user03 user03 92  3ì›” 31 11:53 test
```

### [EX2] ì‚¬ìš©ì ë§Œê¸°ì¼(Expire Date) ì„¤ì •

ì›¹ì„œë¹„ìŠ¤ì—ì„œ ë³¼ ìˆ˜ ìˆëŠ” ë§Œê¸°ì¼.

ì„œë¹„ìŠ¤ êµ¬ë§¤ : ë„·í”Œë¦­ìŠ¤. ë””ìŠ¤í¬ ìš©ëŸ‰

ê³„ì •ì— ëŒ€í•œ ë§Œê¸°ì¼:

ìì²´ ì¸ë ¥ì´ ì•„ë‹ˆë¼ ì™¸ë¶€ì—ì„œ ì ì‹œ íŒŒê²¬. ì„ì‹œì ìœ¼ë¡œ í•„ìš”í•œ ê³„ì •

```bash
--------------------------------------------------------------------------------
OPTIONS  DESCRIPTIONS
--------------------------------------------------------------------------------
-e, --expiredate EXPIRE_DATE  set account expiration date to EXPIRE_DATE
--------------------------------------------------------------------------------

â‘  í˜„ì¬ ì‹œê°„ í™•ì¸
# date
Tue Mar 31 11:54:59 KST 2020
-> ì˜¤ëŠ˜ : 2020ë…„ 03ì›”31ì¼ 11:54:59

â‘¡ user04 ì‚¬ìš©ìì˜ Expire Date ì„¤ì •
# useradd -e 2020-04-10 user04
# passwd user04
New UNIX password: (ì‚¬ìš©ìì•”í˜¸ì…ë ¥)
Retype new UNIX password: (ì‚¬ìš©ìì•”í˜¸ì…ë ¥)
-> user04 ì‚¬ìš©ìëŠ” 1ì¼ì´ ì§€ë‚˜ë©´ ì‹œìŠ¤í…œì— ë“¤ì–´ ì˜¬ìˆ˜ ì—†ë‹¤.

# grep user04 /etc/shadow
user04:$6$/ISZhakB$ZrCu.mCJVKjA5/ptXdYPyhDahkXQnwN6s6fpiE5UWFoGFWq77xuqczgzohjW6AKlrlI7uqB1D9Rtird88mtSC0:18352:0:99999:7::18362:
-> 18352 : Last Changed
-> 18362 : Expire Date
-> 18362 - 18352 = ì•½ 10ì¼ì •ë„
   # expr 18362 - 18352

â‘¢ ìš´ì˜ì²´ì œ ì‹œê°„ ë³€ê²½ ë° í…ŒìŠ¤íŠ¸
# date 04111200
Sat Apr 11 12:00:00 KST 2020
-> ìš´ì˜ì²´ì œ ì‹œê°„ ë³€ê²½(2020ë…„ 04ì›”11ì¼ 12:00)

â— í•œêµ­ê¸°ì¤€ìœ¼ë¡œ time Zoneì„ ì„¤ì •í•˜ê²Œ ë˜ë©´ + 0900
íŠ¹ì • ê³„ì •ì„ ìµìŠ¤íŒŒì´ì–´ ì‹œí‚¤ê¸° ìœ„í•˜ì—¬ ë‚ ì§œë¡œ ì§€ì •ì„ í•˜ê²Œ ë˜ë©´ 0900ë•Œë¬¸ì— 0900ê°€ ì§€ë‚˜ì•¼ ì •ìƒì ìœ¼ë¡œ ì ‘ê·¼ì´ ì°¨ë‹¨ëœë‹¤.

# ssh user04@localhost
user04@localhost is password: 
Your account has expired; please contact your system administrator
Authentication failed.

-> ë¡œê·¸ì¸ ë˜ì§€ ì•ŠìŒ
-> Expire Dateë¥¼ ë„˜ì—ˆê¸° ë•Œë¬¸ì—

â‘£ ìš´ì˜ì²´ì œ ì‹œê°„ ë³µì› ë° í…ŒìŠ¤íŠ¸
# rdate -s time.bora.net < ntpë¡œ ì´í›„ì— ìˆ˜ì—…
# date
Tue Mar 31 12:03:14 KST 2020
# ssh user04@localhost
user04@localhost's password: 
Last failed login: Tue Mar 31 12:03:24 KST 2020 from localhost on ssh:notty
There were 2 failed login attempts since the last successful login.
Last login: Tue Mar 31 12:01:19 2020 from localhost

user04 ì‚¬ìš©ìë¡œ ë¡œê·¸ì¸
[user04@server1 ~]$ id
uid=1003(user04) gid=1003(user04) groups=1003(user04) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
[user04@server1 ~]$ exit

expiredate í•´ì œ
# usermod -e -1 user04

--expiredate ì˜µì…˜ì„ ì–¸ì œ ì‚¬ìš©í•˜ëŠ”ê°€ ?
ì™¸ë¶€ì—ì„œ ëª‡ì¼ ì •ë„ íŒŒê²¬ì„ ë‚˜ì˜¨ ì§ì›ì´ ìˆëŠ”ê²½ìš°
í•´ë‹¹ ê³„ì •ì„ ì„ì‹œì ìœ¼ë¡œ ëª‡ì¼ë§Œ ì‚¬ìš©í•˜ëŠ” ê²½ìš°

```

### [EX3] í™ˆê³„ì • ìƒì„±ì‹œ ì°¸ì¡°ë˜ëŠ” ë””ë ‰í† ë¦¬ ë° íŒŒì¼

```bash
skel
ê³„ì •ì„ ìƒì„±í•˜ëŠ” ê²½ìš° ê¸°ë³¸ì ìœ¼ë¡œ ì‚¬ìš© í•´ì•¼ í•˜ëŠ” íŒŒì¼ë“¤ì„ ë¯¸ë¦¬ ì €ì¥í•´ë‘ê³  ê³„ì •ì„ ìƒì„±ì‹œ ë³µì‚¬í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ë§Œë“¤ì–´ì£¼ëŠ” ë””ë ‰í† ë¦¬
ì‚¬ìš©ì ê³„ì •ì´ ìƒì„±ë  ë•Œ /etc/skel(skelton) ë””ë ‰í† ë¦¬ì—ì„œ íŒŒì¼ë“±ì´ ë³µì‚¬ ëœë‹¤.

# useradd user05 
# passwd user05 
-> user05 ì‚¬ìš©ìì˜ ì•”í˜¸ ì…ë ¥

# ls -al /etc/skel /home/user05      /* ë‘ íŒŒì¼ì´ ë™ì¼í•œ ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤ */
/etc/skel:
total 56K
drwxr-xr-x  3 root root  4.0K Feb  3 01:56 .
drwxr-xr-x 109 root root  12K Mar  1 20:05 ..
-rw-r--r--  1 root root   33 Jan 22  2009 .bash_logout
-rw-r--r--  1 root root  176 Jan 22  2009 .bash_profile
-rw-r--r--  1 root root  124 Jan 22  2009 .bashrc
drwxr-xr-x  4 root root 4.0K Feb 18 09:18 .mozilla

/home/user05:
total 32K
drwx------ 3 user04 user04 4.0K Mar 25 17:13 .
drwxr-xr-x 4 root  root    4.0K Mar  1 20:05 ..
-rw-r--r-- 1 user04 user04   33 Mar  1 20:05 .bash_logout
-rw-r--r-- 1 user04 user04  176 Mar  1 20:05 .bash_profile
-rw-r--r-- 1 user04 user04  124 Mar  1 20:05 .bashrc
drwxr-xr-x 4 user04 user04 4.0K Mar  1 20:05 .mozilla

# cd /etc/skel 
# alias ll
alias ll='ls -l --color=tty'  <----- ë³µì‚¬

# vi .bashrc      (# vi /etc/skel/.bashrc)

# .bashrc

# Source global definitions
if [ -f /etc/bashrc ]; then
. /etc/bashrc
fi

# User specific aliases and functions
alias ll='ls -lFh --color=tty'  <----- ìƒˆë¡œìš´ ë¼ì¸ ì¶”ê°€

# useradd user06 
# passwd user06 
-> user06 ì‚¬ìš©ì ì•”í˜¸ ì…ë ¥

# ls -al /etc/skel /home/user06

/etc/skel:
total 52K
drwxr-xr-x  3 root root  4.0K Apr  1 17:20 .
drwxr-xr-x 109 root root  12K Apr  1 17:23 ..
-rw-r--r--  1 root root   33 Jan 22  2009 .bash_logout
-rw-r--r--  1 root root  176 Jan 22  2009 .bash_profile
-rw-r--r--  1 root root  155 Apr  1 17:20 .bashrc
drwxr-xr-x  4 root root 4.0K Feb 18 09:18 .mozilla

/home/user06:
total 28K
drwx------ 3 user06 user06 4.0K Apr  1 17:23 .
drwxr-xr-x 6 root  root    4.0K Apr  1 17:23 ..
-rw-r--r-- 1 user06 user06   33 Apr  1 17:23 .bash_logout
-rw-r--r-- 1 user06 user06  176 Apr  1 17:23 .bash_profile
-rw-r--r-- 1 user06 user06  155 Apr  1 17:23 .bashrc
drwxr-xr-x 4 user06 user06 4.0K Apr  1 17:23 .mozilla

-> /etc/skel ë””ë ‰í† ë¦¬ì•ˆì˜ ë‚´ìš©ì„ ë³€ê²½í–ˆì„ë•Œ ì ìš©ë˜ëŠ” ì‹œì ì€ ìƒˆë¡œìš´ ì‚¬ìš©ìê°€ ì¶”ê°€ë˜ì—ˆì„ì‹œì´ë‹¤.
-> /etc/skel ë””ë ‰í† ë¦¬ì•ˆì˜ ë‚´ìš©ì„ ë³€ê²½í–ˆì„ë•Œ ì´ì „ ì‚¬ìš©ì ë””ë ‰í† ë¦¬(ê¸°ì¡´ì— ì¶”ê°€ëœ ì‚¬ìš©ìì˜ í™ˆë””ë ‰í† ë¦¬)ì— íŒŒì¼
   ë“¤ì—ëŠ” ë°˜ì˜ì´ ë˜ì§€ ì•ŠëŠ”ë‹¤.

# cat /home/user06/.bashrc

# .bashrc

# Source global definitions
if [ -f /etc/bashrc ]; then
        . /etc/bashrc
fi

# User specific aliases and functions
alias ll='ls -l --color=tty'

skel íŒŒì¼ ìƒì„±í›„ ì ìš©í•˜ê¸°

# cp /etc/skel /etc/admin.skel
# cd /etc/admin.skel
# touch file1
# useradd -k /etc/admin.skel -m user05
```

### [EX4] ë‹¤ì¤‘ ì‚¬ìš©ì ì¶”ê°€

```bash
(ê¶Œì¥) ê´€ë¦¬ììš© ìŠ¤í¬ë¦½íŠ¸ ë””ë ‰í† ë¦¬: /root/bin, /root/shell
       # ls -ld /root
```

ì¡°ê±´ë¬¸ê³¼ ë°˜ë³µë¬¸

```jsx
â— ë°˜ë³µë¬¸
count.sh ì˜ ë‚´ìš©ì„ ì‚¬ìš©í•˜ì—¬ ë¬´í•œìœ¼ë¡œ ëŠ˜ì–´ë‚˜ëŠ” ìˆ«ì ë§Œë“¤ê¸°
-------------------------------------------------------------
#!/bin/bash

START=100

echo $START

while true
do
START=`expr $START + 1`

echo 'expr start'
echo $START
done
-------------------------------------------------------------

â— ì¡°ê±´ë¬¸
íŠ¹ì •í•œ ì¡°ê±´ì„ ë§Œì¡±ì‹œí‚¤ëŠ” ê²½ìš°ì—ë§Œ ì‹¤í–‰ì„ í•˜ë„ë¡ í•˜ê¸° ìœ„í•œ êµ¬ë¬¸
ì¡°ê±´ë¬¸ ìì²´
-------------------------------------------------------------
if [ arg1 -option arg2 ]
then
action
fi
--------------------------------------------------------------
if [ $var = 0 ]
	then
		action
fi

if [ $var -le 100 ]
	then
		action
fi
--------------------------------------------------------------
ìˆ«ì 
	-gt  /*1ì˜ ê°’ì´ 2ë³´ë‹¤ í¬ë‹¤*/
	-lt  /*1ì˜ ê°’ì´ 2ë³´ë‹¤ ì‘ë‹¤*/
	-ge  /*1ì˜ ê°’ì´ 2ë³´ë‹¤ í¬ê±°ë‚˜ ê°™ë‹¤*/ 
	-le  /*1ì˜ ê°’ì´ 2ë³´ë‹¤ ì‘ê±°ë‚˜ ê°™ë‹¤*/
	-eq  /*1ê³¼ 2ì˜ ê°’ì´ ê°™ë‹¤*/  < ì¤‘ìš”
	-ne  /*1ê³¼ 2ì˜ ê°’ì´ ë‹¤ë¥´ë‹¤*/
ë¬¸ìì—´
	["str"="str"] 1ë²ˆ ë¬¸ìì—´ì´ 2ë²ˆ ë¬¸ìì—´ê³¼ ê°™ë‹¤
	["str"!="str"] 1ë²ˆ ë¬¸ìì—´ì´ 2ë²ˆ ë¬¸ìì—´ê³¼ ë‹¤ë¥´ë‹¤
íŒŒì¼
	-d íŒŒì¼ì´ ì¡´ì¬í•˜ê³  ë””ë ‰í† ë¦¬
	-f íŒŒì¼ì´ ì¡´ì¬í•˜ê³  íŒŒì¼

--------------------------------------------------------------
#!/bin/bash /* bashë¥¼ ì‚¬ìš©í•˜ì—¬ í”„ë¡œê·¸ë¨ ì‹¤í–‰ */

START=100 /* ë³€ìˆ˜ STARTì— ë³€ìˆ˜ê°’ 100ì„ ì…ë ¥ */
END=140 /* ë³€ìˆ˜ ENDì— ë³€ìˆ˜ê°’ 140ì„ ì…ë ¥ */

while [ $START -le $END ] /* STARTê°’ì´ ENDë³´ë‹¤ ì‘ê±°ë‚˜ ê°™ì€ ë™ì•ˆ ë°˜ë³µë¬¸ì„ ëˆë‹¤ */
do /* ë°˜ë³µë¬¸ ì‹œì‘ */
echo "user$START user$START" >> /root/bin/passwd.txt /* user ìŠ¤íƒ€íŠ¸ê°’ X2 ë¥¼ /root/bin ë°‘ì— passwd.txtíŒŒì¼ì— ë¶™ì—¬ë„£ëŠ”ë‹¤ */
START=`expr $START +  1` /* ë³€ìˆ˜ STARTì— + 1í•œ ê°’ì„ STARTì— ë„£ëŠ”ë‹¤ */
done /* ë°˜ë³µë¬¸ ì¢…ë£Œ */
--------------------------------------------------------------
#!/bin/bash
# bashë¥¼ ì‚¬ìš©í•˜ì—¬ í”„ë¡œê·¸ë¨ ì‹¤í–‰

START=100
# START ë¼ëŠ” ë³€ìˆ˜ì— 100ì„ ì…ë ¥
END=140
# END ë¼ëŠ” ë³€ìˆ˜ì— 140ì„ ì…ë ¥

while [ $START â€“le $END ]
# while ë°˜ë³µë¬¸ ì‹œì‘
# ì¡°ê±´ë¬¸ ì‹¤í–‰
# 	-le ê°€ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì— STARTë³€ìˆ˜ê°€ ENDì¸ 140ì´ ë ë•Œ ê¹Œì§€ ì‹¤í–‰
# -le = STARTì˜ ê°’ì´ ENDë³´ë‹¤ ì‘ê±°ë‚˜ ê°™ì„ ë•Œê¹Œì§€ë§Œ ì‹¤í–‰

do
# ë°˜ë³µë¬¸ ì‹¤í–‰
echo "user$START user$START" >> /root/bin/passwd.txt
# echo êµ¬ë¬¸ì— ë§ì¶° userë¬¸ìì—´+$START , userë¬¸ìì—´+$START ë³€ìˆ˜ë¡œ ì¶œë ¥ëœ ë¬¸ìì—´ì„ /root/bin/passwd.txtì— í‘œì¤€ ì¶œë ¥ìœ¼ë¡œ ë‚´ë³´ë‚´ê¸°, ì´ì–´ì“°ê¸°
START=`expr $START + 1`
# START ë³€ìˆ˜ì˜ ê°’ì„ expr ì‚°ìˆ ì‹ì„ ì´ìš©í•˜ì—¬ +1 í•´ì¤€ë‹¤.
done
# ì¡°ê±´ì— ë§ì§€ ì•ŠëŠ” ê²½ìš° ë¹ ì ¸ë‚˜ê°„ë‹¤.
```

```bash
# mkdir -p /root/bin 
# cd ~/bin 
# vi passwd.txt
user100 user100
user101 user101
(ì‚¬ìš©ì)  (ì•”í˜¸)

â— while ë°˜ë³µ
if ì¡°ê±´
ì¡°ê±´ë¬¸ì´ ì¡°ê±´ì— ë¶€í•©í• ë•Œ ê¹Œì§€ ë°˜ë³µ
expr - ì‚°ìˆ ì‹ ê³„ì‚°í•˜ê¸°
ë°˜ë³µë¬¸ì—ì„œ exprì„ ì‚¬ìš©í•˜ëŠ” ì´ìœ  : í•˜ë‚˜ì”© ì¹´ìš´íŠ¸í•˜ê¸° ìœ„í•œ
#!>shebang
#! ë’¤ì— ì˜¤ëŠ” ì‰˜ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰ì„ í•˜ë¼.
# expr 5 \* 5
25

# vi add.sh
--------------------------------------------------------------
#!/bin/bash

START=100
END=140

while [ $START â€“le $END ]
do
echo "user$START  user$START" >> /root/bin/passwd.txt
START=`expr $START + 1`
done
--------------------------------------------------------------

# vi useradd.sh
#!/bin/bash

cat /root/bin/passwd.txt | while read USER_NAME PASSWD
do
       useradd $USER_NAME
       echo $PASSWD | /usr/bin/passwd --stdin $USER_NAME
done

# chmod 750 useradd.sh 
# ./useradd.sh
Changing password for user user100.
passwd: all authentication tokens updated successfully.
Changing password for user user101.
passwd: all authentication tokens updated successfully.

ë™ì¼í•œ í˜•ì‹ìœ¼ë¡œ êµ¬ì„±í• ìˆ˜ ìˆëŠ” ë°˜ë³µë¬¸

# for i in `seq -w 100` 
> do useradd user$i 
> echo user$i | passwd --stdin user$i
> done
# for i in `seq -w 141 170`; do echo user$i; done
```

```bash
â— ì²« ë¡œê·¸ì¸ ì‹œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë°”ê¾¸ë„ë¡ ì„¤ì •í•˜ê¸°
# chage -d 0 user139
# ssh user139@localhost
user139@localhost's password: 
You are required to change your password immediately (administrator enforced)
WARNING: Your password has expired.
You must change your password now and login again!
Changing password for user user139.
Current password: 
New password:

ï¼  íŒŒì¼ì´ ìˆëŠ”ì§€ ì—†ëŠ”ì§€ í™•ì¸í•˜ê¸°
# cat fcheck.sh
#!/bin/bash

if [ -f /root/bin/passwd.txt ]
	then
		cp /dev/null /root/bin/passwd.txt
		echo "/root/bin/passwd.txt reset"
	else
		echo "passwd.txt file create"
		touch /root/bin/passwd.txt
fi

â— ê³„ì • ìƒì„±ì„ ìœ„í•œ ë‹¨ì¼ íŒŒì¼ ë§Œë“¤ê¸°. (íŒŒì¼ ê²€ì‚¬ í›„ ìˆë‹¤ë©´ ë‚´ìš© ì‚­ì œ, ê³„ì • ìƒì„±ì„ ìœ„í•œ íŒŒì¼ ìƒì„±, ê³„ì • ìƒì„±, ë¹„ë°€ë²ˆí˜¸ ìƒì„±, ë¹„ë°€ë²ˆí˜¸ reset (chage -d 0 username))
# cat mkuser.sh 
#!/bin/bash
set -e /* ì˜¤ë¥˜ ë°œìƒì‹œ ë¬´ì‹œí•˜ë„ë¡ í•œë‹¤ */

START=150
END=170

if [ -f /root/bin/passwd.txt ]
	then
		cp /dev/null /root/bin/passwd.txt
		echo "/root/bin/passwd.txt reset"
fi

touch /root/bin/passwd.txt
echo "/root/bin/passwd.txt create"

while [ $START -le $END ]
do
	echo "user$START user$START" >> /root/bin/passwd.txt
	START=`expr $START + 1`
done

cat /root/bin/passwd.txt | while read USER_NAME PASSWD
do
	useradd $USER_NAME
	echo $PASSWD | /usr/bin/passwd --stdin $USER_NAME
	chage -d 0 $USER_NAME
done

echo "cat /etc/passwd | grep user" ; echo "===================================="
cat /etc/passwd | grep user

echo "cat /etc/shadow | grep user" ; echo "===================================="
cat /etc/shadow | grep user

# ./mkuser.sh
/root/bin/passwd.txt create
Changing password for user user150.
passwd: all authentication tokens updated successfully.
Changing password for user user151.
passwd: all authentication tokens updated successfully.
Changing password for user user152.
passwd: all authentication tokens updated successfully.
.........ì¤‘ëµ..............
Changing password for user user169.
passwd: all authentication tokens updated successfully.
Changing password for user user170.
passwd: all authentication tokens updated successfully.
cat /etc/passwd | grep user
====================================
tss:x:59:59:Account used by the trousers package to sandbox the tcsd daemon:/dev/null:/sbin/nologin
user150:x:1001:1001::/home/user150:/bin/bash
user151:x:1002:1002::/home/user151:/bin/bash
.........ì¤‘ëµ..............
user169:x:1020:1020::/home/user169:/bin/bash
user170:x:1021:1021::/home/user170:/bin/bash
cat /etc/shadow | grep user
====================================
user150:$6$OwJedWfMAtfeS8/9$DXkpbBxYkHiU/T/MtUwcet8c.g2p8rUdY.OwZ1C/fLMhDjz9v48f7lDtAu/7SU/qeHH.fkhHIpSswqTj57axe/:0:0:99999:7:::
user151:$6$aE/2wtvOOOLiexZr$ELuhKxM9YWxVuc9FnrpXulifoleO3gBLDfKjc85coUQw2U9XCemfz1eJ0KsWW/LIV22NT0HqDJ8CCztw.uk1E.:0:0:99999:7:::
.........ì¤‘ëµ..............
user169:$6$W6U3uCZ.TmqdkQZe$chrkzdiiliSFBtB61cOcDfLru3TK5PEz3jqmFpCkAtcEeIhJoR7rWYzmCQhMJuHFiCFVdX5j98CwGRt2l/nz9.:0:0:99999:7:::
user170:$6$OEqqH.fOFQgPqSuG$nGeieQP5Q94ztJJK.iYSgug3agndIcAUx9gpkygVrNU/aWffnfheW.OQE2vJc0ix6j6WeEF/I.Bf7mjMcpzU30:0:0:99999:7:::
```

### [EX5] useradd ëª…ë ¹ì–´ ì‹¤í–‰ì‹œ ì‚¬ìš©ë˜ëŠ” ê¸°ë³¸ ì„¤ì •ê°’ ë°”ê¾¸ê¸°

```bash
# useradd -D /* -D : Default, ì„¤ì •íŒŒì¼ì˜ ë‚´ìš©ì„ ì¶œë ¥ í•¨ */
GROUP=100  /* ê¸°ë³¸ ê·¸ë£¹ GID */
HOME=/home /* ì‚¬ìš©ìì˜ í™ˆë””ë ‰í† ë¦¬ê°€ ìƒì„±ë  ë””ë ‰í† ë¦¬ */
INACTIVE=-1  /* ë¹„ë°€ë²ˆí˜¸ ë§Œê¸° í›„ ê³„ì •ì ê¸ˆ ê¸°ê°„ */
EXPIRE=  /* ë¹„ë°€ë²ˆí˜¸ ë§Œê¸° ì¼ìˆ˜ */
SHELL=/bin/bash  /* ê¸°ë³¸ ì‰˜ */
SKEL=/etc/skel  /* ê³„ì •ìƒì„±ì‹œ í™ˆë””ë ‰í† ë¦¬ì— ë³µì‚¬í•  íŒŒì¼ì„ ê°€ì§„ ë””ë ‰í† ë¦¬ */
CREATE_MAIL_SPOOL=yes

â–ª useradd -D -g 10
â–ª useradd -D -b /users
â–ª useradd -D -s /bin/ksh

# cat /etc/default/useradd
# useradd defaults file
GROUP=100
HOME=/home
INACTIVE=-1
EXPIRE=
SHELL=/bin/bash
SKEL=/etc/skel
CREATE_MAIL_SPOOL=yes

-> useradd -D ëª…ë ¹ì–´ë¥¼ í†µí•´ ì„¤ì •í•˜ë©´ /etc/default/useradd íŒŒì¼ì˜ ë‚´ìš©ì„ ë³€ê²½í•˜ê²Œ ëœë‹¤.

# useradd -D -s /bin/sh 
# useradd -D
GROUP=100
HOME=/home
INACTIVE=-1
EXPIRE=
SHELL=/bin/sh
SKEL=/etc/skel
CREATE_MAIL_SPOOL=yes

# useradd -D â€“b /users 
# useradd â€“D
GROUP=100
HOME=/users
INACTIVE=-1
EXPIRE=
SHELL=/bin/sh
SKEL=/etc/skel
CREATE_MAIL_SPOOL=yes

# cat /etc/default/useradd
GROUP=100
HOME=/users
INACTIVE=-1
EXPIRE=
SHELL=/bin/sh
SKEL=/etc/skel
CREATE_MAIL_SPOOL=yes
# useradd user08 
# passwd user08 
-> ì‚¬ìš©ì ì•”í˜¸ ì…ë ¥

# cat /etc/passwd | grep user07
user07:x:1103:1103::/home/user07:/bin/bash
# cat /etc/passwd | grep user08
user08:x:1104:1104::/users/user08:/bin/sh

```

```bash
(ë³µì›) useradd ëª…ë ¹ì–´ì˜ ê¸°ë³¸ ë™ì‘ ë³µì›
# useradd -D â€“s /bin/bash 
# useradd -D â€“b /home
```

# ê·¸ë£¹ ê´€ë¦¬(Group Administration)

(1) ê·¸ë£¹ ì •ë³´ íŒŒì¼

- /etc/group íŒŒì¼ : ê·¸ë£¹ ì •ë³´ íŒŒì¼

```bash
# cat /etc/group | head -3
root:x:0:
bin:x:1:
daemon:x:2:

(/etc/group íŒŒì¼ì˜ í•„ë“œ í•´ì„)
í•„ ë“œ     ì„¤ ëª…
root     ê·¸ë£¹ ì´ë¦„
x        ê·¸ë£¹ ì•”í˜¸
0        ê·¸ë£¹ ì•„ì´ë””(GID)
root     ê·¸ë£¹(Secondary Group)ì— ì†í•œ ì‚¬ìš©ì ëª©ë¡

# id      (# groups)
uid=0(root) gid=0(root) groups=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
ì£¼ ê·¸ë£¹(Primary Group)   : root(0)
ë¶€ ê·¸ë£¹(Secondary Group) : 

# cat /etc/group | grep root
root:x:0:
```

(2) ê·¸ë£¹ ê´€ë¦¬ ëª…ë ¹ì–´

- groupadd ëª…ë ¹ì–´ ê·¸ë£¹ ì •ë³´ ì¶”ê°€
- groupmod ëª…ë ¹ì–´ ê·¸ë£¹ ì •ë³´ ë³€ê²½
- groupdel ëª…ë ¹ì–´ ê·¸ë£¹ ì •ë³´ ì‚­ì œ

(2-1) groupadd ëª…ë ¹ì–´

[ëª…ë ¹ì–´ í˜•ì‹]

```bash
# groupadd [options] group

Options:
-f, --force  force exit with success status if the specified group already exists
-r,  create system account
-g, --gid GID  use GID for the new group
-h, --help  display this help message and exit
-K, --key KEY=VALUE  overrides /etc/login.defs defaults
-o, --non-unique  allow create group with duplicate(non-unique) GID

(/etc/group)
class1:x:507:

```

[ëª…ë ¹ì–´ ì‚¬ìš©ì˜ˆ]

```bash
# groupadd class1
# groupadd -g 1000 class1
```

ê¸°ë³¸ìƒíƒœì—ì„œ gidë¥¼ ë”°ë¡œ ë¶€ì—¬í•˜ì§€ ì•Šê³  ìƒì„±í•˜ê²Œ ë˜ë©´ gidê°€ í•œì¹¸ì”© ë°€ë ¤ uidì™€ gidê°€ ì„œë¡œ ë‹¤ë¥¸ í˜„ìƒì´ ë°œìƒí•´ë²„ë¦°ë‹¤.

ë”°ë¼ì„œ groupadd ì‹œ -gì˜µì…˜ì€ í•­ìƒ ë¶™ì–´ìˆë‹¤ê³  ìƒê°í•˜ëŠ”ê²Œ í¸í•˜ë‹¤. (ë³´í†µ 60001ë²ˆë¶€í„° ì‚¬ìš©)

groupmodë¥¼ ì‚¬ìš©í•˜ê¸°ë³´ë‹¤ ì²˜ìŒì— ì„¤ê³„í•  ë•Œ ì–´ë–»ê²Œ ê³„ì •ì„ ë§Œë“¤ê²ƒì¸ê°€ ì˜ ìƒê°í•´ì„œ groupaddì—ì„œ í•œë²ˆì— ëë‚´ë„ë¡ í•œë‹¤.

### [EX] ê·¸ë£¹ ì¶”ê°€

```bash
# groupadd class1 
# grep class1 /etc/group
ss1:x:1105:
# groupadd -g 60000 class2 
# grep class2 /etc/group
class2:x:60000:

# useradd team03
# usermod -aG g1 team03
```

(2-2) groupmod ëª…ë ¹ì–´

[ëª…ë ¹ì–´ í˜•ì‹]

```bash
# groupmod [-g gid [-o]] [-n name] group
OPTIONS
      -g gid
The numerical value of the group's ID. This value must be unique,
unless the -o option is used. The value must be non-negative. Values
between 0 and 999 are typically reserved for system groups. Any files
which the old group ID is the file group ID must have the file group ID
changed manually.

      -n new_group_name
The name of the group will be changed from group to new_group_name.

(/etc/group)
class1:x:507:
 -n       -g
```

[ëª…ë ¹ì–´ ì‚¬ìš© ì˜ˆ]

```bash
# groupmod -g 1001 class1
# groupmod -n class2 class1    (-n : Group Name)
```

### [EX] ê·¸ë£¹ ì •ë³´ ë³€ê²½

```bash
# cat /etc/group | grep class1
class1:x:1105:

# groupmod -g 59999 class1 
# grep class1 /etc/group
class1:x:59999:
# groupmod -n class3 class1 
# cat /etc/group  | tail -3
user08:x:1104:
class2:x:60000:
class3:x:59999:
```

(2-3) groupdel ëª…ë ¹ì–´

[ëª…ë ¹ì–´ í˜•ì‹]

```bash
# groupdel group
```

[ëª…ë ¹ì–´ ì‚¬ìš© ì˜ˆ]

```bash
# groupdel class1
```

### [EX] ê·¸ë£¹ ì‚­ì œ

```bash
# cat /etc/group | tail
stapusr:x:156:
stapsys:x:157:
stapdev:x:158:
user01:x:1000:
user02:x:1001:
user03:x:1002:
user04:x:1003:
user08:x:1104:
class2:x:60000:
class3:x:59999:

# groupdel class2 
# groupdel class3
```

### [EX]ê·¸ë£¹ì¶”ê°€

```bash
# groupadd -g 60000 class1
# usermod -aG class1 team01
# id team01
uid=1105(team01) gid=1105(team01) groups=1105(team01),60000(class1)

# useradd  -G class1 team02 
# id team02
uid=1106(team02) gid=1106(team02) groups=1106(team02),60000(class1)

```

```bash
ê³„ì •ê³¼ ê·¸ë£¹ìœ¼ë¡œ ê³µìœ íŒŒì¼ ë§Œë“¤ê¸°
/share ë””ë ‰í† ë¦¬
/project ë””ë ‰í† ë¦¬
ê·¸ë£¹ì´ ë‘ê°€ì§€ g1, g2
ê°ê° ì‚¬ìš©ìë“¤ ë‘ëª…ì”© ì¡´ì¬ guser11, guser12
												 guser21, guser22
ë³„ë„ì˜ ê·¸ë£¹ g3ì˜ ë””ë ‰í† ë¦¬ëŠ” g1, g2ê°€ ì ‘ê·¼ ê°€ëŠ¥í•˜ë‹¤
# chmod 2770 /ë³„ë„ì˜ ê·¸ë£¹
```

### íŒ¨ìŠ¤ì›Œë“œ ì‚¬ìš© ì œí•œ ê´€ë¦¬(Password Aging)

ì‹œìŠ¤í…œ ë³´ì•ˆì„ ìœ„í•´ ì‚¬ìš©ì íŒ¨ìŠ¤ì›Œë“œ ë§Œê¸°ì¼ì„ ì„¤ì • ë° ë³€ê²½í•˜ëŠ” ëª…ë ¹ì–´ë¥¼ ë°°ì›Œ ë³´ì.

- password age(password aging)

(1) chage ëª…ë ¹ì–´

[ëª…ë ¹ì–´ í˜•ì‹]

```bash
Options:

-d, --lastday LAST_DAY  set last password change to LAST_DAY
-E, --expiredate EXPIRE_DATE  set account expiration date to EXPIRE_DATE
-h, --help  display this help message and exit
-I, --inactive INACTIVE  set password inactive after expiration to INACTIVE
-l, --list  show account aging information
-m, --mindays  MIN_DAYS  set minimum number of days before password change to MIN_DAYS
-M, --maxdays  MAX_DAYS  set maximim number of days before password change to MAX_DAYS
-W, --warndays WARN_DAYS  set expiration warning days to WARN_DAYS
```

[ëª…í˜•ì–´ ì‚¬ìš©ì˜ˆ]

```bash
# chage -M 30 -W 7 user01
# chage -E 2010-03-30 user01
# chage -l user01

(/etc/shadow)
user01:$1$eG0hsAqw$Cfawvh5OsIye2rKYcRPH.0:Last Change:MIN:MAX:WARN:INATIVE:Expire Date:
user01:$1$eG0hsAqw$Cfawvh5OsIye2rKYcRPH.0:14650:0:99999:7:::
user02:$1$eG0hsAqw$Cfawvh5OsIye2rKYcRPH.0:14650:30:90:7:30:15000:
```

ë‹¤ìŒì€ íŒ¨ìŠ¤ì›Œë“œ ì—ì´ì§•(Password Aging)ì— ëŒ€í•œ ì„¤ëª… ê·¸ë¦¼ì´ë‹¤.

```bash
í˜„ì¬(ì•”í˜¸ê°€ ë³€ê²½ëœ ë‚ ì§œ)
|
|                     30(MIN)                    90(MAX)               2014.12.31(ExpireDate)
|                        |                          |                           |
|------------------------+--------------------------+---------------------------+---
|                                      |7(WARN)| 
																										90(MAX)             30(Inactive)                                        2014.12.31(ExpreDate)
																										|                        |                                                      |
																										|------------------------+------------------------------------------------------+
																										|
```

### [EX1] íŒ¨ìŠ¤ì›Œë“œ ë³€ê²½í›„ ë‹¤ì‹œ ë³€ê²½í•  ìˆ˜ ìˆëŠ” ìµœì†Œ ë‚ ì§œ(Min Chage ì„¤ì •)

```bash
(ì „ì œì¡°ê±´) user01/user02/user03 ì‚¬ìš©ìê°€ ì¡´ì¬í•´ì•¼ í•œë‹¤.
- ê¸°ì¡´ì˜ ì‚¬ìš©ì ëª¨ë‘ ì‚­ì œ(user01, user02, user03, ..... user100, user101)
```

```bash
ì´ì „ì— ìƒì„±ëœ user100 â€“ user140 ì‚­ì œ

# cd /root/bin

# cat passwd.txt  | awk '{ print $1 }' > userlist.txt

# vi userdel.sh ( cp useradd.sh userdel.sh )
------------------------------------------------
#!/bin/bash

cat /root/bin/userlist.txt | while read USER_NAME

do
       userdel -r $USER_NAME
done
------------------------------------------------
```

```bash
# userdel â€“r user01 
- ìƒˆë¡œìš´ ì‚¬ìš©ì ì¶”ê°€(user01, user02, user03)
# useradd user01 
# passwd user01
```

```bash
# chage -l user01
Last password change  : Feb 10, 2010
Password expires  : never
Password inactive  : never
Account expires  : never
Minimum number of days between password change  : 0
Maximum number of days between password change  : 99999
Number of days of warning before password expires  : 7

# cat /etc/shadow | grep user01
user01:$6$ThNFv.MM$16eZYw8xlwfteQKHDJbkQbLGi.m2P1mkC5cShZkq/WY1Xk46KPMeICrcWxJJP5jrcJbF8kas7vZOmRun0Mxnx1:18352:0:99999:7:::
# chage -m 7 user01     /* -m : MIN Change */
# chage â€“l user01
Last password change  : Apr 01, 2010
Password expires  : never
Password inactive  : never
Account expires  : never
Minimum number of days between password change  : 7
Maximum number of days between password change  : 99999
Number of days of warning before password expires  : 7

# ssh user01@localhost
user01@localhost's password: 
[user01@server1 ~]$ passwd
Changing password for user user01.
Changing password for user01.
(current) UNIX password: 
You must wait longer to change your password   <----- ì‚¬ìš©ìëŠ” 7ì¼ì´ì „ì— ì•”í˜¸ë¥¼ ë³€ê²½í•  ìˆ˜ ì—†ë‹¤.
passwd: Authentication token manipulation error
$ exit
```

### [EX2] íŒ¨ìŠ¤ì›Œë“œ ë³€ê²½ í›„ ì‚¬ìš© ê°€ëŠ¥ ì¼ì(MAX Chage ì„¤ì •)

```bash

# chage -l user01
Last password change					: Mar 31, 2020
Password expires					: never
Password inactive					: never
Account expires						: never
Minimum number of days between password change		: 7
Maximum number of days between password change		: 99999
Number of days of warning before password expires	: 7

# chage -M 30 user02     /* -M : MAX Change */
# chage â€“l user02
Last password change					: Mar 31, 2020
Password expires					: Apr 30, 2020
Password inactive					: never
Account expires						: never
Minimum number of days between password change		: 7
Maximum number of days between password change		: 30
Number of days of warning before password expires	: 7

```

```bash
í˜„ì¬(ì•”í˜¸ê°€ ë³€ê²½ëœ ë‚ ì§œ)
|
|                                                30(MAX) 
|                                                   | 
|------------------------+--------------------------+---------------------------+---
|                                           |7(WARN)| 
3ì›”31ì¼                                           4ì›”30ì¼
```

```bash
# date
Tue Mar 31 13:05:14 KST 2020
# date 05011200    (05ì›”1ì¼ 12:00)
Fri May  1 12:00:00 KST 2020
# ssh user01@localhost
user01@localhost is password: 
You are required to change your password immediately (password aged)
Last login: Tue Mar 31 13:00:44 2020 from localhost
WARNING: Your password has expired.
You must change your password now and login again!
Changing password for user user01.
Changing password for user01.
(current) UNIX password: 
New password: 
Retype new password: 
passwd: all authentication tokens updated successfully.
Connection to localhost closed.
# ssh user01@localhost
user01@localhost is password: 
Last login: Fri May  1 12:00:23 2020 from localhost
[user01@server1 ~]$

# rdate -s time.bora.net
# passwd user01
Changing password for user user01.
New password: 
BAD PASSWORD: The password is shorter than 7 characters
Retype new password: 
passwd: all authentication tokens updated successfully.
# chage -l user01
Last password change					: Mar 31, 2020
Password expires					: Apr 30, 2020
Password inactive					: never
Account expires						: never
Minimum number of days between password change		: 7
Maximum number of days between password change		: 30
Number of days of warning before password expires	: 7
# date 04281200
Tue Apr 28 12:00:00 KST 2020
# ssh user01@localhost
user01@localhost is password: 
Warning: your password will expire in 2 days
Last login: Fri May  1 12:01:13 2020 from localhost

# rdate -s time.bora.net
# chage -E 2020-05-05 user03      /* -E : Expire Date */
# chage -l user01
Last password change					: Mar 31, 2020
Password expires					: Apr 30, 2020
Password inactive					: never
Account expires						: May 05, 2020
Minimum number of days between password change		: 7
Maximum number of days between password change		: 30
Number of days of warning before password expires	: 7

# date 05061200
Wed May  6 12:00:00 KST 2020
# ssh user01@localhost
user01@localhost is password: 
Your account has expired; please contact your system administrator
Authentication failed.

Password expires > ë¹„ë°€ë²ˆí˜¸ê°€ ë§Œë£Œëœ ì´í›„ ì ‘ì†ì„ ì‹œë„í•˜ê²Œ ë˜ë©´ ê°•ì œì ìœ¼ë¡œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•˜ê³  ì¬ì ‘ì† í•œë‹¤.
Account expires > ì ‘ì†ë¶ˆê°€

		# chage -E "" user01
		# chage â€“l user01

```

### [EX3] oracle/wasuser ì‚¬ìš©ì ì¶”ê°€

```bash
â–  Oracle DB(oracle) ì‚¬ìš©ì ì¶”ê°€
# groupadd oinstall 
# groupadd dba 
# useradd -g oinstall -G dba -d /oracle oracle 

[ì°¸ê³ ] useradd ëª…ë ¹ì–´ ìˆ˜í–‰ì‹œ ì—ëŸ¬ ë°œìƒë˜ëŠ” ê²½ìš°
# useradd -g oinstall -G dba -d /oracle oracle 
useradd: warning: the home directory already exists.
Not copying any file from skel directory into it.
# ls â€“ld /oracle
# chown â€“R oracle:oinstall /oracle

# passwd oracle 
# su - oracle 
$ id 
$ pwd 
$ exit 

â–  WAS(Web Application Server) ì‚¬ìš©ì ì¶”ê°€
# groupadd wasgroup 
# useradd -g wasgroup -d /was wasuser 
# passwd wasuser 
# su â€“ wasuser 
$ id 
$ pwd 
$ exit
```

```bash
(ì›ë³µ) ì‚¬ìš©ì ì •ë³´ ì›ë³µ ë° ì‹œê°„
1.  ì‚¬ìš©ì ì •ë³´ ì›ë³µ
# userdel â€“r oracle 
# groupdel dba 
# groupdel oinstall 

# userdel -r wasuser 
# groupdel wasgroup 

# userdel -r user01
# userdel -r user02
# userdel -r user03

# useradd user01 
# useradd user02 
# useradd user03 

# passwd user01 
# passwd user02 
# passwd user03 

2. ìš´ì˜ì²´ì œ ì‹œê°„ ì›ë³µ
# rdate -s time.bora.net (# rdate 172.16.9.252)
```

# ìŠ¤ì¼€ì¥´ë§ ê´€ë¦¬

# ë‹¨ì›ëª©í‘œ

---

- at
- crontab

---

ë¦¬ëˆ…ìŠ¤ ìŠ¤ì¼€ì¤„ë§ ê´€ë¦¬

í¸ì˜ì„±

ìš°ë¦¬ ê¸°ì—…ìŠ¤ì´ ì„œë²„ëŠ” ë§¤ì¼ ìƒˆë²½ 2:45ë¶„ë§ˆë‹¤ ë°±ì—…ì„ ì§„í–‰ ë§¤ì£¼ ì˜¤ì „ 8ì‹œë§ˆë‹¤ ë°ì´í„°ë¥¼ ë³´ê³ ì„œë¡œ ì‘ì„± ë§¤ì›” ì „ì²´ ë°ì´í„°ì— ëŒ€í•œ ê²€ì¦

## at ëª…ë ¹ì–´

at ë°ëª¬ì€ ì§€ì •í•œ ì‹œê°„ì— ì–´ë– í•œ ì‘ì—…ì´ ì‹¤í–‰ë  ìˆ˜ ìˆë„ë¡ ì‘ì—… ìŠ¤ì¼€ì¤„ì„ ì˜ˆì•½ ì²˜ë¦¬í•´ ì£¼ëŠ” ê¸°ëŠ¥ì„ í•œë‹¤. 
at ìŠ¤ì¼€ì¤„ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” at ë°ëª¬ì´ ì‘ë™í•˜ê³  ìˆì–´ì•¼ í•˜ë¯€ë¡œ, ë‹¤ìŒê³¼ ê°™ì´ atd ë°ëª¬ì„ ë™ì‘ì‹œí‚¨ë‹¤.

```bash
# systemctl restart atd.service
# systemctl status atd.service 
* atd.service - Job spooling tools
   Loaded: loaded (/usr/lib/systemd/system/atd.service; enabled; vendor preset: enabled)
   **Active: active (running)** since Wed 2020-05-06 12:20:50 KST; 9s ago
 Main PID: 66418 (atd)
    Tasks: 1
   CGroup: /system.slice/atd.service
           `-66418 /usr/sbin/atd -f

May 06 12:20:50 server1.example.com systemd[1]: Started Job spooling tools.
```

[ëª…ë ¹ì–´ í˜•ì‹]

```bash
# at time
Usage: at [-V] [-q x] [-f file] [-m] time
       at [-V] [-q x] [-f file] [-m] -t [[CC]YY]MMDDhhmm
       at -c job [job...]
       (atq | at -l) [-V] [-q x]
       (atrm | at -d | at -r) [-V] [-q x] job ...
       batch [-V] [-f file] [-m]
```

[ëª…ë ¹ì–´ ì‚¬ìš©ì˜ˆ]

```bash
â–  ì‘ì—… ì„ ì–¸
# at 1300
# at 10:00pm today

â–  ì‘ì—… í™•ì¸
# at -l
# atq

â–  ì‘ì—… ì·¨ì†Œ
# atrm N  (N : Job ID)
# at -r N
```

### [EX1] at ëª…ë ¹ì–´ ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸

[TERM1] ê´€ë¦¬ì ëª¨ë‹ˆí„°ë§ ìœˆë„ìš° 1

```bash
# tty
/dev/pts/3
```

[TERM2] ê´€ë¦¬ì ëª…ë ¹ì–´ ìœˆë„ìš° 2

```bash
# date
Tue Mar 31 14:45:50 KST 2020

# at 1447
at> echo hello > /dev/pts/2
at> <EOT>
job 1 at Tue Mar 31 14:47:00 2020
at> <CTRL + D>        <----- '<CTRL + D>' ì…ë ¥
at> <EOT>
job 1 at Tue Mar 31 14:47:00 2020

# at 1600
at> echo
at> <EOT>
job 2 at Tue Mar 31 16:00:00 2020
# 
# at 1601
at> echo
at> <EOT>
job 3 at Tue Mar 31 16:01:00 2020
# 
# at   
Garbled time
# at 1700
at> sleep
at> <EOT>
job 4 at Tue Mar 31 17:00:00 2020

# at â€“l        (# atq)
2	Tue Mar 31 16:00:00 2020 a root
3	Tue Mar 31 16:01:00 2020 a root
4	Tue Mar 31 17:00:00 2020 a root
# atrm 2
# at -l
3	Tue Mar 31 16:01:00 2020 a root
4	Tue Mar 31 17:00:00 2020 a root
# at -r 3
# at -l
4	Tue Mar 31 17:00:00 2020 a root
# at -r 4
-> ì¶œë ¥ëœ ë‚´ìš©ì´ ì—†ìŒ
```

```bash
â–  at ëª…ë ¹ì–´ ì‚¬ìš©ì ì œí•œ
at ë°ëª¬ì„ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì‚¬ìš©ìë¥¼ ì œí•œí•  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ ìˆë‹¤. /etc/at.allow íŒŒì¼ê³¼ /etc/at.deny íŒŒì¼ì„ ì´ìš©
í•˜ì—¬ atì„ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì‚¬ìš©ìë“¤ì„ ì§€ì •í•œë‹¤. 

at.deny íŒŒì¼ë§Œ ì¡´ì¬í•˜ë©´, at.deny íŒŒì¼ì— ì¡´ì¬í•˜ëŠ” ì‚¬ìš©ìëŠ” at  ëª…ë ¹ì–´ë¥¼ ìˆ˜í–‰í•  ìˆ˜ ì—†ê³ ,  at.deny íŒŒì¼ì— ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ëª¨ë“  ì‚¬ìš©ìëŠ” at ëª…ë ¹ì–´ë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.
at.allow íŒŒì¼ì´ ì¡´ì¬í•˜ë©´, at.allow íŒŒì¼ì— ì¡´ì¬í•˜ëŠ” ì‚¬ìš©ìë§Œ at ëª…ë ¹ì–´ë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤. at.allow íŒŒì¼ì´ì¡´ì¬í•˜ë©´, at.deny íŒŒì¼ì€ ë³´ì§€ ì•ŠëŠ”ë‹¤. 

The  /etc/at.allow  and /etc/at.deny files determine which user can submit
commands for later execution via at(1) or batch(1).

The format of the files is a list of usernames, one on each line.  Whitespace is not permitted.
The superuser may always use at.

If  the  file  /etc/at.allow  exists,  only  usernames mentioned in it are
allowed to use at.

If /etc/at.allow does not exist, /etc/at.deny is checked.
```

### [EX] at ëª…ë ¹ì–´ ì‚¬ìš©ì ì œí•œ

```bash
< ì‚¬ì „ì‘ì—… > í•´ë‹¹ ê³„ì •ì´ ì¡´ì¬í•´ì•¼ í•œë‹¤. at1 at2
# /etc/passwd | grep at 
at1:x:1107:1107::/home/at1:/bin/bash
at2:x:1108:1108::/home/at2:/bin/bash
â‘  ê¸°ë³¸ ì‚¬í•­ ì ê²€
# ls -l /etc/at.*
-rw-r--r--. 1 root root 1 Oct 31  2018 /etc/at.deny

/etc/at.deny > atì„ ì‚¬ìš©í• ìˆ˜ ìˆëŠ” ì‚¬ìš©ìì— ëŒ€í•œ ì œí•œì„ ê±¸ì–´ì¤€ë‹¤. ê¸°ë³¸ì€ ëª¨ë“  ì‚¬ìš©ìê°€ ì‚¬ìš©í• ìˆ˜ ìˆë„ë¡ íŒŒì¼ ë‚´ë¶€ì—ëŠ” ì•„ë¬´ ë‚´ìš©ì´ ì—†ë‹¤.
# cat /etc/at.deny

#

[root@server1 ~]# su - at1
[at1@server1 ~]$ date
Tue Mar 31 14:55:29 KST 2020
[at1@server1 ~]$ at 1500
You do not have permission to use at. > at1 ì‚¬ìš©ìëŠ” /etc/at.deny íŒŒì¼ì— ì‘ì„±ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— at ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í• ìˆ˜ ì—†ë‹¤.

[root@server1 ~]# su -  at2
[at2@server1 ~]$ at 1500
at>     > at2 ì‚¬ìš©ìëŠ” ì‚¬ìš©ê°€ëŠ¥í•˜ë‹¤.

/etc/at.deny íŒŒì¼ì— ë“±ë¡ë˜ì–´ ìˆëŠ” ì‚¬ìš©ìë§Œ ì‚¬ìš© ë¶ˆê°€ëŠ¥í•˜ë‹¤.
[íŒŒì¼ ì›ë³µ]
# > /etc/at.deny

â‘¡ /etc/at.allow íŒŒì¼ ìƒì„±
# cat /etc/at.allow
at2
â‘¢ at1 ì‚¬ìš©ìë¡œ í…ŒìŠ¤íŠ¸
# su - at1
ë§ˆì§€ë§‰ ë¡œê·¸ì¸: í™”  3ì›” 31 14:55:25 KST 2020 ì¼ì‹œ pts/2
[at1@server1 ~]$ at 1500
You do not have permission to use at. > at ëª…ë ¹ì–´ ì‚¬ìš©ë¶ˆê°€
â‘£ at2 ì‚¬ìš©ìë¡œ í…ŒìŠ¤íŠ¸
[root@server1 ~]# su - at2
ë§ˆì§€ë§‰ ë¡œê·¸ì¸: í™”  3ì›” 31 14:56:03 KST 2020 ì¼ì‹œ pts/2
[at2@server1 ~]$ at 1500
at> <EOT>
job 7 at Tue Mar 31 15:00:00 2020
```

## crontab ëª…ë ¹ì–´

cron ë°ëª¬ì€ ê°™ì€ ì‘ì—…ì„ ì£¼ê¸°ì ìœ¼ë¡œ ë°˜ë³µ ì‹¤í–‰ë˜ë„ë¡ í•˜ëŠ” ì‘ì—… ìŠ¤ì¼€ì¤„ìš© ë°ëª¬ìœ¼ë¡œ, ë§¤ë¶„, ë§¤ì‹œ, ë§¤ì¼, ë§¤ì£¼, ë§¤ì›”, ë§¤ìš”ì¼ ë‹¨ìœ„ë¡œ cron ë°ëª¬ì— ì˜í•´ì„œ ì‘ì—…ì´ ì‹¤í–‰ë  ìˆ˜ ìˆë‹¤. /etc ë””ë ‰í† ë¦¬ì— ë³´ë©´ ì‹œ, ì¼, ì£¼, ì›”, ìš”ì¼ ë‹¨ìœ„ í˜•íƒœë¡œ cron ë””ë ‰í† ë¦¬ê°€ ì¡´ì¬í•˜ë©°, ì´ë“¤ ë””ë ‰í† ë¦¬ì—ëŠ” ì‘ì—… ì˜ˆì•½ ìŠ¤í¬ë¦½íŠ¸ë“¤ì´ ë“¤ì–´ ìˆë‹¤. /etc/cron/daily ë””ë ‰í† ë¦¬ì•ˆì—ëŠ” ì—¬ëŸ¬ ê°€ì§€ ìŠ¤í¬ë¦½íŠ¸ë“¤ì´ ì¡´ì¬í•˜ëŠ”ë°, ë§¤ì¼ ì´ë“¤ ìŠ¤í¬ë¦½íŠ¸ëŠ” cron ë°ëª¬ì— ì˜í•´ì„œ ìë™ì ìœ¼ë¡œ ì‹¤í–‰ëœë‹¤.

(cron ë°ëª¬ì‹¤í–‰)

cronìœ¼ë¡œ ì‘ì—… ìŠ¤ì¼€ì¤„ì„ ì˜ˆì•½í•˜ê¸° ìœ„í•´ì„œëŠ” crond ë°ëª¬ì„ ì‘ë™ì‹œì¼œì•¼ í•˜ëŠ”ë° ë‹¤ìŒê³¼ ê°™ì´ ë°ëª¬ì„ ì¬ì‹¤í–‰í•´ ì£¼ë©´ ëœë‹¤. ì´ ì‘ë™í•˜ê³  ìˆì–´ì•¼ í•œë‹¤. ê·¸ëŸ¬ë¯€ë¡œ, ì‘ì—… ìŠ¤ì¼€ì¤„ì„ ì˜ˆì•½í•˜ê¸° ì „ì— í•­ìƒ crond ë°ëª¬ì´ ì‘ë™ë  ìˆ˜ ìˆë„ë¡ ë‹¤ìŒê³¼ ê°™ì´ ì²˜ë¦¬í•œë‹¤.

```bash
# systemctl restart crond.service 
# systemctl enable crond.service
# systemctl is-enabled crond.service 
enabled
```

[ëª…ë ¹ì–´ í˜•ì‹]

```bash
# crontab [-u user] file
# crontab [-u user] [ -e | -l | -r ]
-e (edit user is crontab)
-l (list user is crontab)
-r (delete user is crontab)
-i (prompt before deleting user is crontab)
-s (selinux context)
```

[ëª…ë ¹ì–´ ì‚¬ìš© ì˜ˆ]

```bash
â–  ì‘ì—… ì„ ì–¸
# crontab â€“e (-e : Edit, # vi /var/spool/cron/<ì‚¬ìš©ìì´ë¦„>)
# crontab -e -u user01

â–  ì‘ì—… í™•ì¸
# crontab â€“l (-l : List, # cat /var/spool/cron/<ì‚¬ìš©ìì´ë¦„>)

â–  ì‘ì—… ì‚­ì œ
# crontab â€“r   (ì£¼ì˜) (-r : Remove, # rm /var/spool/cron/<ì‚¬ìš©ìì´ë¦„>)
```

![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2f9128d0-14c9-4b3f-b087-863221214947/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2f9128d0-14c9-4b3f-b087-863221214947/Untitled.png)

### [EX1] at ëª…ë ¹ì–´ì˜ ì‹¤ë¬´ì˜ˆ(ë°±ì—… ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰)

```bash
# cat /root/bin/backup.sh   
--------------------------------------------
(ë°±ì—… ìŠ¤í¬ë¦½íŠ¸ ë‚´ìš© ì˜ˆì œ)
cd /home
tar cvzf /backup/home.`date +%m%d`.tar.gz .
--------------------------------------------

(í˜„ì¬)        # /root/bin/backup.sh 
(ì§€ì •ëœ ì‹œê°„) # echo /root/bin/backup.sh | at 1200
```

### [EX2] ì—…ê·¸ë ˆì´ë“œ ìˆ˜í–‰ í›„ ì¬ë¶€íŒ…í•˜ëŠ” ê²½ìš°

[TERM1] ì—…ë°ì´íŠ¸ í„°ë¯¸ë„

```bash
# yum -y update 
.... ì—…ë°ì´íŠ¸ ìˆ˜í–‰ ì¤‘ ......
.... ë‚¨ì€ ì‘ì—… ì‹œê°„ ì˜ˆìƒ : 10ë¶„ ......
```

[TERM2] ì¬ë¶€íŒ… ëª…ë ¹ì–´ ìˆ˜í–‰ í„°ë¯¸ë„

```bash
# at now +30 mins
--------------------------------
at> shutdown -r now
at> <CTRL + D>
--------------------------------
```

### [EX3] crontab ëª…ë ¹ì–´ì˜ ê¸°ë³¸ ì‚¬ìš©ë²•(ì‰¬ëŠ” ì‹œê°„ í‘œì‹œ)

ì•„ìŠ¤í‚¤ì•„íŠ¸ ë§í¬

[Text to ASCII Art Generator (TAAG)](http://patorjk.com/software/taag/#p=display&f=Graffiti&t=Type%20Something%20)

```bash
# systemctl restart crond.service
# systemctl status crond.service

ê¸°ë³¸ íŒŒì¼ ì‘ì„±
# mkdir /etc/MESS
# vi /etc/MESS/CoffeeTime.txt

# crontab â€“e
50 10-18 * * 6,7  wall < /etc/MESS/CoffeeTime.txt

or 

50 10-16 * * 1-5  wall < /etc/MESS/CoffeeTime.txt
```

```bash
crontab íŒŒì¼ í™•ì¸
# crontab -l
50 10-18 * * 6,7 wall < /etc/MESS/CoffeeTime.txt

crontab ì‚­ì œ
# crontab -r

crontab íŒŒì¼ í™•ì¸
# crontab -l
no crontab for root
```

```bash
# crontab â€“e
VI íŒŒì¼ë¡œ "/tmp/crontab.sRMFc3" 0L, 0C ë¼ê³  ì™¼ìª½ ë°‘ì— ìƒì„±
crontabì€ ì—ë””í„°ë¥¼ ì‹¤í–‰í•˜ë©´ ì„ì‹œíŒŒì¼ë¡œ ìƒì„±ì´ ëœë‹¤. ê·¸ë¦¬ê³  ì €ì¥ì„ í•˜ëŠ”ìˆœê°„ ë°”ë¡œ ì ìš©ë˜ì–´ ë™ì‘í•œë‹¤.
ì €ì¥í•˜ê³  ë¹ ì ¸ë‚˜ê°€ë©´ crontab: installing new crontab ì„ ì¶œë ¥í•˜ë©° ë°”ë¡œ ì‹¤í–‰ ì‹œì‘

í•´ê²°ë°©ì•ˆ
ì„ì‹œë¡œ íŒŒì¼ì„ ì‘ì„±í•œë’¤ í™•ì¸í•˜ê³  ë®ì–´ì“°ê¸° 
# cd
# vi crontablist
# cat crontablist
50 10-18 * * 6,7 wall < /etc/MESS/CoffeeTime.txt
# cat crontablist  >> /var/spool/cron/root
# crontab -l
50 10-18 * * 6,7 wall < /etc/MESS/CoffeeTime.txt

```

```bash
ì‚¬ìš©ìì˜ crontab
# crontab -e -u [USERNAME] 
# crontab -l -u [USERNAME] 
# crontab -r -u [USERNAME] 
```

### [EX4] DB ì‚¬ìš©ìë¡œ ë¡œê·¸ì¸/ë°±ì—…

```bash
# crontab â€“e
01 04 * * * /root/bin/DB_backup.sh
# vi /root/bin/DB_backup.sh
-----------------------------------
#!/bin/bash

sqlplus /as sysdba << EOF
CMD ;
CMD ;
CMD ;
EOF
-----------------------------------
```

### [EX5] ìˆ˜ì—… ì¢…ë£Œ í›„ ì„œë²„ Power OFF

```bash
(Linux)# echo "/sbin/poweroff" | at now + 5 minutes  /* 5ë¶„ ë’¤ì— ë¦¬ëˆ…ìŠ¤ ì„œë²„ ì¢…ë£Œ */

(Window)C:\> shutdown /s /t 600  /* 10ë¶„ ë’¤ì— ìœˆë„ìš° ì„œë²„ ì¢…ë£Œ */
         C:\> shutdown /a         /* shutdown ì·¨ì†Œ */
```
