# 파일과 폴더 공유

### 네트워크 공유 접근 허용(공용 폴더 관리)

- FIRST 및 WINCLIENT를 관리자로 로그인한다.
- FIRST 제어판 -> 네트워크 및 공유 센터 -> 고급 공유 설정
- 고급 공유 설정 후 WINCLIENT에서 FIRST(user1)로 접근이 되는지 확인한다.
- 이와 같은 공유 방법(공용 폴더 사용)은 보안상 좋은 방법은 아니다.

### 특정 폴더 공유 접근 허용

- 특정 폴더를 공유할 수 있다.
- 테스트를 위해 아래와 같이 FIRST에 4개의 폴더를 생성하고 공유 설정한다.
- 공유한 폴더는 서버관리자에서도 확인할 수 있다.
- WINCLIENT에서 공유 폴더에 접속해 보자.
- 숨김 공유폴더는 네트워크 드라이브 연결로 연결하여 사용할 수 있다.

## 형성평가

1. FIRST 서버에 다음과 같이 로컬 사용자 계정을 만드시오.
2. 각 로컬 사용자로 로그인하여 한글 언어팩을 설치하고 서로 다른 테마를 적용하시오.
3. user1 계정으로 서버를 재시작 및 종료할 수 있도록 권한 설정하시오.
4. user1 계정으로 로그인하여 임의의 암호화 파일(test.txt)을 생성하고 user2 계정에서 해당 파일 읽기, 내용 수정, 파일 삭제가 가능하도록 설정하시오.
5. user1 계정의 패스워드 분실 시 복구할 수 있도록 플로피(Floppy) 디스크에 사용자키를 만드시오.
6. user1의 사용자키를 이용하여 다른 패스워드(123$$)를 설정하고 다시 원래 패스워드(p@ssw0rd)로 변경하시오.

## Server Core

### 컴퓨터 이름 변경

- Server Core는 그래픽 환경을 제공하지 않고 명령으로 처리해야 한다.
- 'hostname' 또는 'echo %computername%'으로 현재 컴퓨터 이름 확인한다.
- 'netdom renamecomputer %computername% /newname:CORE' 명령으로 컴퓨터 이름 변경한다.
- 재부팅 후 변경된 이름 확인

### IP 주소 변경

- 'ipconfig' 으로 현재 IP 주소 확인하고, 'nslookup'으로 DNS 서버 주소를 확인한다.
- 'netsh'명령으로 네트워크 설정 모드로 진입한다.
- 'interface ipv4 show interface' 명령으로 IDX를 확인한다.
- 적당한 IP 주소 및 서브넷 마스크, 게이트웨이를 설정한다.
- DNS 서버 설정

### 레지스트리 변경

- 'regedit' 명령으로 레지스트리 편집기를 실행한다.
- 배경화면의 색깔을 변경하려면 HKEY_CURRENT_USER\Control Panel\Colors에서 Background를 조정하면 된다.

### Server Core에서 DHCP 설치

- DVD에 ISO 설치 원본 파일을 넣는다.
- Powershell을 실행하여 'Get-WindowsFeature' 명령으로 설치된 서비스 목록을 확인한다.
- DHCP Server가 설치되지 않은것을 확인할 수 있다.
- DHSP Server 를 설치한다.(Index번호는 1번)
- DHSP Server 가 설치된 것을 확인할 수 있다.

### MinShell

- Server Core의 텍스트 모드에서는 서버의 기능 역할을 추가 설치하는 것이 불편하다.
- MinShell은 Server Core에 서버 관리자가 설치 된 것을 말한다.

    Install-WindowsFeature Server-Gui-Mgmt-Infra -source Wim:d:\sources\install.wim:1

- Windows Server 2012에서는 아래와 같이 변경이 가능했으나 2016으로 버전 업되면서 불가능하게 바뀌었다.

## Windows PowerShell

- Unix의 셸(Shell)과 같은 기능을 제공한다.
- Windows Server 2008에서 처음 소개되었다.
- Windows Server를 관리할 때 자주 사용되는 것들을 PowerShell에서 스크립트로 만들어 놓으면, 언제든 일관된 재사용이 가능하다.
- PowerShell 스크립트는 PowerShell 콘솔에서 대화형으로 사용한다.
- PowerShell 스크립트는 텍스트로 구성. 메모장에서 편집가능하다.
- PowerShell 스크립트는 대개 대소문자를 구별하지 않는다.
- 명령어나 경로의 Tab 자동 완성 기능을 지원한다.
- Cmdlet(커멘드렛으로 읽음)은 PowerShell에서 사용되는 기본적인 명령어를 말한다. Cmdlet 형식은 "동사-명사"와 같이 구성된다.
- 도움말을 보기 위한 Cmdlet은 "Get-Help“이다.

### PowerShell 기본 명령

- 기존 DOS 명령을 사용할 수 있다. (cd, dir, ipconfig, shutdown, 등)
- 커멘드렛(Cmdlet)을 사용할 수 있다.
- PowerShell 버전 확인
- 도움말 업데이트(시간이 다소 걸림. 2~5분 소요)
- 다음과 같은 오류는 무시해도 된다.
- 도움말 확인
- 커멘드렛 도움말 예제
- 커멘드렛 도움말 예제 한페이지씩

    add-content와 get-content (특정 파일에 워드를 추가하고 확인)

    copy-item (item 복사)

    Get-childitem (파일 및 폴더 목록 확인. DIR)

    Get-Command (커멘드렛 목록)

    Show-Command (커멘드렛 선택창 사용)

    PowerShell_ise (파워쉘에서 선택창을 바로 사용)
